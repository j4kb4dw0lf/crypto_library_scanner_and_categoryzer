<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>My Project: CertManager API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="wolfssl_logo" style="width: 150px; height: 100px; display: inline-block;"><img alt="Logo" src="../images/wolfssl_logo.png" style="width: 150px; height: 100px;"/></div>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">CertManager API </div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga7c003b945a105247fe5baf0ecb93fedf" id="r_ga7c003b945a105247fe5baf0ecb93fedf"><td class="memItemLeft" align="right" valign="top">WOLFSSL_CERT_MANAGER *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga7c003b945a105247fe5baf0ecb93fedf">wolfSSL_CertManagerNew_ex</a> (void *heap)</td></tr>
<tr class="memdesc:ga7c003b945a105247fe5baf0ecb93fedf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates and initializes a new Certificate Manager context. This context may be used independent of SSL needs. It may be used to load certificates, verify certificates, and check the revocation status.  <br /></td></tr>
<tr class="memitem:ga654752c1994c9e87fe5e97af0c16ea63" id="r_ga654752c1994c9e87fe5e97af0c16ea63"><td class="memItemLeft" align="right" valign="top">WOLFSSL_CERT_MANAGER *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga654752c1994c9e87fe5e97af0c16ea63">wolfSSL_CertManagerNew</a> (void)</td></tr>
<tr class="memdesc:ga654752c1994c9e87fe5e97af0c16ea63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates and initializes a new Certificate Manager context. This context may be used independent of SSL needs. It may be used to load certificates, verify certificates, and check the revocation status.  <br /></td></tr>
<tr class="memitem:ga57ba8168c6b468eef0978ad60b8bf092" id="r_ga57ba8168c6b468eef0978ad60b8bf092"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga57ba8168c6b468eef0978ad60b8bf092">wolfSSL_CertManagerFree</a> (WOLFSSL_CERT_MANAGER *)</td></tr>
<tr class="memdesc:ga57ba8168c6b468eef0978ad60b8bf092"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees all resources associated with the Certificate Manager context. Call this when you no longer need to use the Certificate Manager.  <br /></td></tr>
<tr class="memitem:ga548767c9d7da9a197a746a148f1bda3b" id="r_ga548767c9d7da9a197a746a148f1bda3b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga548767c9d7da9a197a746a148f1bda3b">wolfSSL_CertManagerLoadCA</a> (WOLFSSL_CERT_MANAGER *cm, const char *f, const char *d)</td></tr>
<tr class="memdesc:ga548767c9d7da9a197a746a148f1bda3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specifies the locations for CA certificate loading into the manager context. The PEM certificate CAfile may contain several trusted CA certificates. If CApath is not NULL it specifies a directory containing CA certificates in PEM format.  <br /></td></tr>
<tr class="memitem:gae8385826f3feb6c68f239b91ab613e1b" id="r_gae8385826f3feb6c68f239b91ab613e1b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gae8385826f3feb6c68f239b91ab613e1b">wolfSSL_CertManagerLoadCABuffer</a> (WOLFSSL_CERT_MANAGER *cm, const unsigned char *in, long sz, int format)</td></tr>
<tr class="memdesc:gae8385826f3feb6c68f239b91ab613e1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loads the CA Buffer by calling wolfSSL_CTX_load_verify_buffer and returning that result using a temporary cm so as not to lose the information in the cm passed into the function.  <br /></td></tr>
<tr class="memitem:ga6435f45bfaeb5a5e282a73df2f160475" id="r_ga6435f45bfaeb5a5e282a73df2f160475"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga6435f45bfaeb5a5e282a73df2f160475">wolfSSL_CertManagerUnloadCAs</a> (WOLFSSL_CERT_MANAGER *cm)</td></tr>
<tr class="memdesc:ga6435f45bfaeb5a5e282a73df2f160475"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function unloads the CA signer list.  <br /></td></tr>
<tr class="memitem:ga80cf4ee881a11c5f973aa6971ed01373" id="r_ga80cf4ee881a11c5f973aa6971ed01373"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga80cf4ee881a11c5f973aa6971ed01373">wolfSSL_CertManagerUnloadIntermediateCerts</a> (WOLFSSL_CERT_MANAGER *cm)</td></tr>
<tr class="memdesc:ga80cf4ee881a11c5f973aa6971ed01373"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function unloads intermediate certificates add to the CA signer list.  <br /></td></tr>
<tr class="memitem:ga4ac407be88acf2b8c329fbca68bd4163" id="r_ga4ac407be88acf2b8c329fbca68bd4163"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga4ac407be88acf2b8c329fbca68bd4163">wolfSSL_CertManagerUnload_trust_peers</a> (WOLFSSL_CERT_MANAGER *cm)</td></tr>
<tr class="memdesc:ga4ac407be88acf2b8c329fbca68bd4163"><td class="mdescLeft">&#160;</td><td class="mdescRight">The function will free the Trusted Peer linked list and unlocks the trusted peer list.  <br /></td></tr>
<tr class="memitem:ga02a2f8451f6b5583f84e30ed9b192839" id="r_ga02a2f8451f6b5583f84e30ed9b192839"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga02a2f8451f6b5583f84e30ed9b192839">wolfSSL_CertManagerVerify</a> (WOLFSSL_CERT_MANAGER *cm, const char *f, int format)</td></tr>
<tr class="memdesc:ga02a2f8451f6b5583f84e30ed9b192839"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specifies the certificate to verify with the Certificate Manager context. The format can be SSL_FILETYPE_PEM or SSL_FILETYPE_ASN1.  <br /></td></tr>
<tr class="memitem:ga33fb6d3ecbea2b276f0cbef1e179fb07" id="r_ga33fb6d3ecbea2b276f0cbef1e179fb07"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga33fb6d3ecbea2b276f0cbef1e179fb07">wolfSSL_CertManagerVerifyBuffer</a> (WOLFSSL_CERT_MANAGER *cm, const unsigned char *buff, long sz, int format)</td></tr>
<tr class="memdesc:ga33fb6d3ecbea2b276f0cbef1e179fb07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specifies the certificate buffer to verify with the Certificate Manager context. The format can be SSL_FILETYPE_PEM or SSL_FILETYPE_ASN1.  <br /></td></tr>
<tr class="memitem:gaae21fa2f6d4b04512bee2bc17ef0fcef" id="r_gaae21fa2f6d4b04512bee2bc17ef0fcef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaae21fa2f6d4b04512bee2bc17ef0fcef">wolfSSL_CertManagerSetVerify</a> (WOLFSSL_CERT_MANAGER *cm, VerifyCallback verify_callback)</td></tr>
<tr class="memdesc:gaae21fa2f6d4b04512bee2bc17ef0fcef"><td class="mdescLeft">&#160;</td><td class="mdescRight">The function sets the verifyCallback function in the Certificate Manager. If present, it will be called for each cert loaded. If there is a verification error, the verify callback can be used to over-ride the error.  <br /></td></tr>
<tr class="memitem:gaa0caa567b553f8417bca591cd18c9a25" id="r_gaa0caa567b553f8417bca591cd18c9a25"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa0caa567b553f8417bca591cd18c9a25">wolfSSL_CertManagerEnableCRL</a> (WOLFSSL_CERT_MANAGER *cm, int options)</td></tr>
<tr class="memdesc:gaa0caa567b553f8417bca591cd18c9a25"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turns on Certificate Revocation List checking when verifying certificates with the Certificate Manager. By default, CRL checking is off. options include WOLFSSL_CRL_CHECKALL which performs CRL checking on each certificate in the chain versus the Leaf certificate only which is the default.  <br /></td></tr>
<tr class="memitem:ga9e8cc5c00936adde105e64dbf1e8d403" id="r_ga9e8cc5c00936adde105e64dbf1e8d403"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga9e8cc5c00936adde105e64dbf1e8d403">wolfSSL_CertManagerDisableCRL</a> (WOLFSSL_CERT_MANAGER *)</td></tr>
<tr class="memdesc:ga9e8cc5c00936adde105e64dbf1e8d403"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turns off Certificate Revocation List checking when verifying certificates with the Certificate Manager. By default, CRL checking is off. You can use this function to temporarily or permanently disable CRL checking with this Certificate Manager context that previously had CRL checking enabled.  <br /></td></tr>
<tr class="memitem:ga407833060925d7dd8366db3ca557ce8e" id="r_ga407833060925d7dd8366db3ca557ce8e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga407833060925d7dd8366db3ca557ce8e">wolfSSL_CertManagerLoadCRL</a> (WOLFSSL_CERT_MANAGER *cm, const char *path, int type, int monitor)</td></tr>
<tr class="memdesc:ga407833060925d7dd8366db3ca557ce8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Error checks and passes through to LoadCRL() in order to load the cert into the CRL for revocation checking. An updated CRL can be loaded by first calling wolfSSL_CertManagerFreeCRL, then loading the new CRL.  <br /></td></tr>
<tr class="memitem:ga2db6e5f4ed5fa7d41ecc6c7ca7a04aec" id="r_ga2db6e5f4ed5fa7d41ecc6c7ca7a04aec"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga2db6e5f4ed5fa7d41ecc6c7ca7a04aec">wolfSSL_CertManagerLoadCRLBuffer</a> (WOLFSSL_CERT_MANAGER *cm, const unsigned char *buff, long sz, int type)</td></tr>
<tr class="memdesc:ga2db6e5f4ed5fa7d41ecc6c7ca7a04aec"><td class="mdescLeft">&#160;</td><td class="mdescRight">The function loads the CRL file by calling BufferLoadCRL.  <br /></td></tr>
<tr class="memitem:ga4929fe270fdc7cf0bdfca82d2c8a88ef" id="r_ga4929fe270fdc7cf0bdfca82d2c8a88ef"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga4929fe270fdc7cf0bdfca82d2c8a88ef">wolfSSL_CertManagerSetCRL_Cb</a> (WOLFSSL_CERT_MANAGER *cm, CbMissingCRL cb)</td></tr>
<tr class="memdesc:ga4929fe270fdc7cf0bdfca82d2c8a88ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sets the CRL Certificate Manager callback. If HAVE_CRL is defined and a matching CRL record is not found then the cbMissingCRL is called (set via wolfSSL_CertManagerSetCRL_Cb). This allows you to externally retrieve the CRL and load it.  <br /></td></tr>
<tr class="memitem:gab2481c2d71595eccaf7955ca4f3c0312" id="r_gab2481c2d71595eccaf7955ca4f3c0312"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gab2481c2d71595eccaf7955ca4f3c0312">wolfSSL_CertManagerSetCRLUpdate_Cb</a> (WOLFSSL_CERT_MANAGER *cm, CbUpdateCRL cb)</td></tr>
<tr class="memdesc:gab2481c2d71595eccaf7955ca4f3c0312"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sets the CRL Update callback. If HAVE_CRL and HAVE_CRL_UPDATE_CB is defined , and an entry with the same issuer and a lower CRL number exists when a CRL is added, then the CbUpdateCRL is called with the details of the existing entry and the new one replacing it.  <br /></td></tr>
<tr class="memitem:ga4866ca759a4b64b78938b1358b378416" id="r_ga4866ca759a4b64b78938b1358b378416"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga4866ca759a4b64b78938b1358b378416">wolfSSL_CertManagerGetCRLInfo</a> (WOLFSSL_CERT_MANAGER *cm, CrlInfo *info, const byte *buff, long sz, int type) int wolfSSL_CertManagerFreeCRL(WOLFSSL_CERT_MANAGER *cm)</td></tr>
<tr class="memdesc:ga4866ca759a4b64b78938b1358b378416"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function yields a structure with parsed CRL information from an encoded CRL buffer.  <br /></td></tr>
<tr class="memitem:ga53ff0bfe288d67722d794facebc09543" id="r_ga53ff0bfe288d67722d794facebc09543"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga53ff0bfe288d67722d794facebc09543">wolfSSL_CertManagerCheckOCSP</a> (WOLFSSL_CERT_MANAGER *cm, unsigned char *der, int sz)</td></tr>
<tr class="memdesc:ga53ff0bfe288d67722d794facebc09543"><td class="mdescLeft">&#160;</td><td class="mdescRight">The function enables the WOLFSSL_CERT_MANAGER’s member, ocspEnabled to signify that the OCSP check option is enabled.  <br /></td></tr>
<tr class="memitem:ga05b1f36d81c5cf5316336a2f54d53e68" id="r_ga05b1f36d81c5cf5316336a2f54d53e68"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga05b1f36d81c5cf5316336a2f54d53e68">wolfSSL_CertManagerEnableOCSP</a> (WOLFSSL_CERT_MANAGER *cm, int options)</td></tr>
<tr class="memdesc:ga05b1f36d81c5cf5316336a2f54d53e68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turns on OCSP if it’s turned off and if compiled with the set option available.  <br /></td></tr>
<tr class="memitem:ga31367a0d315f0342113ce827128727f9" id="r_ga31367a0d315f0342113ce827128727f9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga31367a0d315f0342113ce827128727f9">wolfSSL_CertManagerDisableOCSP</a> (WOLFSSL_CERT_MANAGER *)</td></tr>
<tr class="memdesc:ga31367a0d315f0342113ce827128727f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disables OCSP certificate revocation.  <br /></td></tr>
<tr class="memitem:gaae16a6566a0a4ac899ca94e8b9869158" id="r_gaae16a6566a0a4ac899ca94e8b9869158"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaae16a6566a0a4ac899ca94e8b9869158">wolfSSL_CertManagerSetOCSPOverrideURL</a> (WOLFSSL_CERT_MANAGER *cm, const char *url)</td></tr>
<tr class="memdesc:gaae16a6566a0a4ac899ca94e8b9869158"><td class="mdescLeft">&#160;</td><td class="mdescRight">The function copies the url to the ocspOverrideURL member of the WOLFSSL_CERT_MANAGER structure.  <br /></td></tr>
<tr class="memitem:ga40598eacaa03af2e003e95f57ddd30a9" id="r_ga40598eacaa03af2e003e95f57ddd30a9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga40598eacaa03af2e003e95f57ddd30a9">wolfSSL_CertManagerSetOCSP_Cb</a> (WOLFSSL_CERT_MANAGER *cm, CbOCSPIO ioCb, CbOCSPRespFree respFreeCb, void *ioCbCtx)</td></tr>
<tr class="memdesc:ga40598eacaa03af2e003e95f57ddd30a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">The function sets the OCSP callback in the WOLFSSL_CERT_MANAGER.  <br /></td></tr>
<tr class="memitem:gac17294be4393a23f98c7004217376dae" id="r_gac17294be4393a23f98c7004217376dae"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gac17294be4393a23f98c7004217376dae">wolfSSL_CertManagerEnableOCSPStapling</a> (WOLFSSL_CERT_MANAGER *cm)</td></tr>
<tr class="memdesc:gac17294be4393a23f98c7004217376dae"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function turns on OCSP stapling if it is not turned on as well as set the options.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="ga53ff0bfe288d67722d794facebc09543" name="ga53ff0bfe288d67722d794facebc09543"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga53ff0bfe288d67722d794facebc09543">&#9670;&#160;</a></span>wolfSSL_CertManagerCheckOCSP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wolfSSL_CertManagerCheckOCSP </td>
          <td>(</td>
          <td class="paramtype">WOLFSSL_CERT_MANAGER *</td>          <td class="paramname"><span class="paramname"><em>cm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *</td>          <td class="paramname"><span class="paramname"><em>der</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>sz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The function enables the WOLFSSL_CERT_MANAGER’s member, ocspEnabled to signify that the OCSP check option is enabled. </p>
<dl class="section return"><dt>Returns</dt><dd>SSL_SUCCESS returned on successful execution of the function. The ocspEnabled member of the WOLFSSL_CERT_MANAGER is enabled. </dd>
<dd>
BAD_FUNC_ARG returned if the WOLFSSL_CERT_MANAGER structure is NULL or if an argument value that is not allowed is passed to a subroutine. </dd>
<dd>
MEMORY_E returned if there is an error allocating memory within this function or a subroutine.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cm</td><td>a pointer to a WOLFSSL_CERT_MANAGER structure, created using <a class="el" href="#ga654752c1994c9e87fe5e97af0c16ea63" title="Allocates and initializes a new Certificate Manager context. This context may be used independent of ...">wolfSSL_CertManagerNew()</a>. </td></tr>
    <tr><td class="paramname">der</td><td>a byte pointer to the certificate. </td></tr>
    <tr><td class="paramname">sz</td><td>an int type representing the size of the DER cert.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="preprocessor">#import &lt;wolfssl/ssl.h&gt;</span></div>
<div class="line"> </div>
<div class="line">WOLFSSL* ssl = <a class="code hl_function" href="group__Setup.html#gab6d54b7485d74962e57bc636008aa9a0">wolfSSL_new</a>(ctx);</div>
<div class="line"><span class="keywordtype">byte</span>* der;</div>
<div class="line"><span class="keywordtype">int</span> sz; size of der</div>
<div class="line">...</div>
<div class="line">if(<a class="code hl_function" href="#ga53ff0bfe288d67722d794facebc09543">wolfSSL_CertManagerCheckOCSP</a>(cm, der, sz) != SSL_SUCCESS){</div>
<div class="line"> Failure <span class="keywordflow">case</span>.</div>
<div class="line">}</div>
<div class="ttc" id="agroup__CertManager_html_ga53ff0bfe288d67722d794facebc09543"><div class="ttname"><a href="#ga53ff0bfe288d67722d794facebc09543">wolfSSL_CertManagerCheckOCSP</a></div><div class="ttdeci">int wolfSSL_CertManagerCheckOCSP(WOLFSSL_CERT_MANAGER *cm, unsigned char *der, int sz)</div><div class="ttdoc">The function enables the WOLFSSL_CERT_MANAGER’s member, ocspEnabled to signify that the OCSP check op...</div></div>
<div class="ttc" id="agroup__Setup_html_gab6d54b7485d74962e57bc636008aa9a0"><div class="ttname"><a href="group__Setup.html#gab6d54b7485d74962e57bc636008aa9a0">wolfSSL_new</a></div><div class="ttdeci">WOLFSSL * wolfSSL_new(WOLFSSL_CTX *)</div><div class="ttdoc">This function creates a new SSL session, taking an already created SSL context as input.</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd>ParseCertRelative </dd>
<dd>
CheckCertOCSP </dd></dl>

</div>
</div>
<a id="ga9e8cc5c00936adde105e64dbf1e8d403" name="ga9e8cc5c00936adde105e64dbf1e8d403"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9e8cc5c00936adde105e64dbf1e8d403">&#9670;&#160;</a></span>wolfSSL_CertManagerDisableCRL()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wolfSSL_CertManagerDisableCRL </td>
          <td>(</td>
          <td class="paramtype">WOLFSSL_CERT_MANAGER *</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Turns off Certificate Revocation List checking when verifying certificates with the Certificate Manager. By default, CRL checking is off. You can use this function to temporarily or permanently disable CRL checking with this Certificate Manager context that previously had CRL checking enabled. </p>
<dl class="section return"><dt>Returns</dt><dd>SSL_SUCCESS If successful the call will return. </dd>
<dd>
BAD_FUNC_ARG is the error that will be returned if a function pointer is not provided.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cm</td><td>a pointer to a WOLFSSL_CERT_MANAGER structure, created using <a class="el" href="#ga654752c1994c9e87fe5e97af0c16ea63" title="Allocates and initializes a new Certificate Manager context. This context may be used independent of ...">wolfSSL_CertManagerNew()</a>.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;wolfssl/ssl.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> ret = 0;</div>
<div class="line">WOLFSSL_CERT_MANAGER* cm;</div>
<div class="line">...</div>
<div class="line">ret = <a class="code hl_function" href="#ga9e8cc5c00936adde105e64dbf1e8d403">wolfSSL_CertManagerDisableCRL</a>(cm);</div>
<div class="line"><span class="keywordflow">if</span> (ret != SSL_SUCCESS) {</div>
<div class="line">    error disabling cert manager</div>
<div class="line">}</div>
<div class="line">...</div>
<div class="ttc" id="agroup__CertManager_html_ga9e8cc5c00936adde105e64dbf1e8d403"><div class="ttname"><a href="#ga9e8cc5c00936adde105e64dbf1e8d403">wolfSSL_CertManagerDisableCRL</a></div><div class="ttdeci">int wolfSSL_CertManagerDisableCRL(WOLFSSL_CERT_MANAGER *)</div><div class="ttdoc">Turns off Certificate Revocation List checking when verifying certificates with the Certificate Manag...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaa0caa567b553f8417bca591cd18c9a25" title="Turns on Certificate Revocation List checking when verifying certificates with the Certificate Manage...">wolfSSL_CertManagerEnableCRL</a> </dd></dl>

</div>
</div>
<a id="ga31367a0d315f0342113ce827128727f9" name="ga31367a0d315f0342113ce827128727f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga31367a0d315f0342113ce827128727f9">&#9670;&#160;</a></span>wolfSSL_CertManagerDisableOCSP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wolfSSL_CertManagerDisableOCSP </td>
          <td>(</td>
          <td class="paramtype">WOLFSSL_CERT_MANAGER *</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Disables OCSP certificate revocation. </p>
<dl class="section return"><dt>Returns</dt><dd>SSL_SUCCESS wolfSSL_CertMangerDisableCRL successfully disabled the crlEnabled member of the WOLFSSL_CERT_MANAGER structure. </dd>
<dd>
BAD_FUNC_ARG the WOLFSSL structure was NULL.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssl</td><td>- a pointer to a WOLFSSL structure, created using <a class="el" href="group__Setup.html#gab6d54b7485d74962e57bc636008aa9a0" title="This function creates a new SSL session, taking an already created SSL context as input.">wolfSSL_new()</a>.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;wolfssl/ssl.h&gt;</span></div>
<div class="line"> </div>
<div class="line">WOLFSSL_CTX* ctx = <a class="code hl_function" href="group__Setup.html#ga2bcaa81e9fd11074c6e504891370dd45">wolfSSL_CTX_new</a>(method);</div>
<div class="line">WOLFSSL* ssl = <a class="code hl_function" href="group__Setup.html#gab6d54b7485d74962e57bc636008aa9a0">wolfSSL_new</a>(ctx);</div>
<div class="line">...</div>
<div class="line">if(<a class="code hl_function" href="#ga31367a0d315f0342113ce827128727f9">wolfSSL_CertManagerDisableOCSP</a>(ssl) != SSL_SUCCESS){</div>
<div class="line">    Fail <span class="keywordflow">case</span>.</div>
<div class="line">}</div>
<div class="ttc" id="agroup__CertManager_html_ga31367a0d315f0342113ce827128727f9"><div class="ttname"><a href="#ga31367a0d315f0342113ce827128727f9">wolfSSL_CertManagerDisableOCSP</a></div><div class="ttdeci">int wolfSSL_CertManagerDisableOCSP(WOLFSSL_CERT_MANAGER *)</div><div class="ttdoc">Disables OCSP certificate revocation.</div></div>
<div class="ttc" id="agroup__Setup_html_ga2bcaa81e9fd11074c6e504891370dd45"><div class="ttname"><a href="group__Setup.html#ga2bcaa81e9fd11074c6e504891370dd45">wolfSSL_CTX_new</a></div><div class="ttdeci">WOLFSSL_CTX * wolfSSL_CTX_new(WOLFSSL_METHOD *)</div><div class="ttdoc">This function creates a new SSL context, taking a desired SSL/TLS protocol method for input.</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="ssl_8h.html#ac61342d421acd184492aa8a674270805" title="Disables CRL certificate revocation.">wolfSSL_DisableCRL</a> </dd></dl>

</div>
</div>
<a id="gaa0caa567b553f8417bca591cd18c9a25" name="gaa0caa567b553f8417bca591cd18c9a25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa0caa567b553f8417bca591cd18c9a25">&#9670;&#160;</a></span>wolfSSL_CertManagerEnableCRL()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wolfSSL_CertManagerEnableCRL </td>
          <td>(</td>
          <td class="paramtype">WOLFSSL_CERT_MANAGER *</td>          <td class="paramname"><span class="paramname"><em>cm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>options</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Turns on Certificate Revocation List checking when verifying certificates with the Certificate Manager. By default, CRL checking is off. options include WOLFSSL_CRL_CHECKALL which performs CRL checking on each certificate in the chain versus the Leaf certificate only which is the default. </p>
<dl class="section return"><dt>Returns</dt><dd>SSL_SUCCESS If successful the call will return. </dd>
<dd>
NOT_COMPILED_IN will be returned if wolfSSL was not built with CRL enabled. </dd>
<dd>
MEMORY_E will be returned if an out of memory condition occurs. </dd>
<dd>
BAD_FUNC_ARG is the error that will be returned if a pointer is not provided. </dd>
<dd>
SSL_FAILURE will be returned if the CRL context cannot be initialized properly.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cm</td><td>a pointer to a WOLFSSL_CERT_MANAGER structure, created using <a class="el" href="#ga654752c1994c9e87fe5e97af0c16ea63" title="Allocates and initializes a new Certificate Manager context. This context may be used independent of ...">wolfSSL_CertManagerNew()</a>. </td></tr>
    <tr><td class="paramname">options</td><td>options to use when enabling the Certification Manager, cm.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;wolfssl/ssl.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> ret = 0;</div>
<div class="line">WOLFSSL_CERT_MANAGER* cm;</div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line">ret = <a class="code hl_function" href="#gaa0caa567b553f8417bca591cd18c9a25">wolfSSL_CertManagerEnableCRL</a>(cm, 0);</div>
<div class="line"><span class="keywordflow">if</span> (ret != SSL_SUCCESS) {</div>
<div class="line">    error enabling cert manager</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">...</div>
<div class="ttc" id="agroup__CertManager_html_gaa0caa567b553f8417bca591cd18c9a25"><div class="ttname"><a href="#gaa0caa567b553f8417bca591cd18c9a25">wolfSSL_CertManagerEnableCRL</a></div><div class="ttdeci">int wolfSSL_CertManagerEnableCRL(WOLFSSL_CERT_MANAGER *cm, int options)</div><div class="ttdoc">Turns on Certificate Revocation List checking when verifying certificates with the Certificate Manage...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga9e8cc5c00936adde105e64dbf1e8d403" title="Turns off Certificate Revocation List checking when verifying certificates with the Certificate Manag...">wolfSSL_CertManagerDisableCRL</a> </dd></dl>

</div>
</div>
<a id="ga05b1f36d81c5cf5316336a2f54d53e68" name="ga05b1f36d81c5cf5316336a2f54d53e68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga05b1f36d81c5cf5316336a2f54d53e68">&#9670;&#160;</a></span>wolfSSL_CertManagerEnableOCSP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wolfSSL_CertManagerEnableOCSP </td>
          <td>(</td>
          <td class="paramtype">WOLFSSL_CERT_MANAGER *</td>          <td class="paramname"><span class="paramname"><em>cm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>options</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Turns on OCSP if it’s turned off and if compiled with the set option available. </p>
<dl class="section return"><dt>Returns</dt><dd>SSL_SUCCESS returned if the function call is successful. </dd>
<dd>
BAD_FUNC_ARG if cm struct is NULL. </dd>
<dd>
MEMORY_E if WOLFSSL_OCSP struct value is NULL. </dd>
<dd>
SSL_FAILURE initialization of WOLFSSL_OCSP struct fails to initialize. </dd>
<dd>
NOT_COMPILED_IN build not compiled with correct feature enabled.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cm</td><td>a pointer to a WOLFSSL_CERT_MANAGER structure, created using <a class="el" href="#ga654752c1994c9e87fe5e97af0c16ea63" title="Allocates and initializes a new Certificate Manager context. This context may be used independent of ...">wolfSSL_CertManagerNew()</a>. </td></tr>
    <tr><td class="paramname">options</td><td>used to set values in WOLFSSL_CERT_MANAGER struct.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;wolfssl/ssl.h&gt;</span></div>
<div class="line"> </div>
<div class="line">WOLFSSL_CTX* ctx = <a class="code hl_function" href="group__Setup.html#ga2bcaa81e9fd11074c6e504891370dd45">wolfSSL_CTX_new</a>(protocol method);</div>
<div class="line">WOLFSSL* ssl = <a class="code hl_function" href="group__Setup.html#gab6d54b7485d74962e57bc636008aa9a0">wolfSSL_new</a>(ctx);</div>
<div class="line">WOLFSSL_CERT_MANAGER* cm = <a class="code hl_function" href="#ga654752c1994c9e87fe5e97af0c16ea63">wolfSSL_CertManagerNew</a>();</div>
<div class="line"><span class="keywordtype">int</span> options;</div>
<div class="line">…</div>
<div class="line"><span class="keywordflow">if</span>(<a class="code hl_function" href="#ga05b1f36d81c5cf5316336a2f54d53e68">wolfSSL_CertManagerEnableOCSP</a>(SSL_CM(ssl), options) != SSL_SUCCESS){</div>
<div class="line">    Failure <span class="keywordflow">case</span>.</div>
<div class="line">}</div>
<div class="ttc" id="agroup__CertManager_html_ga05b1f36d81c5cf5316336a2f54d53e68"><div class="ttname"><a href="#ga05b1f36d81c5cf5316336a2f54d53e68">wolfSSL_CertManagerEnableOCSP</a></div><div class="ttdeci">int wolfSSL_CertManagerEnableOCSP(WOLFSSL_CERT_MANAGER *cm, int options)</div><div class="ttdoc">Turns on OCSP if it’s turned off and if compiled with the set option available.</div></div>
<div class="ttc" id="agroup__CertManager_html_ga654752c1994c9e87fe5e97af0c16ea63"><div class="ttname"><a href="#ga654752c1994c9e87fe5e97af0c16ea63">wolfSSL_CertManagerNew</a></div><div class="ttdeci">WOLFSSL_CERT_MANAGER * wolfSSL_CertManagerNew(void)</div><div class="ttdoc">Allocates and initializes a new Certificate Manager context. This context may be used independent of ...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga654752c1994c9e87fe5e97af0c16ea63" title="Allocates and initializes a new Certificate Manager context. This context may be used independent of ...">wolfSSL_CertManagerNew</a> </dd></dl>

</div>
</div>
<a id="gac17294be4393a23f98c7004217376dae" name="gac17294be4393a23f98c7004217376dae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac17294be4393a23f98c7004217376dae">&#9670;&#160;</a></span>wolfSSL_CertManagerEnableOCSPStapling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wolfSSL_CertManagerEnableOCSPStapling </td>
          <td>(</td>
          <td class="paramtype">WOLFSSL_CERT_MANAGER *</td>          <td class="paramname"><span class="paramname"><em>cm</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function turns on OCSP stapling if it is not turned on as well as set the options. </p>
<dl class="section return"><dt>Returns</dt><dd>SSL_SUCCESS returned if there were no errors and the function executed successfully. </dd>
<dd>
BAD_FUNC_ARG returned if the WOLFSSL_CERT_MANAGER structure is NULL or otherwise if there was a unpermitted argument value passed to a subroutine. </dd>
<dd>
MEMORY_E returned if there was an issue allocating memory. </dd>
<dd>
SSL_FAILURE returned if the initialization of the OCSP structure failed. </dd>
<dd>
NOT_COMPILED_IN returned if wolfSSL was not compiled with HAVE_CERTIFICATE_STATUS_REQUEST option.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cm</td><td>a pointer to a WOLFSSL_CERT_MANAGER structure, a member of the WOLFSSL_CTX structure.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="ssl_8h.html#a27c5bf3d28d3cb3e8ef25f97d0c31f7f">wolfSSL_CTX_EnableOCSPStapling</a>(WOLFSSL_CTX* ctx){</div>
<div class="line">…</div>
<div class="line"><span class="keywordflow">return</span> <a class="code hl_function" href="#gac17294be4393a23f98c7004217376dae">wolfSSL_CertManagerEnableOCSPStapling</a>(ctx-&gt;cm);</div>
<div class="ttc" id="agroup__CertManager_html_gac17294be4393a23f98c7004217376dae"><div class="ttname"><a href="#gac17294be4393a23f98c7004217376dae">wolfSSL_CertManagerEnableOCSPStapling</a></div><div class="ttdeci">int wolfSSL_CertManagerEnableOCSPStapling(WOLFSSL_CERT_MANAGER *cm)</div><div class="ttdoc">This function turns on OCSP stapling if it is not turned on as well as set the options.</div></div>
<div class="ttc" id="assl_8h_html_a27c5bf3d28d3cb3e8ef25f97d0c31f7f"><div class="ttname"><a href="ssl_8h.html#a27c5bf3d28d3cb3e8ef25f97d0c31f7f">wolfSSL_CTX_EnableOCSPStapling</a></div><div class="ttdeci">int wolfSSL_CTX_EnableOCSPStapling(WOLFSSL_CTX *)</div><div class="ttdoc">This function enables OCSP stapling by calling wolfSSL_CertManagerEnableOCSPStapling().</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="ssl_8h.html#a27c5bf3d28d3cb3e8ef25f97d0c31f7f" title="This function enables OCSP stapling by calling wolfSSL_CertManagerEnableOCSPStapling().">wolfSSL_CTX_EnableOCSPStapling</a> </dd></dl>

</div>
</div>
<a id="ga57ba8168c6b468eef0978ad60b8bf092" name="ga57ba8168c6b468eef0978ad60b8bf092"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga57ba8168c6b468eef0978ad60b8bf092">&#9670;&#160;</a></span>wolfSSL_CertManagerFree()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wolfSSL_CertManagerFree </td>
          <td>(</td>
          <td class="paramtype">WOLFSSL_CERT_MANAGER *</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees all resources associated with the Certificate Manager context. Call this when you no longer need to use the Certificate Manager. </p>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cm</td><td>a pointer to a WOLFSSL_CERT_MANAGER structure, created using <a class="el" href="#ga654752c1994c9e87fe5e97af0c16ea63" title="Allocates and initializes a new Certificate Manager context. This context may be used independent of ...">wolfSSL_CertManagerNew()</a>.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;wolfssl/ssl.h&gt;</span></div>
<div class="line"> </div>
<div class="line">WOLFSSL_CERT_MANAGER* cm;</div>
<div class="line">...</div>
<div class="line">wolfSSL_CertManagerFree(cm);</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga654752c1994c9e87fe5e97af0c16ea63" title="Allocates and initializes a new Certificate Manager context. This context may be used independent of ...">wolfSSL_CertManagerNew</a> </dd></dl>

</div>
</div>
<a id="ga4866ca759a4b64b78938b1358b378416" name="ga4866ca759a4b64b78938b1358b378416"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4866ca759a4b64b78938b1358b378416">&#9670;&#160;</a></span>wolfSSL_CertManagerGetCRLInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wolfSSL_CertManagerGetCRLInfo </td>
          <td>(</td>
          <td class="paramtype">WOLFSSL_CERT_MANAGER *</td>          <td class="paramname"><span class="paramname"><em>cm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CrlInfo *</td>          <td class="paramname"><span class="paramname"><em>info</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>buff</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>sz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function yields a structure with parsed CRL information from an encoded CRL buffer. </p>
<dl class="section return"><dt>Returns</dt><dd>SSL_SUCCESS returned upon successful execution of the function and subroutines. </dd>
<dd>
BAD_FUNC_ARG returned if the WOLFSSL_CERT_MANAGER structure is NULL.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cm</td><td>the WOLFSSL_CERT_MANAGER structure.. </td></tr>
    <tr><td class="paramname">info</td><td>pointer to caller managed CrlInfo structure that will receive the CRL information. </td></tr>
    <tr><td class="paramname">buff</td><td>input buffer containing encoded CRL. </td></tr>
    <tr><td class="paramname">sz</td><td>the length in bytes of the input CRL data in buff. </td></tr>
    <tr><td class="paramname">type</td><td>WOLFSSL_FILETYPE_PEM or WOLFSSL_FILETYPE_DER</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;wolfssl/ssl.h&gt;</span></div>
<div class="line"> </div>
<div class="line">CrlInfo info;</div>
<div class="line">WOLFSSL_CERT_MANAGER* cm = NULL;</div>
<div class="line"> </div>
<div class="line">cm = <a class="code hl_function" href="#ga654752c1994c9e87fe5e97af0c16ea63">wolfSSL_CertManagerNew</a>();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Read crl data from file into buffer</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ga4866ca759a4b64b78938b1358b378416">wolfSSL_CertManagerGetCRLInfo</a>(cm, &amp;info, crlData, crlDataLen,</div>
<div class="line">                              WOLFSSL_FILETYPE_PEM);</div>
<div class="ttc" id="agroup__CertManager_html_ga4866ca759a4b64b78938b1358b378416"><div class="ttname"><a href="#ga4866ca759a4b64b78938b1358b378416">wolfSSL_CertManagerGetCRLInfo</a></div><div class="ttdeci">int wolfSSL_CertManagerGetCRLInfo(WOLFSSL_CERT_MANAGER *cm, CrlInfo *info, const byte *buff, long sz, int type) int wolfSSL_CertManagerFreeCRL(WOLFSSL_CERT_MANAGER *cm)</div><div class="ttdoc">This function yields a structure with parsed CRL information from an encoded CRL buffer.</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd>CbUpdateCRL </dd>
<dd>
<a class="el" href="ssl_8h.html#a761a40b527f38ba2df833fe8b51a8408" title="Sets the CRL callback in the WOLFSSL_CERT_MANAGER structure.">wolfSSL_SetCRL_Cb</a></dd></dl>
<p>This function frees the CRL stored in the Cert Manager. An application can update the CRL by calling wolfSSL_CertManagerFreeCRL and then loading the new CRL.</p>
<dl class="section return"><dt>Returns</dt><dd>SSL_SUCCESS returned upon successful execution of the function and subroutines. </dd>
<dd>
BAD_FUNC_ARG returned if the WOLFSSL_CERT_MANAGER structure is NULL.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cm</td><td>a pointer to a WOLFSSL_CERT_MANAGER structure, created using <a class="el" href="#ga654752c1994c9e87fe5e97af0c16ea63" title="Allocates and initializes a new Certificate Manager context. This context may be used independent of ...">wolfSSL_CertManagerNew()</a>.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;wolfssl/ssl.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span>* crl1     = <span class="stringliteral">&quot;./certs/crl/crl.pem&quot;</span>;</div>
<div class="line">WOLFSSL_CERT_MANAGER* cm = NULL;</div>
<div class="line"> </div>
<div class="line">cm = <a class="code hl_function" href="#ga654752c1994c9e87fe5e97af0c16ea63">wolfSSL_CertManagerNew</a>();</div>
<div class="line"><a class="code hl_function" href="#ga407833060925d7dd8366db3ca557ce8e">wolfSSL_CertManagerLoadCRL</a>(cm, crl1, WOLFSSL_FILETYPE_PEM, 0);</div>
<div class="line">…</div>
<div class="line">wolfSSL_CertManagerFreeCRL(cm);</div>
<div class="ttc" id="agroup__CertManager_html_ga407833060925d7dd8366db3ca557ce8e"><div class="ttname"><a href="#ga407833060925d7dd8366db3ca557ce8e">wolfSSL_CertManagerLoadCRL</a></div><div class="ttdeci">int wolfSSL_CertManagerLoadCRL(WOLFSSL_CERT_MANAGER *cm, const char *path, int type, int monitor)</div><div class="ttdoc">Error checks and passes through to LoadCRL() in order to load the cert into the CRL for revocation ch...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga407833060925d7dd8366db3ca557ce8e" title="Error checks and passes through to LoadCRL() in order to load the cert into the CRL for revocation ch...">wolfSSL_CertManagerLoadCRL</a> </dd></dl>

</div>
</div>
<a id="ga548767c9d7da9a197a746a148f1bda3b" name="ga548767c9d7da9a197a746a148f1bda3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga548767c9d7da9a197a746a148f1bda3b">&#9670;&#160;</a></span>wolfSSL_CertManagerLoadCA()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wolfSSL_CertManagerLoadCA </td>
          <td>(</td>
          <td class="paramtype">WOLFSSL_CERT_MANAGER *</td>          <td class="paramname"><span class="paramname"><em>cm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>d</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Specifies the locations for CA certificate loading into the manager context. The PEM certificate CAfile may contain several trusted CA certificates. If CApath is not NULL it specifies a directory containing CA certificates in PEM format. </p>
<dl class="section return"><dt>Returns</dt><dd>SSL_SUCCESS If successful the call will return. </dd>
<dd>
SSL_BAD_FILETYPE will be returned if the file is the wrong format. </dd>
<dd>
SSL_BAD_FILE will be returned if the file doesn’t exist, can’t be read, or is corrupted. </dd>
<dd>
MEMORY_E will be returned if an out of memory condition occurs. </dd>
<dd>
ASN_INPUT_E will be returned if Base16 decoding fails on the file. </dd>
<dd>
BAD_FUNC_ARG is the error that will be returned if a pointer is not provided. </dd>
<dd>
SSL_FATAL_ERROR - will be returned upon failure.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cm</td><td>a pointer to a WOLFSSL_CERT_MANAGER structure, created using <a class="el" href="#ga654752c1994c9e87fe5e97af0c16ea63" title="Allocates and initializes a new Certificate Manager context. This context may be used independent of ...">wolfSSL_CertManagerNew()</a>. </td></tr>
    <tr><td class="paramname">file</td><td>pointer to the name of the file containing CA certificates to load. </td></tr>
    <tr><td class="paramname">path</td><td>pointer to the name of a directory path containing CA c ertificates to load. The NULL pointer may be used if no certificate directory is desired.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;wolfssl/ssl.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> ret = 0;</div>
<div class="line">WOLFSSL_CERT_MANAGER* cm;</div>
<div class="line">...</div>
<div class="line">ret = <a class="code hl_function" href="#ga548767c9d7da9a197a746a148f1bda3b">wolfSSL_CertManagerLoadCA</a>(cm, “path/to/cert-file.pem”, 0);</div>
<div class="line"><span class="keywordflow">if</span> (ret != SSL_SUCCESS) {</div>
<div class="line"><span class="comment">// error loading CA certs into cert manager</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__CertManager_html_ga548767c9d7da9a197a746a148f1bda3b"><div class="ttname"><a href="#ga548767c9d7da9a197a746a148f1bda3b">wolfSSL_CertManagerLoadCA</a></div><div class="ttdeci">int wolfSSL_CertManagerLoadCA(WOLFSSL_CERT_MANAGER *cm, const char *f, const char *d)</div><div class="ttdoc">Specifies the locations for CA certificate loading into the manager context. The PEM certificate CAfi...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga02a2f8451f6b5583f84e30ed9b192839" title="Specifies the certificate to verify with the Certificate Manager context. The format can be SSL_FILET...">wolfSSL_CertManagerVerify</a> </dd></dl>

</div>
</div>
<a id="gae8385826f3feb6c68f239b91ab613e1b" name="gae8385826f3feb6c68f239b91ab613e1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae8385826f3feb6c68f239b91ab613e1b">&#9670;&#160;</a></span>wolfSSL_CertManagerLoadCABuffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wolfSSL_CertManagerLoadCABuffer </td>
          <td>(</td>
          <td class="paramtype">WOLFSSL_CERT_MANAGER *</td>          <td class="paramname"><span class="paramname"><em>cm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>sz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>format</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loads the CA Buffer by calling wolfSSL_CTX_load_verify_buffer and returning that result using a temporary cm so as not to lose the information in the cm passed into the function. </p>
<dl class="section return"><dt>Returns</dt><dd>SSL_FATAL_ERROR is returned if the WOLFSSL_CERT_MANAGER struct is NULL or if <a class="el" href="group__Setup.html#ga2bcaa81e9fd11074c6e504891370dd45" title="This function creates a new SSL context, taking a desired SSL/TLS protocol method for input.">wolfSSL_CTX_new()</a> returns NULL. </dd>
<dd>
SSL_SUCCESS is returned for a successful execution.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cm</td><td>a pointer to a WOLFSSL_CERT_MANAGER structure, created using <a class="el" href="#ga654752c1994c9e87fe5e97af0c16ea63" title="Allocates and initializes a new Certificate Manager context. This context may be used independent of ...">wolfSSL_CertManagerNew()</a>. </td></tr>
    <tr><td class="paramname">in</td><td>buffer for cert information. </td></tr>
    <tr><td class="paramname">sz</td><td>length of the buffer. </td></tr>
    <tr><td class="paramname">format</td><td>certificate format, either PEM or DER.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">WOLFSSL_CERT_MANAGER* cm = (WOLFSSL_CERT_MANAGER*)vp;</div>
<div class="line">…</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in;</div>
<div class="line"><span class="keywordtype">long</span> sz;</div>
<div class="line"><span class="keywordtype">int</span> format;</div>
<div class="line">…</div>
<div class="line"><span class="keywordflow">if</span>(<a class="code hl_function" href="#gae8385826f3feb6c68f239b91ab613e1b">wolfSSL_CertManagerLoadCABuffer</a>(vp, sz, format) != SSL_SUCCESS){</div>
<div class="line">    Error returned. Failure <span class="keywordflow">case</span> code block.</div>
<div class="line">}</div>
<div class="ttc" id="agroup__CertManager_html_gae8385826f3feb6c68f239b91ab613e1b"><div class="ttname"><a href="#gae8385826f3feb6c68f239b91ab613e1b">wolfSSL_CertManagerLoadCABuffer</a></div><div class="ttdeci">int wolfSSL_CertManagerLoadCABuffer(WOLFSSL_CERT_MANAGER *cm, const unsigned char *in, long sz, int format)</div><div class="ttdoc">Loads the CA Buffer by calling wolfSSL_CTX_load_verify_buffer and returning that result using a tempo...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__CertsKeys.html#gaa5a28f0ac25d9abeb72fcee81bbf647b" title="This function loads a CA certificate buffer into the WOLFSSL Context. It behaves like the non-buffere...">wolfSSL_CTX_load_verify_buffer</a> </dd>
<dd>
ProcessChainBuffer </dd>
<dd>
ProcessBuffer </dd>
<dd>
cm_pick_method </dd></dl>

</div>
</div>
<a id="ga407833060925d7dd8366db3ca557ce8e" name="ga407833060925d7dd8366db3ca557ce8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga407833060925d7dd8366db3ca557ce8e">&#9670;&#160;</a></span>wolfSSL_CertManagerLoadCRL()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wolfSSL_CertManagerLoadCRL </td>
          <td>(</td>
          <td class="paramtype">WOLFSSL_CERT_MANAGER *</td>          <td class="paramname"><span class="paramname"><em>cm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>monitor</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Error checks and passes through to LoadCRL() in order to load the cert into the CRL for revocation checking. An updated CRL can be loaded by first calling wolfSSL_CertManagerFreeCRL, then loading the new CRL. </p>
<dl class="section return"><dt>Returns</dt><dd>SSL_SUCCESS if there is no error in wolfSSL_CertManagerLoadCRL and if LoadCRL returns successfully. </dd>
<dd>
BAD_FUNC_ARG if the WOLFSSL_CERT_MANAGER struct is NULL. </dd>
<dd>
SSL_FATAL_ERROR if wolfSSL_CertManagerEnableCRL returns anything other than SSL_SUCCESS. </dd>
<dd>
BAD_PATH_ERROR if the path is NULL. </dd>
<dd>
MEMORY_E if LoadCRL fails to allocate heap memory.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cm</td><td>a pointer to a WOLFSSL_CERT_MANAGER structure, created using <a class="el" href="#ga654752c1994c9e87fe5e97af0c16ea63" title="Allocates and initializes a new Certificate Manager context. This context may be used independent of ...">wolfSSL_CertManagerNew()</a>. </td></tr>
    <tr><td class="paramname">path</td><td>a constant char pointer holding the CRL path. </td></tr>
    <tr><td class="paramname">type</td><td>type of certificate to be loaded. </td></tr>
    <tr><td class="paramname">monitor</td><td>requests monitoring in LoadCRL().</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;wolfssl/ssl.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="ssl_8h.html#ae7e4756ce11b1803379dc9a121b2b954">wolfSSL_LoadCRL</a>(WOLFSSL* ssl, <span class="keyword">const</span> <span class="keywordtype">char</span>* path, <span class="keywordtype">int</span> type,</div>
<div class="line"><span class="keywordtype">int</span> monitor);</div>
<div class="line">…</div>
<div class="line"><a class="code hl_function" href="#ga407833060925d7dd8366db3ca557ce8e">wolfSSL_CertManagerLoadCRL</a>(SSL_CM(ssl), path, type, monitor);</div>
<div class="ttc" id="assl_8h_html_ae7e4756ce11b1803379dc9a121b2b954"><div class="ttname"><a href="ssl_8h.html#ae7e4756ce11b1803379dc9a121b2b954">wolfSSL_LoadCRL</a></div><div class="ttdeci">int wolfSSL_LoadCRL(WOLFSSL *ssl, const char *path, int type, int monitor)</div><div class="ttdoc">A wrapper function that ends up calling LoadCRL to load the certificate for revocation checking.</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaa0caa567b553f8417bca591cd18c9a25" title="Turns on Certificate Revocation List checking when verifying certificates with the Certificate Manage...">wolfSSL_CertManagerEnableCRL</a> </dd>
<dd>
<a class="el" href="ssl_8h.html#ae7e4756ce11b1803379dc9a121b2b954" title="A wrapper function that ends up calling LoadCRL to load the certificate for revocation checking.">wolfSSL_LoadCRL</a> </dd>
<dd>
wolfSSL_CertManagerFreeCRL </dd></dl>

</div>
</div>
<a id="ga2db6e5f4ed5fa7d41ecc6c7ca7a04aec" name="ga2db6e5f4ed5fa7d41ecc6c7ca7a04aec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2db6e5f4ed5fa7d41ecc6c7ca7a04aec">&#9670;&#160;</a></span>wolfSSL_CertManagerLoadCRLBuffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wolfSSL_CertManagerLoadCRLBuffer </td>
          <td>(</td>
          <td class="paramtype">WOLFSSL_CERT_MANAGER *</td>          <td class="paramname"><span class="paramname"><em>cm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *</td>          <td class="paramname"><span class="paramname"><em>buff</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>sz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The function loads the CRL file by calling BufferLoadCRL. </p>
<dl class="section return"><dt>Returns</dt><dd>SSL_SUCCESS returned if the function completed without errors. </dd>
<dd>
BAD_FUNC_ARG returned if the WOLFSSL_CERT_MANAGER is NULL. </dd>
<dd>
SSL_FATAL_ERROR returned if there is an error associated with the WOLFSSL_CERT_MANAGER.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cm</td><td>a pointer to a WOLFSSL_CERT_MANAGER structure. </td></tr>
    <tr><td class="paramname">buff</td><td>a constant byte type and is the buffer. </td></tr>
    <tr><td class="paramname">sz</td><td>a long int representing the size of the buffer. </td></tr>
    <tr><td class="paramname">type</td><td>a long integer that holds the certificate type.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;wolfssl/ssl.h&gt;</span></div>
<div class="line"> </div>
<div class="line">WOLFSSL_CERT_MANAGER* cm;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* buff;</div>
<div class="line"><span class="keywordtype">long</span> sz; size of buffer</div>
<div class="line"><span class="keywordtype">int</span> type;  cert type</div>
<div class="line">...</div>
<div class="line">int ret = <a class="code hl_function" href="#ga2db6e5f4ed5fa7d41ecc6c7ca7a04aec">wolfSSL_CertManagerLoadCRLBuffer</a>(cm, buff, sz, type);</div>
<div class="line"><span class="keywordflow">if</span>(ret == SSL_SUCCESS){</div>
<div class="line"><span class="keywordflow">return</span> ret;</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">    Failure <span class="keywordflow">case</span>.</div>
<div class="line">}</div>
<div class="ttc" id="agroup__CertManager_html_ga2db6e5f4ed5fa7d41ecc6c7ca7a04aec"><div class="ttname"><a href="#ga2db6e5f4ed5fa7d41ecc6c7ca7a04aec">wolfSSL_CertManagerLoadCRLBuffer</a></div><div class="ttdeci">int wolfSSL_CertManagerLoadCRLBuffer(WOLFSSL_CERT_MANAGER *cm, const unsigned char *buff, long sz, int type)</div><div class="ttdoc">The function loads the CRL file by calling BufferLoadCRL.</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd>BufferLoadCRL </dd>
<dd>
<a class="el" href="#gaa0caa567b553f8417bca591cd18c9a25" title="Turns on Certificate Revocation List checking when verifying certificates with the Certificate Manage...">wolfSSL_CertManagerEnableCRL</a> </dd></dl>

</div>
</div>
<a id="ga654752c1994c9e87fe5e97af0c16ea63" name="ga654752c1994c9e87fe5e97af0c16ea63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga654752c1994c9e87fe5e97af0c16ea63">&#9670;&#160;</a></span>wolfSSL_CertManagerNew()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_CERT_MANAGER * wolfSSL_CertManagerNew </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates and initializes a new Certificate Manager context. This context may be used independent of SSL needs. It may be used to load certificates, verify certificates, and check the revocation status. </p>
<dl class="section return"><dt>Returns</dt><dd>WOLFSSL_CERT_MANAGER If successful the call will return a valid WOLFSSL_CERT_MANAGER pointer. </dd>
<dd>
NULL will be returned for an error state.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">none</td><td>No parameters.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="preprocessor">#import &lt;wolfssl/ssl.h&gt;</span></div>
<div class="line"> </div>
<div class="line">WOLFSSL_CERT_MANAGER* cm;</div>
<div class="line">cm = <a class="code hl_function" href="#ga654752c1994c9e87fe5e97af0c16ea63">wolfSSL_CertManagerNew</a>();</div>
<div class="line"><span class="keywordflow">if</span> (cm == NULL) {</div>
<div class="line"><span class="comment">// error creating new cert manager</span></div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga57ba8168c6b468eef0978ad60b8bf092" title="Frees all resources associated with the Certificate Manager context. Call this when you no longer nee...">wolfSSL_CertManagerFree</a> </dd></dl>

</div>
</div>
<a id="ga7c003b945a105247fe5baf0ecb93fedf" name="ga7c003b945a105247fe5baf0ecb93fedf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7c003b945a105247fe5baf0ecb93fedf">&#9670;&#160;</a></span>wolfSSL_CertManagerNew_ex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_CERT_MANAGER * wolfSSL_CertManagerNew_ex </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>heap</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates and initializes a new Certificate Manager context. This context may be used independent of SSL needs. It may be used to load certificates, verify certificates, and check the revocation status. </p>
<dl class="section return"><dt>Returns</dt><dd>WOLFSSL_CERT_MANAGER If successful the call will return a valid WOLFSSL_CERT_MANAGER pointer. </dd>
<dd>
NULL will be returned for an error state.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">none</td><td>No parameters.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga57ba8168c6b468eef0978ad60b8bf092" title="Frees all resources associated with the Certificate Manager context. Call this when you no longer nee...">wolfSSL_CertManagerFree</a> </dd></dl>

</div>
</div>
<a id="ga4929fe270fdc7cf0bdfca82d2c8a88ef" name="ga4929fe270fdc7cf0bdfca82d2c8a88ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4929fe270fdc7cf0bdfca82d2c8a88ef">&#9670;&#160;</a></span>wolfSSL_CertManagerSetCRL_Cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wolfSSL_CertManagerSetCRL_Cb </td>
          <td>(</td>
          <td class="paramtype">WOLFSSL_CERT_MANAGER *</td>          <td class="paramname"><span class="paramname"><em>cm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CbMissingCRL</td>          <td class="paramname"><span class="paramname"><em>cb</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function sets the CRL Certificate Manager callback. If HAVE_CRL is defined and a matching CRL record is not found then the cbMissingCRL is called (set via wolfSSL_CertManagerSetCRL_Cb). This allows you to externally retrieve the CRL and load it. </p>
<dl class="section return"><dt>Returns</dt><dd>SSL_SUCCESS returned upon successful execution of the function and subroutines. </dd>
<dd>
BAD_FUNC_ARG returned if the WOLFSSL_CERT_MANAGER structure is NULL.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cm</td><td>the WOLFSSL_CERT_MANAGER structure holding the information for the certificate. </td></tr>
    <tr><td class="paramname">cb</td><td>a function pointer to (*CbMissingCRL) that is set to the cbMissingCRL member of the WOLFSSL_CERT_MANAGER.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;wolfssl/ssl.h&gt;</span></div>
<div class="line"> </div>
<div class="line">WOLFSSL_CTX* ctx = <a class="code hl_function" href="group__Setup.html#ga2bcaa81e9fd11074c6e504891370dd45">wolfSSL_CTX_new</a>(protocol method);</div>
<div class="line">WOLFSSL* ssl = <a class="code hl_function" href="group__Setup.html#gab6d54b7485d74962e57bc636008aa9a0">wolfSSL_new</a>(ctx);</div>
<div class="line">…</div>
<div class="line"><span class="keywordtype">void</span> cb(<span class="keyword">const</span> <span class="keywordtype">char</span>* url){</div>
<div class="line">    Function body.</div>
<div class="line">}</div>
<div class="line">…</div>
<div class="line">CbMissingCRL cb = CbMissingCRL;</div>
<div class="line">…</div>
<div class="line"><span class="keywordflow">if</span>(ctx){</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_function" href="#ga4929fe270fdc7cf0bdfca82d2c8a88ef">wolfSSL_CertManagerSetCRL_Cb</a>(SSL_CM(ssl), cb);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__CertManager_html_ga4929fe270fdc7cf0bdfca82d2c8a88ef"><div class="ttname"><a href="#ga4929fe270fdc7cf0bdfca82d2c8a88ef">wolfSSL_CertManagerSetCRL_Cb</a></div><div class="ttdeci">int wolfSSL_CertManagerSetCRL_Cb(WOLFSSL_CERT_MANAGER *cm, CbMissingCRL cb)</div><div class="ttdoc">This function sets the CRL Certificate Manager callback. If HAVE_CRL is defined and a matching CRL re...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd>CbMissingCRL </dd>
<dd>
<a class="el" href="ssl_8h.html#a761a40b527f38ba2df833fe8b51a8408" title="Sets the CRL callback in the WOLFSSL_CERT_MANAGER structure.">wolfSSL_SetCRL_Cb</a> </dd></dl>

</div>
</div>
<a id="gab2481c2d71595eccaf7955ca4f3c0312" name="gab2481c2d71595eccaf7955ca4f3c0312"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab2481c2d71595eccaf7955ca4f3c0312">&#9670;&#160;</a></span>wolfSSL_CertManagerSetCRLUpdate_Cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wolfSSL_CertManagerSetCRLUpdate_Cb </td>
          <td>(</td>
          <td class="paramtype">WOLFSSL_CERT_MANAGER *</td>          <td class="paramname"><span class="paramname"><em>cm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CbUpdateCRL</td>          <td class="paramname"><span class="paramname"><em>cb</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function sets the CRL Update callback. If HAVE_CRL and HAVE_CRL_UPDATE_CB is defined , and an entry with the same issuer and a lower CRL number exists when a CRL is added, then the CbUpdateCRL is called with the details of the existing entry and the new one replacing it. </p>
<dl class="section return"><dt>Returns</dt><dd>SSL_SUCCESS returned upon successful execution of the function and subroutines. </dd>
<dd>
BAD_FUNC_ARG returned if the WOLFSSL_CERT_MANAGER structure is NULL.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cm</td><td>the WOLFSSL_CERT_MANAGER structure holding the information for the certificate. </td></tr>
    <tr><td class="paramname">cb</td><td>a function pointer to (*CbUpdateCRL) that is set to the cbUpdateCRL member of the WOLFSSL_CERT_MANAGER. Signature requirement: void (*CbUpdateCRL)(CrlInfo *old, CrlInfo *new);</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;wolfssl/ssl.h&gt;</span></div>
<div class="line"> </div>
<div class="line">WOLFSSL_CTX* ctx = <a class="code hl_function" href="group__Setup.html#ga2bcaa81e9fd11074c6e504891370dd45">wolfSSL_CTX_new</a>(protocol method);</div>
<div class="line">WOLFSSL* ssl = <a class="code hl_function" href="group__Setup.html#gab6d54b7485d74962e57bc636008aa9a0">wolfSSL_new</a>(ctx);</div>
<div class="line">…</div>
<div class="line"><span class="keywordtype">void</span> cb(CrlInfo *old, CrlInfo *<span class="keyword">new</span>){</div>
<div class="line">    Function body.</div>
<div class="line">}</div>
<div class="line">…</div>
<div class="line">CbUpdateCRL cb = CbUpdateCRL;</div>
<div class="line">…</div>
<div class="line"><span class="keywordflow">if</span>(ctx){</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_function" href="#gab2481c2d71595eccaf7955ca4f3c0312">wolfSSL_CertManagerSetCRLUpdate_Cb</a>(SSL_CM(ssl), cb);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__CertManager_html_gab2481c2d71595eccaf7955ca4f3c0312"><div class="ttname"><a href="#gab2481c2d71595eccaf7955ca4f3c0312">wolfSSL_CertManagerSetCRLUpdate_Cb</a></div><div class="ttdeci">int wolfSSL_CertManagerSetCRLUpdate_Cb(WOLFSSL_CERT_MANAGER *cm, CbUpdateCRL cb)</div><div class="ttdoc">This function sets the CRL Update callback. If HAVE_CRL and HAVE_CRL_UPDATE_CB is defined ,...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd>CbUpdateCRL </dd></dl>

</div>
</div>
<a id="ga40598eacaa03af2e003e95f57ddd30a9" name="ga40598eacaa03af2e003e95f57ddd30a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga40598eacaa03af2e003e95f57ddd30a9">&#9670;&#160;</a></span>wolfSSL_CertManagerSetOCSP_Cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wolfSSL_CertManagerSetOCSP_Cb </td>
          <td>(</td>
          <td class="paramtype">WOLFSSL_CERT_MANAGER *</td>          <td class="paramname"><span class="paramname"><em>cm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CbOCSPIO</td>          <td class="paramname"><span class="paramname"><em>ioCb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CbOCSPRespFree</td>          <td class="paramname"><span class="paramname"><em>respFreeCb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>ioCbCtx</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The function sets the OCSP callback in the WOLFSSL_CERT_MANAGER. </p>
<dl class="section return"><dt>Returns</dt><dd>SSL_SUCCESS returned on successful execution. The arguments are saved in the WOLFSSL_CERT_MANAGER structure. </dd>
<dd>
BAD_FUNC_ARG returned if the WOLFSSL_CERT_MANAGER is NULL.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cm</td><td>a pointer to a WOLFSSL_CERT_MANAGER structure. </td></tr>
    <tr><td class="paramname">ioCb</td><td>a function pointer of type CbOCSPIO. </td></tr>
    <tr><td class="paramname">respFreeCb</td><td>- a function pointer of type CbOCSPRespFree. </td></tr>
    <tr><td class="paramname">ioCbCtx</td><td>- a void pointer variable to the I/O callback user registered context.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;wolfssl/ssl.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="ssl_8h.html#a6eb9a96acfa1bedbcdbc4e89fbb8a43a">wolfSSL_SetOCSP_Cb</a>(WOLFSSL* ssl, CbOCSPIO ioCb,</div>
<div class="line">CbOCSPRespFree respFreeCb, <span class="keywordtype">void</span>* ioCbCtx){</div>
<div class="line">…</div>
<div class="line"><span class="keywordflow">return</span> <a class="code hl_function" href="#ga40598eacaa03af2e003e95f57ddd30a9">wolfSSL_CertManagerSetOCSP_Cb</a>(SSL_CM(ssl), ioCb, respFreeCb, ioCbCtx);</div>
<div class="ttc" id="agroup__CertManager_html_ga40598eacaa03af2e003e95f57ddd30a9"><div class="ttname"><a href="#ga40598eacaa03af2e003e95f57ddd30a9">wolfSSL_CertManagerSetOCSP_Cb</a></div><div class="ttdeci">int wolfSSL_CertManagerSetOCSP_Cb(WOLFSSL_CERT_MANAGER *cm, CbOCSPIO ioCb, CbOCSPRespFree respFreeCb, void *ioCbCtx)</div><div class="ttdoc">The function sets the OCSP callback in the WOLFSSL_CERT_MANAGER.</div></div>
<div class="ttc" id="assl_8h_html_a6eb9a96acfa1bedbcdbc4e89fbb8a43a"><div class="ttname"><a href="ssl_8h.html#a6eb9a96acfa1bedbcdbc4e89fbb8a43a">wolfSSL_SetOCSP_Cb</a></div><div class="ttdeci">int wolfSSL_SetOCSP_Cb(WOLFSSL *ssl, CbOCSPIO ioCb, CbOCSPRespFree respFreeCb, void *ioCbCtx)</div><div class="ttdoc">This function sets the OCSP callback in the WOLFSSL_CERT_MANAGER structure.</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaae16a6566a0a4ac899ca94e8b9869158" title="The function copies the url to the ocspOverrideURL member of the WOLFSSL_CERT_MANAGER structure.">wolfSSL_CertManagerSetOCSPOverrideURL</a> </dd>
<dd>
<a class="el" href="#ga53ff0bfe288d67722d794facebc09543" title="The function enables the WOLFSSL_CERT_MANAGER’s member, ocspEnabled to signify that the OCSP check op...">wolfSSL_CertManagerCheckOCSP</a> </dd>
<dd>
<a class="el" href="#gac17294be4393a23f98c7004217376dae" title="This function turns on OCSP stapling if it is not turned on as well as set the options.">wolfSSL_CertManagerEnableOCSPStapling</a> </dd>
<dd>
<a class="el" href="ssl_8h.html#a1c18a7ff26ebcb9453dc2f6616b8950b" title="This function enables OCSP certificate verification. The value of options if formed by or’ing one or ...">wolfSSL_EnableOCSP</a> </dd>
<dd>
<a class="el" href="ssl_8h.html#abb7c9ec80311c16f4223f53e5ec8449e" title="Disables the OCSP certificate revocation option.">wolfSSL_DisableOCSP</a> </dd>
<dd>
<a class="el" href="ssl_8h.html#a6eb9a96acfa1bedbcdbc4e89fbb8a43a" title="This function sets the OCSP callback in the WOLFSSL_CERT_MANAGER structure.">wolfSSL_SetOCSP_Cb</a> </dd></dl>

</div>
</div>
<a id="gaae16a6566a0a4ac899ca94e8b9869158" name="gaae16a6566a0a4ac899ca94e8b9869158"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaae16a6566a0a4ac899ca94e8b9869158">&#9670;&#160;</a></span>wolfSSL_CertManagerSetOCSPOverrideURL()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wolfSSL_CertManagerSetOCSPOverrideURL </td>
          <td>(</td>
          <td class="paramtype">WOLFSSL_CERT_MANAGER *</td>          <td class="paramname"><span class="paramname"><em>cm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>url</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The function copies the url to the ocspOverrideURL member of the WOLFSSL_CERT_MANAGER structure. </p>
<dl class="section return"><dt>Returns</dt><dd>SSL_SUCCESS the function was able to execute as expected. </dd>
<dd>
BAD_FUNC_ARG the WOLFSSL_CERT_MANAGER struct is NULL. </dd>
<dd>
MEMEORY_E Memory was not able to be allocated for the ocspOverrideURL member of the certificate manager.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssl</td><td>a pointer to a WOLFSSL structure, created using <a class="el" href="group__Setup.html#gab6d54b7485d74962e57bc636008aa9a0" title="This function creates a new SSL session, taking an already created SSL context as input.">wolfSSL_new()</a>.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;wolfssl/ssl.h&gt;</span></div>
<div class="line">WOLFSSL_CERT_MANAGER* cm = <a class="code hl_function" href="#ga654752c1994c9e87fe5e97af0c16ea63">wolfSSL_CertManagerNew</a>();</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span>* url;</div>
<div class="line">…</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="ssl_8h.html#adecc0f6f1d5156e7e0e2ca364fffecd4">wolfSSL_SetOCSP_OverrideURL</a>(WOLFSSL* ssl, <span class="keyword">const</span> <span class="keywordtype">char</span>* url)</div>
<div class="line">…</div>
<div class="line"><span class="keywordflow">if</span>(<a class="code hl_function" href="#gaae16a6566a0a4ac899ca94e8b9869158">wolfSSL_CertManagerSetOCSPOverrideURL</a>(SSL_CM(ssl), url) != SSL_SUCCESS){</div>
<div class="line">    Failure <span class="keywordflow">case</span>.</div>
<div class="line">}</div>
<div class="ttc" id="agroup__CertManager_html_gaae16a6566a0a4ac899ca94e8b9869158"><div class="ttname"><a href="#gaae16a6566a0a4ac899ca94e8b9869158">wolfSSL_CertManagerSetOCSPOverrideURL</a></div><div class="ttdeci">int wolfSSL_CertManagerSetOCSPOverrideURL(WOLFSSL_CERT_MANAGER *cm, const char *url)</div><div class="ttdoc">The function copies the url to the ocspOverrideURL member of the WOLFSSL_CERT_MANAGER structure.</div></div>
<div class="ttc" id="assl_8h_html_adecc0f6f1d5156e7e0e2ca364fffecd4"><div class="ttname"><a href="ssl_8h.html#adecc0f6f1d5156e7e0e2ca364fffecd4">wolfSSL_SetOCSP_OverrideURL</a></div><div class="ttdeci">int wolfSSL_SetOCSP_OverrideURL(WOLFSSL *ssl, const char *url)</div><div class="ttdoc">This function sets the ocspOverrideURL member in the WOLFSSL_CERT_MANAGER structure.</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd>ocspOverrideURL </dd>
<dd>
<a class="el" href="ssl_8h.html#adecc0f6f1d5156e7e0e2ca364fffecd4" title="This function sets the ocspOverrideURL member in the WOLFSSL_CERT_MANAGER structure.">wolfSSL_SetOCSP_OverrideURL</a> </dd></dl>

</div>
</div>
<a id="gaae21fa2f6d4b04512bee2bc17ef0fcef" name="gaae21fa2f6d4b04512bee2bc17ef0fcef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaae21fa2f6d4b04512bee2bc17ef0fcef">&#9670;&#160;</a></span>wolfSSL_CertManagerSetVerify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wolfSSL_CertManagerSetVerify </td>
          <td>(</td>
          <td class="paramtype">WOLFSSL_CERT_MANAGER *</td>          <td class="paramname"><span class="paramname"><em>cm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VerifyCallback</td>          <td class="paramname"><span class="paramname"><em>verify_callback</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The function sets the verifyCallback function in the Certificate Manager. If present, it will be called for each cert loaded. If there is a verification error, the verify callback can be used to over-ride the error. </p>
<dl class="section return"><dt>Returns</dt><dd>none No return.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cm</td><td>a pointer to a WOLFSSL_CERT_MANAGER structure, created using <a class="el" href="#ga654752c1994c9e87fe5e97af0c16ea63" title="Allocates and initializes a new Certificate Manager context. This context may be used independent of ...">wolfSSL_CertManagerNew()</a>. </td></tr>
    <tr><td class="paramname">verify_callback</td><td>a VerifyCallback function pointer to the callback routine</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;wolfssl/ssl.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> myVerify(<span class="keywordtype">int</span> preverify, WOLFSSL_X509_STORE_CTX* store)</div>
<div class="line">{ <span class="comment">// do custom verification of certificate }</span></div>
<div class="line"> </div>
<div class="line">WOLFSSL_CTX* ctx = WOLFSSL_CTX_new(Protocol define);</div>
<div class="line">WOLFSSL_CERT_MANAGER* cm = <a class="code hl_function" href="#ga654752c1994c9e87fe5e97af0c16ea63">wolfSSL_CertManagerNew</a>();</div>
<div class="line">...</div>
<div class="line">wolfSSL_CertManagerSetVerify(cm, myVerify);</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga02a2f8451f6b5583f84e30ed9b192839" title="Specifies the certificate to verify with the Certificate Manager context. The format can be SSL_FILET...">wolfSSL_CertManagerVerify</a> </dd></dl>

</div>
</div>
<a id="ga4ac407be88acf2b8c329fbca68bd4163" name="ga4ac407be88acf2b8c329fbca68bd4163"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4ac407be88acf2b8c329fbca68bd4163">&#9670;&#160;</a></span>wolfSSL_CertManagerUnload_trust_peers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wolfSSL_CertManagerUnload_trust_peers </td>
          <td>(</td>
          <td class="paramtype">WOLFSSL_CERT_MANAGER *</td>          <td class="paramname"><span class="paramname"><em>cm</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The function will free the Trusted Peer linked list and unlocks the trusted peer list. </p>
<dl class="section return"><dt>Returns</dt><dd>SSL_SUCCESS if the function completed normally. </dd>
<dd>
BAD_FUNC_ARG if the WOLFSSL_CERT_MANAGER is NULL. </dd>
<dd>
BAD_MUTEX_E mutex error if tpLock, a member of the WOLFSSL_CERT_MANAGER struct, is 0 (nill).</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cm</td><td>a pointer to a WOLFSSL_CERT_MANAGER structure, created using <a class="el" href="#ga654752c1994c9e87fe5e97af0c16ea63" title="Allocates and initializes a new Certificate Manager context. This context may be used independent of ...">wolfSSL_CertManagerNew()</a>.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;wolfssl/ssl.h&gt;</span></div>
<div class="line"> </div>
<div class="line">WOLFSSL_CTX* ctx = WOLFSSL_CTX_new(Protocol define);</div>
<div class="line">WOLFSSL_CERT_MANAGER* cm = <a class="code hl_function" href="#ga654752c1994c9e87fe5e97af0c16ea63">wolfSSL_CertManagerNew</a>();</div>
<div class="line">...</div>
<div class="line">if(<a class="code hl_function" href="#ga4ac407be88acf2b8c329fbca68bd4163">wolfSSL_CertManagerUnload_trust_peers</a>(cm) != SSL_SUCCESS){</div>
<div class="line">    The function did not execute successfully.</div>
<div class="line">}</div>
<div class="ttc" id="agroup__CertManager_html_ga4ac407be88acf2b8c329fbca68bd4163"><div class="ttname"><a href="#ga4ac407be88acf2b8c329fbca68bd4163">wolfSSL_CertManagerUnload_trust_peers</a></div><div class="ttdeci">int wolfSSL_CertManagerUnload_trust_peers(WOLFSSL_CERT_MANAGER *cm)</div><div class="ttdoc">The function will free the Trusted Peer linked list and unlocks the trusted peer list.</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd>UnLockMutex </dd></dl>

</div>
</div>
<a id="ga6435f45bfaeb5a5e282a73df2f160475" name="ga6435f45bfaeb5a5e282a73df2f160475"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6435f45bfaeb5a5e282a73df2f160475">&#9670;&#160;</a></span>wolfSSL_CertManagerUnloadCAs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wolfSSL_CertManagerUnloadCAs </td>
          <td>(</td>
          <td class="paramtype">WOLFSSL_CERT_MANAGER *</td>          <td class="paramname"><span class="paramname"><em>cm</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function unloads the CA signer list. </p>
<dl class="section return"><dt>Returns</dt><dd>SSL_SUCCESS returned on successful execution of the function. </dd>
<dd>
BAD_FUNC_ARG returned if the WOLFSSL_CERT_MANAGER is NULL. </dd>
<dd>
BAD_MUTEX_E returned if there was a mutex error.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cm</td><td>a pointer to a WOLFSSL_CERT_MANAGER structure, created using <a class="el" href="#ga654752c1994c9e87fe5e97af0c16ea63" title="Allocates and initializes a new Certificate Manager context. This context may be used independent of ...">wolfSSL_CertManagerNew()</a>.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;wolfssl/ssl.h&gt;</span></div>
<div class="line"> </div>
<div class="line">WOLFSSL_CTX* ctx = <a class="code hl_function" href="group__Setup.html#ga2bcaa81e9fd11074c6e504891370dd45">wolfSSL_CTX_new</a>(protocol method);</div>
<div class="line">WOLFSSL_CERT_MANAGER* cm = wolfSSL_CTX_GetCertManager(ctx);</div>
<div class="line">...</div>
<div class="line">if(<a class="code hl_function" href="#ga6435f45bfaeb5a5e282a73df2f160475">wolfSSL_CertManagerUnloadCAs</a>(cm) != SSL_SUCCESS){</div>
<div class="line">    Failure <span class="keywordflow">case</span>.</div>
<div class="line">}</div>
<div class="ttc" id="agroup__CertManager_html_ga6435f45bfaeb5a5e282a73df2f160475"><div class="ttname"><a href="#ga6435f45bfaeb5a5e282a73df2f160475">wolfSSL_CertManagerUnloadCAs</a></div><div class="ttdeci">int wolfSSL_CertManagerUnloadCAs(WOLFSSL_CERT_MANAGER *cm)</div><div class="ttdoc">This function unloads the CA signer list.</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd>UnlockMutex </dd></dl>

</div>
</div>
<a id="ga80cf4ee881a11c5f973aa6971ed01373" name="ga80cf4ee881a11c5f973aa6971ed01373"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga80cf4ee881a11c5f973aa6971ed01373">&#9670;&#160;</a></span>wolfSSL_CertManagerUnloadIntermediateCerts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wolfSSL_CertManagerUnloadIntermediateCerts </td>
          <td>(</td>
          <td class="paramtype">WOLFSSL_CERT_MANAGER *</td>          <td class="paramname"><span class="paramname"><em>cm</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function unloads intermediate certificates add to the CA signer list. </p>
<dl class="section return"><dt>Returns</dt><dd>SSL_SUCCESS returned on successful execution of the function. </dd>
<dd>
BAD_FUNC_ARG returned if the WOLFSSL_CERT_MANAGER is NULL. </dd>
<dd>
BAD_MUTEX_E returned if there was a mutex error.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cm</td><td>a pointer to a WOLFSSL_CERT_MANAGER structure, created using <a class="el" href="#ga654752c1994c9e87fe5e97af0c16ea63" title="Allocates and initializes a new Certificate Manager context. This context may be used independent of ...">wolfSSL_CertManagerNew()</a>.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;wolfssl/ssl.h&gt;</span></div>
<div class="line"> </div>
<div class="line">WOLFSSL_CTX* ctx = <a class="code hl_function" href="group__Setup.html#ga2bcaa81e9fd11074c6e504891370dd45">wolfSSL_CTX_new</a>(protocol method);</div>
<div class="line">WOLFSSL_CERT_MANAGER* cm = wolfSSL_CTX_GetCertManager(ctx);</div>
<div class="line">...</div>
<div class="line">if(<a class="code hl_function" href="#ga80cf4ee881a11c5f973aa6971ed01373">wolfSSL_CertManagerUnloadIntermediateCerts</a>(cm) != SSL_SUCCESS){</div>
<div class="line">    Failure <span class="keywordflow">case</span>.</div>
<div class="line">}</div>
<div class="ttc" id="agroup__CertManager_html_ga80cf4ee881a11c5f973aa6971ed01373"><div class="ttname"><a href="#ga80cf4ee881a11c5f973aa6971ed01373">wolfSSL_CertManagerUnloadIntermediateCerts</a></div><div class="ttdeci">int wolfSSL_CertManagerUnloadIntermediateCerts(WOLFSSL_CERT_MANAGER *cm)</div><div class="ttdoc">This function unloads intermediate certificates add to the CA signer list.</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd>UnlockMutex </dd></dl>

</div>
</div>
<a id="ga02a2f8451f6b5583f84e30ed9b192839" name="ga02a2f8451f6b5583f84e30ed9b192839"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga02a2f8451f6b5583f84e30ed9b192839">&#9670;&#160;</a></span>wolfSSL_CertManagerVerify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wolfSSL_CertManagerVerify </td>
          <td>(</td>
          <td class="paramtype">WOLFSSL_CERT_MANAGER *</td>          <td class="paramname"><span class="paramname"><em>cm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>format</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Specifies the certificate to verify with the Certificate Manager context. The format can be SSL_FILETYPE_PEM or SSL_FILETYPE_ASN1. </p>
<dl class="section return"><dt>Returns</dt><dd>SSL_SUCCESS If successful. </dd>
<dd>
ASN_SIG_CONFIRM_E will be returned if the signature could not be verified. </dd>
<dd>
ASN_SIG_OID_E will be returned if the signature type is not supported. </dd>
<dd>
CRL_CERT_REVOKED is an error that is returned if this certificate has been revoked. </dd>
<dd>
CRL_MISSING is an error that is returned if a current issuer CRL is not available. </dd>
<dd>
ASN_BEFORE_DATE_E will be returned if the current date is before the before date. </dd>
<dd>
ASN_AFTER_DATE_E will be returned if the current date is after the after date. </dd>
<dd>
SSL_BAD_FILETYPE will be returned if the file is the wrong format. </dd>
<dd>
SSL_BAD_FILE will be returned if the file doesn’t exist, can’t be read, or is corrupted. </dd>
<dd>
MEMORY_E will be returned if an out of memory condition occurs. </dd>
<dd>
ASN_INPUT_E will be returned if Base16 decoding fails on the file. </dd>
<dd>
BAD_FUNC_ARG is the error that will be returned if a pointer is not provided.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cm</td><td>a pointer to a WOLFSSL_CERT_MANAGER structure, created using <a class="el" href="#ga654752c1994c9e87fe5e97af0c16ea63" title="Allocates and initializes a new Certificate Manager context. This context may be used independent of ...">wolfSSL_CertManagerNew()</a>. </td></tr>
    <tr><td class="paramname">fname</td><td>pointer to the name of the file containing the certificates to verify. </td></tr>
    <tr><td class="paramname">format</td><td>format of the certificate to verify - either SSL_FILETYPE_ASN1 or SSL_FILETYPE_PEM.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> ret = 0;</div>
<div class="line">WOLFSSL_CERT_MANAGER* cm;</div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line">ret = <a class="code hl_function" href="#ga02a2f8451f6b5583f84e30ed9b192839">wolfSSL_CertManagerVerify</a>(cm, “path/to/cert-file.pem”,</div>
<div class="line">SSL_FILETYPE_PEM);</div>
<div class="line"><span class="keywordflow">if</span> (ret != SSL_SUCCESS) {</div>
<div class="line">    error verifying certificate</div>
<div class="line">}</div>
<div class="ttc" id="agroup__CertManager_html_ga02a2f8451f6b5583f84e30ed9b192839"><div class="ttname"><a href="#ga02a2f8451f6b5583f84e30ed9b192839">wolfSSL_CertManagerVerify</a></div><div class="ttdeci">int wolfSSL_CertManagerVerify(WOLFSSL_CERT_MANAGER *cm, const char *f, int format)</div><div class="ttdoc">Specifies the certificate to verify with the Certificate Manager context. The format can be SSL_FILET...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga548767c9d7da9a197a746a148f1bda3b" title="Specifies the locations for CA certificate loading into the manager context. The PEM certificate CAfi...">wolfSSL_CertManagerLoadCA</a> </dd>
<dd>
<a class="el" href="#ga33fb6d3ecbea2b276f0cbef1e179fb07" title="Specifies the certificate buffer to verify with the Certificate Manager context. The format can be SS...">wolfSSL_CertManagerVerifyBuffer</a> </dd></dl>

</div>
</div>
<a id="ga33fb6d3ecbea2b276f0cbef1e179fb07" name="ga33fb6d3ecbea2b276f0cbef1e179fb07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga33fb6d3ecbea2b276f0cbef1e179fb07">&#9670;&#160;</a></span>wolfSSL_CertManagerVerifyBuffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wolfSSL_CertManagerVerifyBuffer </td>
          <td>(</td>
          <td class="paramtype">WOLFSSL_CERT_MANAGER *</td>          <td class="paramname"><span class="paramname"><em>cm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *</td>          <td class="paramname"><span class="paramname"><em>buff</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>sz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>format</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Specifies the certificate buffer to verify with the Certificate Manager context. The format can be SSL_FILETYPE_PEM or SSL_FILETYPE_ASN1. </p>
<dl class="section return"><dt>Returns</dt><dd>SSL_SUCCESS If successful. </dd>
<dd>
ASN_SIG_CONFIRM_E will be returned if the signature could not be verified. </dd>
<dd>
ASN_SIG_OID_E will be returned if the signature type is not supported. </dd>
<dd>
CRL_CERT_REVOKED is an error that is returned if this certificate has been revoked. </dd>
<dd>
CRL_MISSING is an error that is returned if a current issuer CRL is not available. </dd>
<dd>
ASN_BEFORE_DATE_E will be returned if the current date is before the before date. </dd>
<dd>
ASN_AFTER_DATE_E will be returned if the current date is after the after date. </dd>
<dd>
SSL_BAD_FILETYPE will be returned if the file is the wrong format. </dd>
<dd>
SSL_BAD_FILE will be returned if the file doesn’t exist, can’t be read, or is corrupted. </dd>
<dd>
MEMORY_E will be returned if an out of memory condition occurs. </dd>
<dd>
ASN_INPUT_E will be returned if Base16 decoding fails on the file. </dd>
<dd>
BAD_FUNC_ARG is the error that will be returned if a pointer is not provided.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cm</td><td>a pointer to a WOLFSSL_CERT_MANAGER structure, created using <a class="el" href="#ga654752c1994c9e87fe5e97af0c16ea63" title="Allocates and initializes a new Certificate Manager context. This context may be used independent of ...">wolfSSL_CertManagerNew()</a>. </td></tr>
    <tr><td class="paramname">buff</td><td>buffer containing the certificates to verify. </td></tr>
    <tr><td class="paramname">sz</td><td>size of the buffer, buf. </td></tr>
    <tr><td class="paramname">format</td><td>format of the certificate to verify, located in buf - either SSL_FILETYPE_ASN1 or SSL_FILETYPE_PEM.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;wolfssl/ssl.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> ret = 0;</div>
<div class="line"><span class="keywordtype">int</span> sz = 0;</div>
<div class="line">WOLFSSL_CERT_MANAGER* cm;</div>
<div class="line"><span class="keywordtype">byte</span> certBuff[...];</div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line">ret = <a class="code hl_function" href="#ga33fb6d3ecbea2b276f0cbef1e179fb07">wolfSSL_CertManagerVerifyBuffer</a>(cm, certBuff, sz, SSL_FILETYPE_PEM);</div>
<div class="line"><span class="keywordflow">if</span> (ret != SSL_SUCCESS) {</div>
<div class="line">    error verifying certificate</div>
<div class="line">}</div>
<div class="ttc" id="agroup__CertManager_html_ga33fb6d3ecbea2b276f0cbef1e179fb07"><div class="ttname"><a href="#ga33fb6d3ecbea2b276f0cbef1e179fb07">wolfSSL_CertManagerVerifyBuffer</a></div><div class="ttdeci">int wolfSSL_CertManagerVerifyBuffer(WOLFSSL_CERT_MANAGER *cm, const unsigned char *buff, long sz, int format)</div><div class="ttdoc">Specifies the certificate buffer to verify with the Certificate Manager context. The format can be SS...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga548767c9d7da9a197a746a148f1bda3b" title="Specifies the locations for CA certificate loading into the manager context. The PEM certificate CAfi...">wolfSSL_CertManagerLoadCA</a> </dd>
<dd>
<a class="el" href="#ga02a2f8451f6b5583f84e30ed9b192839" title="Specifies the certificate to verify with the Certificate Manager context. The format can be SSL_FILET...">wolfSSL_CertManagerVerify</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
