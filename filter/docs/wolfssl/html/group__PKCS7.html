<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>My Project: Algorithms - PKCS7</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="wolfssl_logo" style="width: 150px; height: 100px; display: inline-block;"><img alt="Logo" src="../images/wolfssl_logo.png" style="width: 150px; height: 100px;"/></div>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Algorithms - PKCS7 </div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-typedef-members" class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga7908ba7d7370c41fddb4d6220c248ffa" id="r_ga7908ba7d7370c41fddb4d6220c248ffa"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga7908ba7d7370c41fddb4d6220c248ffa">CallbackAESKeyWrapUnwrap</a>) (const byte *key, word32 keySz, const byte *in, word32 inSz, int wrap, byte *out, word32 outSz)</td></tr>
<tr class="memdesc:ga7908ba7d7370c41fddb4d6220c248ffa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback used for a custom AES key wrap/unwrap operation.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga2ea444dffff344d027f39dec06839ae6" id="r_ga2ea444dffff344d027f39dec06839ae6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga2ea444dffff344d027f39dec06839ae6">wc_PKCS7_InitWithCert</a> (PKCS7 *pkcs7, byte *cert, word32 certSz)</td></tr>
<tr class="memdesc:ga2ea444dffff344d027f39dec06839ae6"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function initializes a PKCS7 structure with a DER-formatted certificate. To initialize an empty PKCS7 structure, one can pass in a NULL cert and 0 for certSz.  <br /></td></tr>
<tr class="memitem:ga50ffee7d86334b031b873ca62c73ada0" id="r_ga50ffee7d86334b031b873ca62c73ada0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga50ffee7d86334b031b873ca62c73ada0">wc_PKCS7_Free</a> (PKCS7 *pkcs7)</td></tr>
<tr class="memdesc:ga50ffee7d86334b031b873ca62c73ada0"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function releases any memory allocated by a PKCS7 initializer.  <br /></td></tr>
<tr class="memitem:ga9c7bedf422dcb3771e2dc225b87d1634" id="r_ga9c7bedf422dcb3771e2dc225b87d1634"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga9c7bedf422dcb3771e2dc225b87d1634">wc_PKCS7_EncodeData</a> (PKCS7 *pkcs7, byte *output, word32 outputSz)</td></tr>
<tr class="memdesc:ga9c7bedf422dcb3771e2dc225b87d1634"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function builds the PKCS7 data content type, encoding the PKCS7 structure into a buffer containing a parsable PKCS7 data packet.  <br /></td></tr>
<tr class="memitem:ga24a757763a40935b784ebd7c5b8aba9c" id="r_ga24a757763a40935b784ebd7c5b8aba9c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga24a757763a40935b784ebd7c5b8aba9c">wc_PKCS7_EncodeSignedData</a> (PKCS7 *pkcs7, byte *output, word32 outputSz)</td></tr>
<tr class="memdesc:ga24a757763a40935b784ebd7c5b8aba9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function builds the PKCS7 signed data content type, encoding the PKCS7 structure into a buffer containing a parsable PKCS7 signed data packet.  <br /></td></tr>
<tr class="memitem:ga56d58b33ae2a77ebffef788dff227bcd" id="r_ga56d58b33ae2a77ebffef788dff227bcd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga56d58b33ae2a77ebffef788dff227bcd">wc_PKCS7_EncodeSignedData_ex</a> (PKCS7 *pkcs7, const byte *hashBuf, word32 hashSz, byte *outputHead, word32 *outputHeadSz, byte *outputFoot, word32 *outputFootSz)</td></tr>
<tr class="memdesc:ga56d58b33ae2a77ebffef788dff227bcd"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function builds the PKCS7 signed data content type, encoding the PKCS7 structure into a header and footer buffer containing a parsable PKCS7 signed data packet. This does not include the content. A hash must be computed and provided for the data.  <br /></td></tr>
<tr class="memitem:ga6ff4dae009941bd81213605807141571" id="r_ga6ff4dae009941bd81213605807141571"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga6ff4dae009941bd81213605807141571">wc_PKCS7_VerifySignedData</a> (PKCS7 *pkcs7, byte *pkiMsg, word32 pkiMsgSz)</td></tr>
<tr class="memdesc:ga6ff4dae009941bd81213605807141571"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes in a transmitted PKCS7 signed data message, extracts the certificate list and certificate revocation list, and then verifies the signature. It stores the extracted content in the given PKCS7 structure.  <br /></td></tr>
<tr class="memitem:gadfa60d99d79a88d232623682f8201d3a" id="r_gadfa60d99d79a88d232623682f8201d3a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gadfa60d99d79a88d232623682f8201d3a">wc_PKCS7_VerifySignedData_ex</a> (PKCS7 *pkcs7, const byte *hashBuf, word32 hashSz, byte *pkiMsgHead, word32 pkiMsgHeadSz, byte *pkiMsgFoot, word32 pkiMsgFootSz)</td></tr>
<tr class="memdesc:gadfa60d99d79a88d232623682f8201d3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes in a transmitted PKCS7 signed data message as hash/header/footer, then extracts the certificate list and certificate revocation list, and then verifies the signature. It stores the extracted content in the given PKCS7 structure.  <br /></td></tr>
<tr class="memitem:gaee101fc35740060a0a0469ed6c2cf175" id="r_gaee101fc35740060a0a0469ed6c2cf175"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaee101fc35740060a0a0469ed6c2cf175">wc_PKCS7_SetAESKeyWrapUnwrapCb</a> (wc_PKCS7 *pkcs7, <a class="el" href="#ga7908ba7d7370c41fddb4d6220c248ffa">CallbackAESKeyWrapUnwrap</a> aesKeyWrapCb)</td></tr>
<tr class="memdesc:gaee101fc35740060a0a0469ed6c2cf175"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the callback function to be used to perform a custom AES key wrap/unwrap operation.  <br /></td></tr>
<tr class="memitem:ga3b5cb91f5b7a54493f356633b4b661bf" id="r_ga3b5cb91f5b7a54493f356633b4b661bf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga3b5cb91f5b7a54493f356633b4b661bf">wc_PKCS7_EncodeEnvelopedData</a> (PKCS7 *pkcs7, byte *output, word32 outputSz)</td></tr>
<tr class="memdesc:ga3b5cb91f5b7a54493f356633b4b661bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function builds the PKCS7 enveloped data content type, encoding the PKCS7 structure into a buffer containing a parsable PKCS7 enveloped data packet.  <br /></td></tr>
<tr class="memitem:gaa5c5a7881e48eb07028dc58d34e7ca1e" id="r_gaa5c5a7881e48eb07028dc58d34e7ca1e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa5c5a7881e48eb07028dc58d34e7ca1e">wc_PKCS7_DecodeEnvelopedData</a> (PKCS7 *pkcs7, byte *pkiMsg, word32 pkiMsgSz, byte *output, word32 outputSz)</td></tr>
<tr class="memdesc:gaa5c5a7881e48eb07028dc58d34e7ca1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function unwraps and decrypts a PKCS7 enveloped data content type, decoding the message into output. It uses the private key of the PKCS7 object passed in to decrypt the message.  <br /></td></tr>
<tr class="memitem:gaaa38a871f6ff3a6965a1fbbdefebcc91" id="r_gaaa38a871f6ff3a6965a1fbbdefebcc91"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaaa38a871f6ff3a6965a1fbbdefebcc91">wc_PKCS7_GetEnvelopedDataKariRid</a> (const byte *in, word32 inSz, byte *out, word32 *outSz)</td></tr>
<tr class="memdesc:gaaa38a871f6ff3a6965a1fbbdefebcc91"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function extracts the KeyAgreeRecipientIdentifier object from an EnvelopedData package containing a KeyAgreeRecipientInfo RecipientInfo object. Only the first KeyAgreeRecipientIdentifer found in the first RecipientInfo is copied. This function does not support multiple RecipientInfo objects or multiple RecipientEncryptedKey objects within an KeyAgreeRecipientInfo.  <br /></td></tr>
<tr class="memitem:gaffbded0fe34b61b009209c77f8ec3ec1" id="r_gaffbded0fe34b61b009209c77f8ec3ec1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaffbded0fe34b61b009209c77f8ec3ec1">wc_PKCS7_DecodeEncryptedData</a> (PKCS7 *pkcs7, byte *pkiMsg, word32 pkiMsgSz, byte *output, word32 outputSz)</td></tr>
<tr class="memdesc:gaffbded0fe34b61b009209c77f8ec3ec1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function unwraps and decrypts a PKCS7 encrypted data content type, decoding the message into output. It uses the encryption key of the PKCS7 object passed in via pkcs7-&gt;encryptionKey and pkcs7-&gt;encryptionKeySz to decrypt the message.  <br /></td></tr>
<tr class="memitem:ga42a0bfe71c254c87fa0ec52a94608b35" id="r_ga42a0bfe71c254c87fa0ec52a94608b35"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga42a0bfe71c254c87fa0ec52a94608b35">wc_PKCS7_DecodeEncryptedKeyPackage</a> (wc_PKCS7 *pkcs7, byte *pkiMsg, word32 pkiMsgSz, byte *output, word32 outputSz)</td></tr>
<tr class="memdesc:ga42a0bfe71c254c87fa0ec52a94608b35"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function unwraps and decrypts a PKCS7 encrypted key package content type, decoding the message into output. If the wrapped content type is EncryptedData, the encryption key must be set in the pkcs7 input structure (via pkcs7-&gt;encryptionKey and pkcs7-&gt;encryptionKeySz). If the wrapped content type is EnvelopedData, the private key must be set in the pkcs7 input structure (via pkcs7-&gt;privateKey and pkcs7-&gt;privateKeySz). A wrapped content type of AuthEnvelopedData is not currently supported.  <br /></td></tr>
<tr class="memitem:gad91cdc05efd9a1e35727b9f47ad2b548" id="r_gad91cdc05efd9a1e35727b9f47ad2b548"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gad91cdc05efd9a1e35727b9f47ad2b548">wc_PKCS7_DecodeSymmetricKeyPackageAttribute</a> (const byte *skp, word32 skpSz, size_t index, const byte **attr, word32 *attrSz)</td></tr>
<tr class="memdesc:gad91cdc05efd9a1e35727b9f47ad2b548"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function provides access to a SymmetricKeyPackage attribute.  <br /></td></tr>
<tr class="memitem:ga419ae3d69c0468cd0ebf329c88ec4dbb" id="r_ga419ae3d69c0468cd0ebf329c88ec4dbb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga419ae3d69c0468cd0ebf329c88ec4dbb">wc_PKCS7_DecodeSymmetricKeyPackageKey</a> (const byte *skp, word32 skpSz, size_t index, const byte **key, word32 *keySz)</td></tr>
<tr class="memdesc:ga419ae3d69c0468cd0ebf329c88ec4dbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function provides access to a SymmetricKeyPackage key.  <br /></td></tr>
<tr class="memitem:ga3d360a928f18fb68b79372988008d7ef" id="r_ga3d360a928f18fb68b79372988008d7ef"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga3d360a928f18fb68b79372988008d7ef">wc_PKCS7_DecodeOneSymmetricKeyAttribute</a> (const byte *osk, word32 oskSz, size_t index, const byte **attr, word32 *attrSz)</td></tr>
<tr class="memdesc:ga3d360a928f18fb68b79372988008d7ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function provides access to a OneSymmetricKey attribute.  <br /></td></tr>
<tr class="memitem:gaa9d640790a88de1d325c21de34d624aa" id="r_gaa9d640790a88de1d325c21de34d624aa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa9d640790a88de1d325c21de34d624aa">wc_PKCS7_DecodeOneSymmetricKeyKey</a> (const byte *osk, word32 oskSz, const byte **key, word32 *keySz)</td></tr>
<tr class="memdesc:gaa9d640790a88de1d325c21de34d624aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function provides access to a OneSymmetricKey key.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<a name="doc-typedef-members" id="doc-typedef-members"></a><h2 id="header-doc-typedef-members" class="groupheader">Typedef Documentation</h2>
<a id="ga7908ba7d7370c41fddb4d6220c248ffa" name="ga7908ba7d7370c41fddb4d6220c248ffa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7908ba7d7370c41fddb4d6220c248ffa">&#9670;&#160;</a></span>CallbackAESKeyWrapUnwrap</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* CallbackAESKeyWrapUnwrap) (const byte *key, word32 keySz, const byte *in, word32 inSz, int wrap, byte *out, word32 outSz)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback used for a custom AES key wrap/unwrap operation. </p>
<dl class="section return"><dt>Returns</dt><dd>The size of the wrapped/unwrapped key written to the output buffer should be returned on success. A 0 return value or error code (&lt; 0) indicates a failure.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>Specify the key to use. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keySz</td><td>Size of the key to use. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">in</td><td>Specify the input data to wrap/unwrap. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inSz</td><td>Size of the input data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">wrap</td><td>1 if the requested operation is a key wrap, 0 for unwrap. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>Specify the output buffer. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">outSz</td><td>Size of the output buffer. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="gaffbded0fe34b61b009209c77f8ec3ec1" name="gaffbded0fe34b61b009209c77f8ec3ec1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaffbded0fe34b61b009209c77f8ec3ec1">&#9670;&#160;</a></span>wc_PKCS7_DecodeEncryptedData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_PKCS7_DecodeEncryptedData </td>
          <td>(</td>
          <td class="paramtype">PKCS7 *</td>          <td class="paramname"><span class="paramname"><em>pkcs7</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>pkiMsg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>pkiMsgSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>output</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>outputSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function unwraps and decrypts a PKCS7 encrypted data content type, decoding the message into output. It uses the encryption key of the PKCS7 object passed in via pkcs7-&gt;encryptionKey and pkcs7-&gt;encryptionKeySz to decrypt the message. </p>
<dl class="section return"><dt>Returns</dt><dd>On successfully extracting the information from the message, returns the bytes written to output </dd>
<dd>
BAD_FUNC_ARG Returned if one of the input parameters is invalid </dd>
<dd>
ASN_PARSE_E Returned if there is an error parsing the given pkiMsg </dd>
<dd>
PKCS7_OID_E Returned if the given pkiMsg is not an encrypted data type </dd>
<dd>
ASN_VERSION_E Returned if the PKCS7 signer info is not version 0 </dd>
<dd>
MEMORY_E Returned if there is an error allocating memory </dd>
<dd>
BUFFER_E Returned if the encrypted content size is invalid</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pkcs7</td><td>pointer to the PKCS7 structure containing the encryption key with which to decode the encrypted data package </td></tr>
    <tr><td class="paramname">pkiMsg</td><td>pointer to the buffer containing the encrypted data package </td></tr>
    <tr><td class="paramname">pkiMsgSz</td><td>size of the encrypted data package </td></tr>
    <tr><td class="paramname">output</td><td>pointer to the buffer in which to store the decoded message </td></tr>
    <tr><td class="paramname">outputSz</td><td>size available in the output buffer</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">PKCS7 pkcs7;</div>
<div class="line"><span class="keywordtype">byte</span> received[] = { }; <span class="comment">// initialize with received encrypted data message</span></div>
<div class="line"><span class="keywordtype">byte</span> decoded[FOURK_BUF];</div>
<div class="line"><span class="keywordtype">int</span> decodedSz;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// initialize pkcs7 with certificate</span></div>
<div class="line"><span class="comment">// update key</span></div>
<div class="line">pkcs7.encryptionKey = key;</div>
<div class="line">pkcs7.encryptionKeySz = keySz;</div>
<div class="line"> </div>
<div class="line">decodedSz = <a class="code hl_function" href="#gaffbded0fe34b61b009209c77f8ec3ec1">wc_PKCS7_DecodeEncryptedData</a>(&amp;pkcs7, received,</div>
<div class="line">    <span class="keyword">sizeof</span>(received), decoded, <span class="keyword">sizeof</span>(decoded));</div>
<div class="line"><span class="keywordflow">if</span> ( decodedSz &lt; 0 ) {</div>
<div class="line">    <span class="comment">// error decoding message</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__PKCS7_html_gaffbded0fe34b61b009209c77f8ec3ec1"><div class="ttname"><a href="#gaffbded0fe34b61b009209c77f8ec3ec1">wc_PKCS7_DecodeEncryptedData</a></div><div class="ttdeci">int wc_PKCS7_DecodeEncryptedData(PKCS7 *pkcs7, byte *pkiMsg, word32 pkiMsgSz, byte *output, word32 outputSz)</div><div class="ttdoc">This function unwraps and decrypts a PKCS7 encrypted data content type, decoding the message into out...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga2ea444dffff344d027f39dec06839ae6" title="This function initializes a PKCS7 structure with a DER-formatted certificate. To initialize an empty ...">wc_PKCS7_InitWithCert</a> </dd></dl>

</div>
</div>
<a id="ga42a0bfe71c254c87fa0ec52a94608b35" name="ga42a0bfe71c254c87fa0ec52a94608b35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga42a0bfe71c254c87fa0ec52a94608b35">&#9670;&#160;</a></span>wc_PKCS7_DecodeEncryptedKeyPackage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_PKCS7_DecodeEncryptedKeyPackage </td>
          <td>(</td>
          <td class="paramtype">wc_PKCS7 *</td>          <td class="paramname"><span class="paramname"><em>pkcs7</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>pkiMsg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>pkiMsgSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>output</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>outputSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function unwraps and decrypts a PKCS7 encrypted key package content type, decoding the message into output. If the wrapped content type is EncryptedData, the encryption key must be set in the pkcs7 input structure (via pkcs7-&gt;encryptionKey and pkcs7-&gt;encryptionKeySz). If the wrapped content type is EnvelopedData, the private key must be set in the pkcs7 input structure (via pkcs7-&gt;privateKey and pkcs7-&gt;privateKeySz). A wrapped content type of AuthEnvelopedData is not currently supported. </p>
<p>This function will automatically call either <a class="el" href="#gaa5c5a7881e48eb07028dc58d34e7ca1e" title="This function unwraps and decrypts a PKCS7 enveloped data content type, decoding the message into out...">wc_PKCS7_DecodeEnvelopedData()</a> or <a class="el" href="#gaffbded0fe34b61b009209c77f8ec3ec1" title="This function unwraps and decrypts a PKCS7 encrypted data content type, decoding the message into out...">wc_PKCS7_DecodeEncryptedData()</a> depending on the wrapped content type. This function could also return any error code from either of those functions in addition to the error codes listed here.</p>
<dl class="section return"><dt>Returns</dt><dd>On successfully extracting the information from the message, returns the bytes written to output </dd>
<dd>
BAD_FUNC_ARG Returned if one of the input parameters is invalid </dd>
<dd>
ASN_PARSE_E Returned if there is an error parsing the given pkiMsg or if the wrapped content type is EncryptedData and support for EncryptedData is not compiled in (e.g. NO_PKCS7_ENCRYPTED_DATA is set) </dd>
<dd>
PKCS7_OID_E Returned if the given pkiMsg is not an encrypted key package data type</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pkcs7</td><td>pointer to the PKCS7 structure containing the private key or encryption key with which to decode the encrypted key package </td></tr>
    <tr><td class="paramname">pkiMsg</td><td>pointer to the buffer containing the encrypted key package message </td></tr>
    <tr><td class="paramname">pkiMsgSz</td><td>size of the encrypted key package message </td></tr>
    <tr><td class="paramname">output</td><td>pointer to the buffer in which to store the decoded output </td></tr>
    <tr><td class="paramname">outputSz</td><td>size available in the output buffer</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">PKCS7 pkcs7;</div>
<div class="line"><span class="keywordtype">byte</span> received[] = { }; <span class="comment">// initialize with received encrypted data message</span></div>
<div class="line"><span class="keywordtype">byte</span> decoded[FOURK_BUF];</div>
<div class="line"><span class="keywordtype">int</span> decodedSz;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// initialize pkcs7 with certificate</span></div>
<div class="line"><span class="comment">// update key for expected EnvelopedData (example)</span></div>
<div class="line">pkcs7.privateKey = key;</div>
<div class="line">pkcs7.privateKeySz = keySz;</div>
<div class="line"> </div>
<div class="line">decodedSz = <a class="code hl_function" href="#ga42a0bfe71c254c87fa0ec52a94608b35">wc_PKCS7_DecodeEncryptedKeyPackage</a>(&amp;pkcs7, received,</div>
<div class="line">    <span class="keyword">sizeof</span>(received), decoded, <span class="keyword">sizeof</span>(decoded));</div>
<div class="line"><span class="keywordflow">if</span> ( decodedSz &lt; 0 ) {</div>
<div class="line">    <span class="comment">// error decoding message</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__PKCS7_html_ga42a0bfe71c254c87fa0ec52a94608b35"><div class="ttname"><a href="#ga42a0bfe71c254c87fa0ec52a94608b35">wc_PKCS7_DecodeEncryptedKeyPackage</a></div><div class="ttdeci">int wc_PKCS7_DecodeEncryptedKeyPackage(wc_PKCS7 *pkcs7, byte *pkiMsg, word32 pkiMsgSz, byte *output, word32 outputSz)</div><div class="ttdoc">This function unwraps and decrypts a PKCS7 encrypted key package content type, decoding the message i...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga2ea444dffff344d027f39dec06839ae6" title="This function initializes a PKCS7 structure with a DER-formatted certificate. To initialize an empty ...">wc_PKCS7_InitWithCert</a> </dd></dl>

</div>
</div>
<a id="gaa5c5a7881e48eb07028dc58d34e7ca1e" name="gaa5c5a7881e48eb07028dc58d34e7ca1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa5c5a7881e48eb07028dc58d34e7ca1e">&#9670;&#160;</a></span>wc_PKCS7_DecodeEnvelopedData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_PKCS7_DecodeEnvelopedData </td>
          <td>(</td>
          <td class="paramtype">PKCS7 *</td>          <td class="paramname"><span class="paramname"><em>pkcs7</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>pkiMsg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>pkiMsgSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>output</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>outputSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function unwraps and decrypts a PKCS7 enveloped data content type, decoding the message into output. It uses the private key of the PKCS7 object passed in to decrypt the message. </p>
<p>Note that if the EnvelopedData is encrypted using an ECC key and the KeyAgreementRecipientInfo structure, then either the HAVE_AES_KEYWRAP build option should be enabled to enable the wolfcrypt built-in AES key wrap/unwrap functionality, or a custom AES key wrap/unwrap callback should be set with <a class="el" href="#gaee101fc35740060a0a0469ed6c2cf175" title="Set the callback function to be used to perform a custom AES key wrap/unwrap operation.">wc_PKCS7_SetAESKeyWrapUnwrapCb()</a>. If neither of these is true, decryption will fail.</p>
<dl class="section return"><dt>Returns</dt><dd>On successfully extracting the information from the message, returns the bytes written to output </dd>
<dd>
BAD_FUNC_ARG Returned if one of the input parameters is invalid </dd>
<dd>
ASN_PARSE_E Returned if there is an error parsing the given pkiMsg </dd>
<dd>
PKCS7_OID_E Returned if the given pkiMsg is not an enveloped data type </dd>
<dd>
ASN_VERSION_E Returned if the PKCS7 signer info is not version 0 </dd>
<dd>
MEMORY_E Returned if there is an error allocating memory </dd>
<dd>
ALGO_ID_E Returned if the PKCS7 structure is using an unsupported algorithm type. Currently, only DESb and DES3b are supported for encryption, with RSAk for signature generation </dd>
<dd>
PKCS7_RECIP_E Returned if there is no recipient found in the enveloped data that matches the recipient provided </dd>
<dd>
RSA_BUFFER_E Returned if there is an error during RSA signature verification due to buffer error, output too small or input too large. </dd>
<dd>
MP_INIT_E may be returned if there is an error during signature verification </dd>
<dd>
MP_READ_E may be returned if there is an error during signature verification </dd>
<dd>
MP_CMP_E may be returned if there is an error during signature verification </dd>
<dd>
MP_INVMOD_E may be returned if there is an error during signature verification </dd>
<dd>
MP_EXPTMOD_E may be returned if there is an error during signature verification </dd>
<dd>
MP_MOD_E may be returned if there is an error during signature verification </dd>
<dd>
MP_MUL_E may be returned if there is an error during signature verification </dd>
<dd>
MP_ADD_E may be returned if there is an error during signature verification </dd>
<dd>
MP_MULMOD_E may be returned if there is an error during signature verification </dd>
<dd>
MP_TO_E may be returned if there is an error during signature verification </dd>
<dd>
MP_MEM may be returned if there is an error during signature verification </dd>
<dd>
NOT_COMPILED_IN may be returned if the EnvelopedData is encrypted using an ECC key and wolfssl was built without HAVE_X963_KDF support</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pkcs7</td><td>pointer to the PKCS7 structure containing the private key with which to decode the enveloped data package </td></tr>
    <tr><td class="paramname">pkiMsg</td><td>pointer to the buffer containing the enveloped data package </td></tr>
    <tr><td class="paramname">pkiMsgSz</td><td>size of the enveloped data package </td></tr>
    <tr><td class="paramname">output</td><td>pointer to the buffer in which to store the decoded message </td></tr>
    <tr><td class="paramname">outputSz</td><td>size available in the output buffer</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">PKCS7 pkcs7;</div>
<div class="line"><span class="keywordtype">byte</span> received[] = { }; <span class="comment">// initialize with received enveloped message</span></div>
<div class="line"><span class="keywordtype">byte</span> decoded[FOURK_BUF];</div>
<div class="line"><span class="keywordtype">int</span> decodedSz;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// initialize pkcs7 with certificate</span></div>
<div class="line"><span class="comment">// update key</span></div>
<div class="line">pkcs7.privateKey = key;</div>
<div class="line">pkcs7.privateKeySz = keySz;</div>
<div class="line"> </div>
<div class="line">decodedSz = <a class="code hl_function" href="#gaa5c5a7881e48eb07028dc58d34e7ca1e">wc_PKCS7_DecodeEnvelopedData</a>(&amp;pkcs7, received,</div>
<div class="line">    <span class="keyword">sizeof</span>(received),decoded, <span class="keyword">sizeof</span>(decoded));</div>
<div class="line"><span class="keywordflow">if</span> ( decodedSz &lt; 0 ) {</div>
<div class="line">    <span class="comment">// error decoding message</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__PKCS7_html_gaa5c5a7881e48eb07028dc58d34e7ca1e"><div class="ttname"><a href="#gaa5c5a7881e48eb07028dc58d34e7ca1e">wc_PKCS7_DecodeEnvelopedData</a></div><div class="ttdeci">int wc_PKCS7_DecodeEnvelopedData(PKCS7 *pkcs7, byte *pkiMsg, word32 pkiMsgSz, byte *output, word32 outputSz)</div><div class="ttdoc">This function unwraps and decrypts a PKCS7 enveloped data content type, decoding the message into out...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga2ea444dffff344d027f39dec06839ae6" title="This function initializes a PKCS7 structure with a DER-formatted certificate. To initialize an empty ...">wc_PKCS7_InitWithCert</a> </dd>
<dd>
<a class="el" href="#ga3b5cb91f5b7a54493f356633b4b661bf" title="This function builds the PKCS7 enveloped data content type, encoding the PKCS7 structure into a buffe...">wc_PKCS7_EncodeEnvelopedData</a> </dd></dl>

</div>
</div>
<a id="ga3d360a928f18fb68b79372988008d7ef" name="ga3d360a928f18fb68b79372988008d7ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3d360a928f18fb68b79372988008d7ef">&#9670;&#160;</a></span>wc_PKCS7_DecodeOneSymmetricKeyAttribute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_PKCS7_DecodeOneSymmetricKeyAttribute </td>
          <td>(</td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>osk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>oskSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>index</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte **</td>          <td class="paramname"><span class="paramname"><em>attr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32 *</td>          <td class="paramname"><span class="paramname"><em>attrSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function provides access to a OneSymmetricKey attribute. </p>
<dl class="section return"><dt>Returns</dt><dd>0 The requested attribute has been successfully located. attr and attrSz output variables are populated with the address and size of the attribute. The attribute will be in the same buffer passed in via the osk input pointer. </dd>
<dd>
BAD_FUNC_ARG One of the input parameters is invalid. </dd>
<dd>
ASN_PARSE_E An error was encountered parsing the input object. </dd>
<dd>
BAD_INDEX_E The requested attribute index was invalid.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">osk</td><td>Input buffer containing the OneSymmetricKey object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">oskSz</td><td>Size of the OneSymmetricKey object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Index of the attribute to access. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">attr</td><td>Buffer in which to store the pointer to the requested attribute object. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">attrSz</td><td>Buffer in which to store the size of the requested attribute object. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaa9d640790a88de1d325c21de34d624aa" name="gaa9d640790a88de1d325c21de34d624aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa9d640790a88de1d325c21de34d624aa">&#9670;&#160;</a></span>wc_PKCS7_DecodeOneSymmetricKeyKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_PKCS7_DecodeOneSymmetricKeyKey </td>
          <td>(</td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>osk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>oskSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte **</td>          <td class="paramname"><span class="paramname"><em>key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32 *</td>          <td class="paramname"><span class="paramname"><em>keySz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function provides access to a OneSymmetricKey key. </p>
<dl class="section return"><dt>Returns</dt><dd>0 The requested key has been successfully located. key and keySz output variables are populated with the address and size of the key. The key will be in the same buffer passed in via the osk input pointer. </dd>
<dd>
BAD_FUNC_ARG One of the input parameters is invalid. </dd>
<dd>
ASN_PARSE_E An error was encountered parsing the input object.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">osk</td><td>Input buffer containing the OneSymmetricKey object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">oskSz</td><td>Size of the OneSymmetricKey object. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">key</td><td>Buffer in which to store the pointer to the requested key object. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">keySz</td><td>Buffer in which to store the size of the requested key object. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gad91cdc05efd9a1e35727b9f47ad2b548" name="gad91cdc05efd9a1e35727b9f47ad2b548"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad91cdc05efd9a1e35727b9f47ad2b548">&#9670;&#160;</a></span>wc_PKCS7_DecodeSymmetricKeyPackageAttribute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_PKCS7_DecodeSymmetricKeyPackageAttribute </td>
          <td>(</td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>skp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>skpSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>index</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte **</td>          <td class="paramname"><span class="paramname"><em>attr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32 *</td>          <td class="paramname"><span class="paramname"><em>attrSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function provides access to a SymmetricKeyPackage attribute. </p>
<dl class="section return"><dt>Returns</dt><dd>0 The requested attribute has been successfully located. attr and attrSz output variables are populated with the address and size of the attribute. The attribute will be in the same buffer passed in via the skp input pointer. </dd>
<dd>
BAD_FUNC_ARG One of the input parameters is invalid. </dd>
<dd>
ASN_PARSE_E An error was encountered parsing the input object. </dd>
<dd>
BAD_INDEX_E The requested attribute index was invalid.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">skp</td><td>Input buffer containing the SymmetricKeyPackage object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">skpSz</td><td>Size of the SymmetricKeyPackage object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Index of the attribute to access. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">attr</td><td>Buffer in which to store the pointer to the requested attribute object. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">attrSz</td><td>Buffer in which to store the size of the requested attribute object. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga419ae3d69c0468cd0ebf329c88ec4dbb" name="ga419ae3d69c0468cd0ebf329c88ec4dbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga419ae3d69c0468cd0ebf329c88ec4dbb">&#9670;&#160;</a></span>wc_PKCS7_DecodeSymmetricKeyPackageKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_PKCS7_DecodeSymmetricKeyPackageKey </td>
          <td>(</td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>skp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>skpSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>index</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte **</td>          <td class="paramname"><span class="paramname"><em>key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32 *</td>          <td class="paramname"><span class="paramname"><em>keySz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function provides access to a SymmetricKeyPackage key. </p>
<dl class="section return"><dt>Returns</dt><dd>0 The requested key has been successfully located. key and keySz output variables are populated with the address and size of the key. The key will be in the same buffer passed in via the skp input pointer. </dd>
<dd>
BAD_FUNC_ARG One of the input parameters is invalid. </dd>
<dd>
ASN_PARSE_E An error was encountered parsing the input object. </dd>
<dd>
BAD_INDEX_E The requested key index was invalid.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">skp</td><td>Input buffer containing the SymmetricKeyPackage object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">skpSz</td><td>Size of the SymmetricKeyPackage object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Index of the key to access. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">key</td><td>Buffer in which to store the pointer to the requested key object. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">keySz</td><td>Buffer in which to store the size of the requested key object. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga9c7bedf422dcb3771e2dc225b87d1634" name="ga9c7bedf422dcb3771e2dc225b87d1634"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9c7bedf422dcb3771e2dc225b87d1634">&#9670;&#160;</a></span>wc_PKCS7_EncodeData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_PKCS7_EncodeData </td>
          <td>(</td>
          <td class="paramtype">PKCS7 *</td>          <td class="paramname"><span class="paramname"><em>pkcs7</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>output</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>outputSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function builds the PKCS7 data content type, encoding the PKCS7 structure into a buffer containing a parsable PKCS7 data packet. </p>
<dl class="section return"><dt>Returns</dt><dd>Success On successfully encoding the PKCS7 data into the buffer, returns the index parsed up to in the PKCS7 structure. This index also corresponds to the bytes written to the output buffer. </dd>
<dd>
BUFFER_E Returned if the given buffer is not large enough to hold the encoded certificate</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pkcs7</td><td>pointer to the PKCS7 structure to encode </td></tr>
    <tr><td class="paramname">output</td><td>pointer to the buffer in which to store the encoded certificate </td></tr>
    <tr><td class="paramname">outputSz</td><td>size available in the output buffer</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">PKCS7 pkcs7;</div>
<div class="line"><span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">byte</span> derBuff[] = { }; <span class="comment">// initialize with DER-encoded certificate</span></div>
<div class="line"><span class="keywordtype">byte</span> pkcs7Buff[FOURK_BUF];</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ga2ea444dffff344d027f39dec06839ae6">wc_PKCS7_InitWithCert</a>(&amp;pkcs7, derBuff, <span class="keyword">sizeof</span>(derBuff));</div>
<div class="line"><span class="comment">// update message and data to encode</span></div>
<div class="line">pkcs7.privateKey = key;</div>
<div class="line">pkcs7.privateKeySz = keySz;</div>
<div class="line">pkcs7.content = data;</div>
<div class="line">pkcs7.contentSz = dataSz;</div>
<div class="line">... etc.</div>
<div class="line"> </div>
<div class="line">ret = <a class="code hl_function" href="#ga9c7bedf422dcb3771e2dc225b87d1634">wc_PKCS7_EncodeData</a>(&amp;pkcs7, pkcs7Buff, <span class="keyword">sizeof</span>(pkcs7Buff));</div>
<div class="line"><span class="keywordflow">if</span> ( ret != 0 ) {</div>
<div class="line">    <span class="comment">// error encoding into output buffer</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__PKCS7_html_ga2ea444dffff344d027f39dec06839ae6"><div class="ttname"><a href="#ga2ea444dffff344d027f39dec06839ae6">wc_PKCS7_InitWithCert</a></div><div class="ttdeci">int wc_PKCS7_InitWithCert(PKCS7 *pkcs7, byte *cert, word32 certSz)</div><div class="ttdoc">This function initializes a PKCS7 structure with a DER-formatted certificate. To initialize an empty ...</div></div>
<div class="ttc" id="agroup__PKCS7_html_ga9c7bedf422dcb3771e2dc225b87d1634"><div class="ttname"><a href="#ga9c7bedf422dcb3771e2dc225b87d1634">wc_PKCS7_EncodeData</a></div><div class="ttdeci">int wc_PKCS7_EncodeData(PKCS7 *pkcs7, byte *output, word32 outputSz)</div><div class="ttdoc">This function builds the PKCS7 data content type, encoding the PKCS7 structure into a buffer containi...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga2ea444dffff344d027f39dec06839ae6" title="This function initializes a PKCS7 structure with a DER-formatted certificate. To initialize an empty ...">wc_PKCS7_InitWithCert</a> </dd></dl>

</div>
</div>
<a id="ga3b5cb91f5b7a54493f356633b4b661bf" name="ga3b5cb91f5b7a54493f356633b4b661bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3b5cb91f5b7a54493f356633b4b661bf">&#9670;&#160;</a></span>wc_PKCS7_EncodeEnvelopedData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_PKCS7_EncodeEnvelopedData </td>
          <td>(</td>
          <td class="paramtype">PKCS7 *</td>          <td class="paramname"><span class="paramname"><em>pkcs7</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>output</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>outputSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function builds the PKCS7 enveloped data content type, encoding the PKCS7 structure into a buffer containing a parsable PKCS7 enveloped data packet. </p>
<dl class="section return"><dt>Returns</dt><dd>Success Returned on successfully encoding the message in enveloped data format, returns the size written to the output buffer </dd>
<dd>
BAD_FUNC_ARG: Returned if one of the input parameters is invalid, or if the PKCS7 structure is missing required elements </dd>
<dd>
ALGO_ID_E Returned if the PKCS7 structure is using an unsupported algorithm type. Currently, only DESb and DES3b are supported </dd>
<dd>
BUFFER_E Returned if the given output buffer is too small to store the output data </dd>
<dd>
MEMORY_E Returned if there is an error allocating memory </dd>
<dd>
RNG_FAILURE_E Returned if there is an error initializing the random number generator for encryption </dd>
<dd>
DRBG_FAILED Returned if there is an error generating numbers with the random number generator used for encryption </dd>
<dd>
NOT_COMPILED_IN may be returned if using an ECC key and wolfssl was built without HAVE_X963_KDF support</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pkcs7</td><td>pointer to the PKCS7 structure to encode </td></tr>
    <tr><td class="paramname">output</td><td>pointer to the buffer in which to store the encoded certificate </td></tr>
    <tr><td class="paramname">outputSz</td><td>size available in the output buffer</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">PKCS7 pkcs7;</div>
<div class="line"><span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">byte</span> derBuff[] = { }; <span class="comment">// initialize with DER-encoded certificate</span></div>
<div class="line"><span class="keywordtype">byte</span> pkcs7Buff[FOURK_BUF];</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ga2ea444dffff344d027f39dec06839ae6">wc_PKCS7_InitWithCert</a>(&amp;pkcs7, derBuff, <span class="keyword">sizeof</span>(derBuff));</div>
<div class="line"><span class="comment">// update message and data to encode</span></div>
<div class="line">pkcs7.privateKey = key;</div>
<div class="line">pkcs7.privateKeySz = keySz;</div>
<div class="line">pkcs7.content = data;</div>
<div class="line">pkcs7.contentSz = dataSz;</div>
<div class="line">... etc.</div>
<div class="line"> </div>
<div class="line">ret = <a class="code hl_function" href="#ga3b5cb91f5b7a54493f356633b4b661bf">wc_PKCS7_EncodeEnvelopedData</a>(&amp;pkcs7, pkcs7Buff, <span class="keyword">sizeof</span>(pkcs7Buff));</div>
<div class="line"><span class="keywordflow">if</span> ( ret &lt; 0 ) {</div>
<div class="line">    <span class="comment">// error encoding into output buffer</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__PKCS7_html_ga3b5cb91f5b7a54493f356633b4b661bf"><div class="ttname"><a href="#ga3b5cb91f5b7a54493f356633b4b661bf">wc_PKCS7_EncodeEnvelopedData</a></div><div class="ttdeci">int wc_PKCS7_EncodeEnvelopedData(PKCS7 *pkcs7, byte *output, word32 outputSz)</div><div class="ttdoc">This function builds the PKCS7 enveloped data content type, encoding the PKCS7 structure into a buffe...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga2ea444dffff344d027f39dec06839ae6" title="This function initializes a PKCS7 structure with a DER-formatted certificate. To initialize an empty ...">wc_PKCS7_InitWithCert</a> </dd>
<dd>
<a class="el" href="#gaa5c5a7881e48eb07028dc58d34e7ca1e" title="This function unwraps and decrypts a PKCS7 enveloped data content type, decoding the message into out...">wc_PKCS7_DecodeEnvelopedData</a> </dd></dl>

</div>
</div>
<a id="ga24a757763a40935b784ebd7c5b8aba9c" name="ga24a757763a40935b784ebd7c5b8aba9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga24a757763a40935b784ebd7c5b8aba9c">&#9670;&#160;</a></span>wc_PKCS7_EncodeSignedData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_PKCS7_EncodeSignedData </td>
          <td>(</td>
          <td class="paramtype">PKCS7 *</td>          <td class="paramname"><span class="paramname"><em>pkcs7</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>output</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>outputSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function builds the PKCS7 signed data content type, encoding the PKCS7 structure into a buffer containing a parsable PKCS7 signed data packet. </p>
<dl class="section return"><dt>Returns</dt><dd>Success On successfully encoding the PKCS7 data into the buffer, returns the index parsed up to in the PKCS7 structure. This index also corresponds to the bytes written to the output buffer. </dd>
<dd>
BAD_FUNC_ARG Returned if the PKCS7 structure is missing one or more required elements to generate a signed data packet </dd>
<dd>
MEMORY_E Returned if there is an error allocating memory </dd>
<dd>
PUBLIC_KEY_E Returned if there is an error parsing the public key </dd>
<dd>
RSA_BUFFER_E Returned if buffer error, output too small or input too large </dd>
<dd>
BUFFER_E Returned if the given buffer is not large enough to hold the encoded certificate </dd>
<dd>
MP_INIT_E may be returned if there is an error generating the signature </dd>
<dd>
MP_READ_E may be returned if there is an error generating the signature </dd>
<dd>
MP_CMP_E may be returned if there is an error generating the signature </dd>
<dd>
MP_INVMOD_E may be returned if there is an error generating the signature </dd>
<dd>
MP_EXPTMOD_E may be returned if there is an error generating the signature </dd>
<dd>
MP_MOD_E may be returned if there is an error generating the signature </dd>
<dd>
MP_MUL_E may be returned if there is an error generating the signature </dd>
<dd>
MP_ADD_E may be returned if there is an error generating the signature </dd>
<dd>
MP_MULMOD_E may be returned if there is an error generating the signature </dd>
<dd>
MP_TO_E may be returned if there is an error generating the signature </dd>
<dd>
MP_MEM may be returned if there is an error generating the signature</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pkcs7</td><td>pointer to the PKCS7 structure to encode </td></tr>
    <tr><td class="paramname">output</td><td>pointer to the buffer in which to store the encoded certificate </td></tr>
    <tr><td class="paramname">outputSz</td><td>size available in the output buffer</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">PKCS7 pkcs7;</div>
<div class="line"><span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">byte</span> data[] = {}; <span class="comment">// initialize with data to sign</span></div>
<div class="line"><span class="keywordtype">byte</span> derBuff[] = { }; <span class="comment">// initialize with DER-encoded certificate</span></div>
<div class="line"><span class="keywordtype">byte</span> pkcs7Buff[FOURK_BUF];</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ga2ea444dffff344d027f39dec06839ae6">wc_PKCS7_InitWithCert</a>(&amp;pkcs7, derBuff, <span class="keyword">sizeof</span>(derBuff));</div>
<div class="line"><span class="comment">// update message and data to encode</span></div>
<div class="line">pkcs7.privateKey = key;</div>
<div class="line">pkcs7.privateKeySz = keySz;</div>
<div class="line">pkcs7.content = data;</div>
<div class="line">pkcs7.contentSz = dataSz;</div>
<div class="line">pkcs7.hashOID = SHAh;</div>
<div class="line">pkcs7.rng = &amp;rng;</div>
<div class="line">... etc.</div>
<div class="line"> </div>
<div class="line">ret = <a class="code hl_function" href="#ga24a757763a40935b784ebd7c5b8aba9c">wc_PKCS7_EncodeSignedData</a>(&amp;pkcs7, pkcs7Buff, <span class="keyword">sizeof</span>(pkcs7Buff));</div>
<div class="line"><span class="keywordflow">if</span> ( ret != 0 ) {</div>
<div class="line">    <span class="comment">// error encoding into output buffer</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ga50ffee7d86334b031b873ca62c73ada0">wc_PKCS7_Free</a>(&amp;pkcs7);</div>
<div class="ttc" id="agroup__PKCS7_html_ga24a757763a40935b784ebd7c5b8aba9c"><div class="ttname"><a href="#ga24a757763a40935b784ebd7c5b8aba9c">wc_PKCS7_EncodeSignedData</a></div><div class="ttdeci">int wc_PKCS7_EncodeSignedData(PKCS7 *pkcs7, byte *output, word32 outputSz)</div><div class="ttdoc">This function builds the PKCS7 signed data content type, encoding the PKCS7 structure into a buffer c...</div></div>
<div class="ttc" id="agroup__PKCS7_html_ga50ffee7d86334b031b873ca62c73ada0"><div class="ttname"><a href="#ga50ffee7d86334b031b873ca62c73ada0">wc_PKCS7_Free</a></div><div class="ttdeci">void wc_PKCS7_Free(PKCS7 *pkcs7)</div><div class="ttdoc">This function releases any memory allocated by a PKCS7 initializer.</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga2ea444dffff344d027f39dec06839ae6" title="This function initializes a PKCS7 structure with a DER-formatted certificate. To initialize an empty ...">wc_PKCS7_InitWithCert</a> </dd>
<dd>
<a class="el" href="#ga6ff4dae009941bd81213605807141571" title="This function takes in a transmitted PKCS7 signed data message, extracts the certificate list and cer...">wc_PKCS7_VerifySignedData</a> </dd></dl>

</div>
</div>
<a id="ga56d58b33ae2a77ebffef788dff227bcd" name="ga56d58b33ae2a77ebffef788dff227bcd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga56d58b33ae2a77ebffef788dff227bcd">&#9670;&#160;</a></span>wc_PKCS7_EncodeSignedData_ex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_PKCS7_EncodeSignedData_ex </td>
          <td>(</td>
          <td class="paramtype">PKCS7 *</td>          <td class="paramname"><span class="paramname"><em>pkcs7</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>hashBuf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>hashSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>outputHead</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32 *</td>          <td class="paramname"><span class="paramname"><em>outputHeadSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>outputFoot</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32 *</td>          <td class="paramname"><span class="paramname"><em>outputFootSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function builds the PKCS7 signed data content type, encoding the PKCS7 structure into a header and footer buffer containing a parsable PKCS7 signed data packet. This does not include the content. A hash must be computed and provided for the data. </p>
<dl class="section return"><dt>Returns</dt><dd>0=Success </dd>
<dd>
BAD_FUNC_ARG Returned if the PKCS7 structure is missing one or more required elements to generate a signed data packet </dd>
<dd>
MEMORY_E Returned if there is an error allocating memory </dd>
<dd>
PUBLIC_KEY_E Returned if there is an error parsing the public key </dd>
<dd>
RSA_BUFFER_E Returned if buffer error, output too small or input too large </dd>
<dd>
BUFFER_E Returned if the given buffer is not large enough to hold the encoded certificate </dd>
<dd>
MP_INIT_E may be returned if there is an error generating the signature </dd>
<dd>
MP_READ_E may be returned if there is an error generating the signature </dd>
<dd>
MP_CMP_E may be returned if there is an error generating the signature </dd>
<dd>
MP_INVMOD_E may be returned if there is an error generating the signature </dd>
<dd>
MP_EXPTMOD_E may be returned if there is an error generating the signature </dd>
<dd>
MP_MOD_E may be returned if there is an error generating the signature </dd>
<dd>
MP_MUL_E may be returned if there is an error generating the signature </dd>
<dd>
MP_ADD_E may be returned if there is an error generating the signature </dd>
<dd>
MP_MULMOD_E may be returned if there is an error generating the signature </dd>
<dd>
MP_TO_E may be returned if there is an error generating the signature </dd>
<dd>
MP_MEM may be returned if there is an error generating the signature</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pkcs7</td><td>pointer to the PKCS7 structure to encode </td></tr>
    <tr><td class="paramname">hashBuf</td><td>pointer to computed hash for the content data </td></tr>
    <tr><td class="paramname">hashSz</td><td>size of the digest </td></tr>
    <tr><td class="paramname">outputHead</td><td>pointer to the buffer in which to store the encoded certificate header </td></tr>
    <tr><td class="paramname">outputHeadSz</td><td>pointer populated with size of output header buffer and returns actual size </td></tr>
    <tr><td class="paramname">outputFoot</td><td>pointer to the buffer in which to store the encoded certificate footer </td></tr>
    <tr><td class="paramname">outputFootSz</td><td>pointer populated with size of output footer buffer and returns actual size</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">PKCS7 pkcs7;</div>
<div class="line"><span class="keywordtype">int</span> ret;</div>
<div class="line"><span class="keywordtype">byte</span> derBuff[] = { }; <span class="comment">// initialize with DER-encoded certificate</span></div>
<div class="line"><span class="keywordtype">byte</span> data[] = {}; <span class="comment">// initialize with data to sign</span></div>
<div class="line"><span class="keywordtype">byte</span> pkcs7HeadBuff[FOURK_BUF/2];</div>
<div class="line"><span class="keywordtype">byte</span> pkcs7FootBuff[FOURK_BUF/2];</div>
<div class="line">word32 pkcs7HeadSz = (word32)<span class="keyword">sizeof</span>(pkcs7HeadBuff);</div>
<div class="line">word32 pkcs7FootSz = (word32)<span class="keyword">sizeof</span>(pkcs7HeadBuff);</div>
<div class="line"><span class="keyword">enum</span> wc_HashType hashType = WC_HASH_TYPE_SHA;</div>
<div class="line"><span class="keywordtype">byte</span>   hashBuf[WC_MAX_DIGEST_SIZE];</div>
<div class="line">word32 hashSz = <a class="code hl_function" href="group__wolfCrypt.html#ga1126e1ba7ad303f3fde1cdea53615752">wc_HashGetDigestSize</a>(hashType);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ga2ea444dffff344d027f39dec06839ae6">wc_PKCS7_InitWithCert</a>(&amp;pkcs7, derBuff, <span class="keyword">sizeof</span>(derBuff));</div>
<div class="line"><span class="comment">// update message and data to encode</span></div>
<div class="line">pkcs7.privateKey = key;</div>
<div class="line">pkcs7.privateKeySz = keySz;</div>
<div class="line">pkcs7.content = NULL;</div>
<div class="line">pkcs7.contentSz = dataSz;</div>
<div class="line">pkcs7.hashOID = SHAh;</div>
<div class="line">pkcs7.rng = &amp;rng;</div>
<div class="line">... etc.</div>
<div class="line"> </div>
<div class="line"><span class="comment">// calculate hash for content</span></div>
<div class="line">ret = wc_HashInit(&amp;hash, hashType);</div>
<div class="line"><span class="keywordflow">if</span> (ret == 0) {</div>
<div class="line">    ret = wc_HashUpdate(&amp;hash, hashType, data, <span class="keyword">sizeof</span>(data));</div>
<div class="line">    <span class="keywordflow">if</span> (ret == 0) {</div>
<div class="line">        ret = wc_HashFinal(&amp;hash, hashType, hashBuf);</div>
<div class="line">    }</div>
<div class="line">    wc_HashFree(&amp;hash, hashType);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">ret = <a class="code hl_function" href="#ga56d58b33ae2a77ebffef788dff227bcd">wc_PKCS7_EncodeSignedData_ex</a>(&amp;pkcs7, hashBuf, hashSz, pkcs7HeadBuff,</div>
<div class="line">    &amp;pkcs7HeadSz, pkcs7FootBuff, &amp;pkcs7FootSz);</div>
<div class="line"><span class="keywordflow">if</span> ( ret != 0 ) {</div>
<div class="line">    <span class="comment">// error encoding into output buffer</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ga50ffee7d86334b031b873ca62c73ada0">wc_PKCS7_Free</a>(&amp;pkcs7);</div>
<div class="ttc" id="agroup__PKCS7_html_ga56d58b33ae2a77ebffef788dff227bcd"><div class="ttname"><a href="#ga56d58b33ae2a77ebffef788dff227bcd">wc_PKCS7_EncodeSignedData_ex</a></div><div class="ttdeci">int wc_PKCS7_EncodeSignedData_ex(PKCS7 *pkcs7, const byte *hashBuf, word32 hashSz, byte *outputHead, word32 *outputHeadSz, byte *outputFoot, word32 *outputFootSz)</div><div class="ttdoc">This function builds the PKCS7 signed data content type, encoding the PKCS7 structure into a header a...</div></div>
<div class="ttc" id="agroup__wolfCrypt_html_ga1126e1ba7ad303f3fde1cdea53615752"><div class="ttname"><a href="group__wolfCrypt.html#ga1126e1ba7ad303f3fde1cdea53615752">wc_HashGetDigestSize</a></div><div class="ttdeci">int wc_HashGetDigestSize(enum wc_HashType hash_type)</div><div class="ttdoc">This function returns the size of the digest (output) for a hash_type. The returns size is used to ma...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga2ea444dffff344d027f39dec06839ae6" title="This function initializes a PKCS7 structure with a DER-formatted certificate. To initialize an empty ...">wc_PKCS7_InitWithCert</a> </dd>
<dd>
<a class="el" href="#gadfa60d99d79a88d232623682f8201d3a" title="This function takes in a transmitted PKCS7 signed data message as hash/header/footer,...">wc_PKCS7_VerifySignedData_ex</a> </dd></dl>

</div>
</div>
<a id="ga50ffee7d86334b031b873ca62c73ada0" name="ga50ffee7d86334b031b873ca62c73ada0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga50ffee7d86334b031b873ca62c73ada0">&#9670;&#160;</a></span>wc_PKCS7_Free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wc_PKCS7_Free </td>
          <td>(</td>
          <td class="paramtype">PKCS7 *</td>          <td class="paramname"><span class="paramname"><em>pkcs7</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function releases any memory allocated by a PKCS7 initializer. </p>
<dl class="section return"><dt>Returns</dt><dd>none No returns.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pkcs7</td><td>pointer to the PKCS7 structure to free</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">PKCS7 pkcs7;</div>
<div class="line"><span class="comment">// initialize and use PKCS7 object</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ga50ffee7d86334b031b873ca62c73ada0">wc_PKCS7_Free</a>(pkcs7);</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga2ea444dffff344d027f39dec06839ae6" title="This function initializes a PKCS7 structure with a DER-formatted certificate. To initialize an empty ...">wc_PKCS7_InitWithCert</a> </dd></dl>

</div>
</div>
<a id="gaaa38a871f6ff3a6965a1fbbdefebcc91" name="gaaa38a871f6ff3a6965a1fbbdefebcc91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaa38a871f6ff3a6965a1fbbdefebcc91">&#9670;&#160;</a></span>wc_PKCS7_GetEnvelopedDataKariRid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_PKCS7_GetEnvelopedDataKariRid </td>
          <td>(</td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>inSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32 *</td>          <td class="paramname"><span class="paramname"><em>outSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function extracts the KeyAgreeRecipientIdentifier object from an EnvelopedData package containing a KeyAgreeRecipientInfo RecipientInfo object. Only the first KeyAgreeRecipientIdentifer found in the first RecipientInfo is copied. This function does not support multiple RecipientInfo objects or multiple RecipientEncryptedKey objects within an KeyAgreeRecipientInfo. </p>
<dl class="section return"><dt>Returns</dt><dd>Returns 0 on success. </dd>
<dd>
BAD_FUNC_ARG Returned if one of the input parameters is invalid. </dd>
<dd>
ASN_PARSE_E Returned if there is an error parsing the input message. </dd>
<dd>
PKCS7_OID_E Returned if the input message is not an enveloped data type. </dd>
<dd>
BUFFER_E Returned if there is not enough room in the output buffer.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">in</td><td>Input buffer containing the EnvelopedData ContentInfo message. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inSz</td><td>Size of the input buffer. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>Output buffer. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">outSz</td><td>Output buffer size on input, Size written on output. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga2ea444dffff344d027f39dec06839ae6" name="ga2ea444dffff344d027f39dec06839ae6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2ea444dffff344d027f39dec06839ae6">&#9670;&#160;</a></span>wc_PKCS7_InitWithCert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_PKCS7_InitWithCert </td>
          <td>(</td>
          <td class="paramtype">PKCS7 *</td>          <td class="paramname"><span class="paramname"><em>pkcs7</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>cert</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>certSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function initializes a PKCS7 structure with a DER-formatted certificate. To initialize an empty PKCS7 structure, one can pass in a NULL cert and 0 for certSz. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Returned on successfully initializing the PKCS7 structure </dd>
<dd>
MEMORY_E Returned if there is an error allocating memory with XMALLOC </dd>
<dd>
ASN_PARSE_E Returned if there is an error parsing the cert header </dd>
<dd>
ASN_OBJECT_ID_E Returned if there is an error parsing the encryption type from the cert </dd>
<dd>
ASN_EXPECT_0_E Returned if there is a formatting error in the encryption specification of the cert file </dd>
<dd>
ASN_BEFORE_DATE_E Returned if the date is before the certificate start date </dd>
<dd>
ASN_AFTER_DATE_E Returned if the date is after the certificate expiration date </dd>
<dd>
ASN_BITSTR_E Returned if there is an error parsing a bit string from the certificate </dd>
<dd>
ECC_CURVE_OID_E Returned if there is an error parsing the ECC key from the certificate </dd>
<dd>
ASN_UNKNOWN_OID_E Returned if the certificate is using an unknown key object id </dd>
<dd>
ASN_VERSION_E Returned if the ALLOW_V1_EXTENSIONS option is not defined and the certificate is a V1 or V2 certificate </dd>
<dd>
BAD_FUNC_ARG Returned if there is an error processing the certificate extension </dd>
<dd>
ASN_CRIT_EXT_E Returned if an unfamiliar critical extension is encountered in processing the certificate </dd>
<dd>
ASN_SIG_OID_E Returned if the signature encryption type is not the same as the encryption type of the certificate in the provided file </dd>
<dd>
ASN_SIG_CONFIRM_E Returned if confirming the certification signature fails </dd>
<dd>
ASN_NAME_INVALID_E Returned if the certificate’s name is not permitted by the CA name constraints </dd>
<dd>
ASN_NO_SIGNER_E Returned if there is no CA signer to verify the certificate’s authenticity</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pkcs7</td><td>pointer to the PKCS7 structure in which to store the decoded cert </td></tr>
    <tr><td class="paramname">cert</td><td>pointer to a buffer containing a DER formatted ASN.1 certificate with which to initialize the PKCS7 structure </td></tr>
    <tr><td class="paramname">certSz</td><td>size of the certificate buffer</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">PKCS7 pkcs7;</div>
<div class="line"><span class="keywordtype">byte</span> derBuff[] = { }; <span class="comment">// initialize with DER-encoded certificate</span></div>
<div class="line"><span class="keywordflow">if</span> ( <a class="code hl_function" href="#ga2ea444dffff344d027f39dec06839ae6">wc_PKCS7_InitWithCert</a>(&amp;pkcs7, derBuff, <span class="keyword">sizeof</span>(derBuff)) != 0 ) {</div>
<div class="line">    <span class="comment">// error parsing certificate into pkcs7 format</span></div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga50ffee7d86334b031b873ca62c73ada0" title="This function releases any memory allocated by a PKCS7 initializer.">wc_PKCS7_Free</a> </dd></dl>

</div>
</div>
<a id="gaee101fc35740060a0a0469ed6c2cf175" name="gaee101fc35740060a0a0469ed6c2cf175"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaee101fc35740060a0a0469ed6c2cf175">&#9670;&#160;</a></span>wc_PKCS7_SetAESKeyWrapUnwrapCb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_PKCS7_SetAESKeyWrapUnwrapCb </td>
          <td>(</td>
          <td class="paramtype">wc_PKCS7 *</td>          <td class="paramname"><span class="paramname"><em>pkcs7</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#ga7908ba7d7370c41fddb4d6220c248ffa">CallbackAESKeyWrapUnwrap</a></td>          <td class="paramname"><span class="paramname"><em>aesKeyWrapCb</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the callback function to be used to perform a custom AES key wrap/unwrap operation. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Callback function was set successfully </td></tr>
    <tr><td class="paramname">BAD_FUNC_ARG</td><td>Parameter pkcs7 is NULL</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pkcs7</td><td>pointer to the PKCS7 structure </td></tr>
    <tr><td class="paramname">aesKeyWrapCb</td><td>pointer to custom AES key wrap/unwrap function </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga6ff4dae009941bd81213605807141571" name="ga6ff4dae009941bd81213605807141571"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6ff4dae009941bd81213605807141571">&#9670;&#160;</a></span>wc_PKCS7_VerifySignedData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_PKCS7_VerifySignedData </td>
          <td>(</td>
          <td class="paramtype">PKCS7 *</td>          <td class="paramname"><span class="paramname"><em>pkcs7</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>pkiMsg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>pkiMsgSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes in a transmitted PKCS7 signed data message, extracts the certificate list and certificate revocation list, and then verifies the signature. It stores the extracted content in the given PKCS7 structure. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Returned on successfully extracting the information from the message </dd>
<dd>
BAD_FUNC_ARG Returned if one of the input parameters is invalid </dd>
<dd>
ASN_PARSE_E Returned if there is an error parsing the given pkiMsg </dd>
<dd>
PKCS7_OID_E Returned if the given pkiMsg is not a signed data type </dd>
<dd>
ASN_VERSION_E Returned if the PKCS7 signer info is not version 1 </dd>
<dd>
MEMORY_E Returned if there is an error allocating memory </dd>
<dd>
PUBLIC_KEY_E Returned if there is an error parsing the public key </dd>
<dd>
RSA_BUFFER_E Returned if buffer error, output too small or input too large </dd>
<dd>
BUFFER_E Returned if the given buffer is not large enough to hold the encoded certificate </dd>
<dd>
MP_INIT_E may be returned if there is an error generating the signature </dd>
<dd>
MP_READ_E may be returned if there is an error generating the signature </dd>
<dd>
MP_CMP_E may be returned if there is an error generating the signature </dd>
<dd>
MP_INVMOD_E may be returned if there is an error generating the signature </dd>
<dd>
MP_EXPTMOD_E may be returned if there is an error generating the signature </dd>
<dd>
MP_MOD_E may be returned if there is an error generating the signature </dd>
<dd>
MP_MUL_E may be returned if there is an error generating the signature </dd>
<dd>
MP_ADD_E may be returned if there is an error generating the signature </dd>
<dd>
MP_MULMOD_E may be returned if there is an error generating the signature </dd>
<dd>
MP_TO_E may be returned if there is an error generating the signature </dd>
<dd>
MP_MEM may be returned if there is an error generating the signature</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pkcs7</td><td>pointer to the PKCS7 structure in which to store the parsed certificates </td></tr>
    <tr><td class="paramname">pkiMsg</td><td>pointer to the buffer containing the signed message to verify and decode </td></tr>
    <tr><td class="paramname">pkiMsgSz</td><td>size of the signed message</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">PKCS7 pkcs7;</div>
<div class="line"><span class="keywordtype">int</span> ret;</div>
<div class="line"><span class="keywordtype">byte</span> pkcs7Buff[] = {}; <span class="comment">// the PKCS7 signature</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ga2ea444dffff344d027f39dec06839ae6">wc_PKCS7_InitWithCert</a>(&amp;pkcs7, NULL, 0);</div>
<div class="line"><span class="comment">// update message and data to encode</span></div>
<div class="line">pkcs7.privateKey = key;</div>
<div class="line">pkcs7.privateKeySz = keySz;</div>
<div class="line">pkcs7.content = data;</div>
<div class="line">pkcs7.contentSz = dataSz;</div>
<div class="line">... etc.</div>
<div class="line"> </div>
<div class="line">ret = <a class="code hl_function" href="#ga6ff4dae009941bd81213605807141571">wc_PKCS7_VerifySignedData</a>(&amp;pkcs7, pkcs7Buff, <span class="keyword">sizeof</span>(pkcs7Buff));</div>
<div class="line"><span class="keywordflow">if</span> ( ret != 0 ) {</div>
<div class="line">    <span class="comment">// error encoding into output buffer</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ga50ffee7d86334b031b873ca62c73ada0">wc_PKCS7_Free</a>(&amp;pkcs7);</div>
<div class="ttc" id="agroup__PKCS7_html_ga6ff4dae009941bd81213605807141571"><div class="ttname"><a href="#ga6ff4dae009941bd81213605807141571">wc_PKCS7_VerifySignedData</a></div><div class="ttdeci">int wc_PKCS7_VerifySignedData(PKCS7 *pkcs7, byte *pkiMsg, word32 pkiMsgSz)</div><div class="ttdoc">This function takes in a transmitted PKCS7 signed data message, extracts the certificate list and cer...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga2ea444dffff344d027f39dec06839ae6" title="This function initializes a PKCS7 structure with a DER-formatted certificate. To initialize an empty ...">wc_PKCS7_InitWithCert</a> </dd>
<dd>
<a class="el" href="#ga24a757763a40935b784ebd7c5b8aba9c" title="This function builds the PKCS7 signed data content type, encoding the PKCS7 structure into a buffer c...">wc_PKCS7_EncodeSignedData</a> </dd></dl>

</div>
</div>
<a id="gadfa60d99d79a88d232623682f8201d3a" name="gadfa60d99d79a88d232623682f8201d3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadfa60d99d79a88d232623682f8201d3a">&#9670;&#160;</a></span>wc_PKCS7_VerifySignedData_ex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_PKCS7_VerifySignedData_ex </td>
          <td>(</td>
          <td class="paramtype">PKCS7 *</td>          <td class="paramname"><span class="paramname"><em>pkcs7</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>hashBuf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>hashSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>pkiMsgHead</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>pkiMsgHeadSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>pkiMsgFoot</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>pkiMsgFootSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes in a transmitted PKCS7 signed data message as hash/header/footer, then extracts the certificate list and certificate revocation list, and then verifies the signature. It stores the extracted content in the given PKCS7 structure. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Returned on successfully extracting the information from the message </dd>
<dd>
BAD_FUNC_ARG Returned if one of the input parameters is invalid </dd>
<dd>
ASN_PARSE_E Returned if there is an error parsing the given pkiMsg </dd>
<dd>
PKCS7_OID_E Returned if the given pkiMsg is not a signed data type </dd>
<dd>
ASN_VERSION_E Returned if the PKCS7 signer info is not version 1 </dd>
<dd>
MEMORY_E Returned if there is an error allocating memory </dd>
<dd>
PUBLIC_KEY_E Returned if there is an error parsing the public key </dd>
<dd>
RSA_BUFFER_E Returned if buffer error, output too small or input too large </dd>
<dd>
BUFFER_E Returned if the given buffer is not large enough to hold the encoded certificate </dd>
<dd>
MP_INIT_E may be returned if there is an error generating the signature </dd>
<dd>
MP_READ_E may be returned if there is an error generating the signature </dd>
<dd>
MP_CMP_E may be returned if there is an error generating the signature </dd>
<dd>
MP_INVMOD_E may be returned if there is an error generating the signature </dd>
<dd>
MP_EXPTMOD_E may be returned if there is an error generating the signature </dd>
<dd>
MP_MOD_E may be returned if there is an error generating the signature </dd>
<dd>
MP_MUL_E may be returned if there is an error generating the signature </dd>
<dd>
MP_ADD_E may be returned if there is an error generating the signature </dd>
<dd>
MP_MULMOD_E may be returned if there is an error generating the signature </dd>
<dd>
MP_TO_E may be returned if there is an error generating the signature </dd>
<dd>
MP_MEM may be returned if there is an error generating the signature</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pkcs7</td><td>pointer to the PKCS7 structure in which to store the parsed certificates </td></tr>
    <tr><td class="paramname">hashBuf</td><td>pointer to computed hash for the content data </td></tr>
    <tr><td class="paramname">hashSz</td><td>size of the digest </td></tr>
    <tr><td class="paramname">pkiMsgHead</td><td>pointer to the buffer containing the signed message header to verify and decode </td></tr>
    <tr><td class="paramname">pkiMsgHeadSz</td><td>size of the signed message header </td></tr>
    <tr><td class="paramname">pkiMsgFoot</td><td>pointer to the buffer containing the signed message footer to verify and decode </td></tr>
    <tr><td class="paramname">pkiMsgFootSz</td><td>size of the signed message footer</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">PKCS7 pkcs7;</div>
<div class="line"><span class="keywordtype">int</span> ret;</div>
<div class="line"><span class="keywordtype">byte</span> data[] = {}; <span class="comment">// initialize with data to sign</span></div>
<div class="line"><span class="keywordtype">byte</span> pkcs7HeadBuff[] = {}; <span class="comment">// initialize with PKCS7 header</span></div>
<div class="line"><span class="keywordtype">byte</span> pkcs7FootBuff[] = {}; <span class="comment">// initialize with PKCS7 footer</span></div>
<div class="line"><span class="keyword">enum</span> wc_HashType hashType = WC_HASH_TYPE_SHA;</div>
<div class="line"><span class="keywordtype">byte</span>   hashBuf[WC_MAX_DIGEST_SIZE];</div>
<div class="line">word32 hashSz = <a class="code hl_function" href="group__wolfCrypt.html#ga1126e1ba7ad303f3fde1cdea53615752">wc_HashGetDigestSize</a>(hashType);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ga2ea444dffff344d027f39dec06839ae6">wc_PKCS7_InitWithCert</a>(&amp;pkcs7, NULL, 0);</div>
<div class="line"><span class="comment">// update message and data to encode</span></div>
<div class="line">pkcs7.privateKey = key;</div>
<div class="line">pkcs7.privateKeySz = keySz;</div>
<div class="line">pkcs7.content = NULL;</div>
<div class="line">pkcs7.contentSz = dataSz;</div>
<div class="line">pkcs7.rng = &amp;rng;</div>
<div class="line">... etc.</div>
<div class="line"> </div>
<div class="line"><span class="comment">// calculate hash for content</span></div>
<div class="line">ret = wc_HashInit(&amp;hash, hashType);</div>
<div class="line"><span class="keywordflow">if</span> (ret == 0) {</div>
<div class="line">    ret = wc_HashUpdate(&amp;hash, hashType, data, <span class="keyword">sizeof</span>(data));</div>
<div class="line">    <span class="keywordflow">if</span> (ret == 0) {</div>
<div class="line">        ret = wc_HashFinal(&amp;hash, hashType, hashBuf);</div>
<div class="line">    }</div>
<div class="line">    wc_HashFree(&amp;hash, hashType);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">ret = <a class="code hl_function" href="#gadfa60d99d79a88d232623682f8201d3a">wc_PKCS7_VerifySignedData_ex</a>(&amp;pkcs7, hashBuf, hashSz, pkcs7HeadBuff,</div>
<div class="line">    <span class="keyword">sizeof</span>(pkcs7HeadBuff), pkcs7FootBuff, <span class="keyword">sizeof</span>(pkcs7FootBuff));</div>
<div class="line"><span class="keywordflow">if</span> ( ret != 0 ) {</div>
<div class="line">    <span class="comment">// error encoding into output buffer</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ga50ffee7d86334b031b873ca62c73ada0">wc_PKCS7_Free</a>(&amp;pkcs7);</div>
<div class="ttc" id="agroup__PKCS7_html_gadfa60d99d79a88d232623682f8201d3a"><div class="ttname"><a href="#gadfa60d99d79a88d232623682f8201d3a">wc_PKCS7_VerifySignedData_ex</a></div><div class="ttdeci">int wc_PKCS7_VerifySignedData_ex(PKCS7 *pkcs7, const byte *hashBuf, word32 hashSz, byte *pkiMsgHead, word32 pkiMsgHeadSz, byte *pkiMsgFoot, word32 pkiMsgFootSz)</div><div class="ttdoc">This function takes in a transmitted PKCS7 signed data message as hash/header/footer,...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga2ea444dffff344d027f39dec06839ae6" title="This function initializes a PKCS7 structure with a DER-formatted certificate. To initialize an empty ...">wc_PKCS7_InitWithCert</a> </dd>
<dd>
<a class="el" href="#ga56d58b33ae2a77ebffef788dff227bcd" title="This function builds the PKCS7 signed data content type, encoding the PKCS7 structure into a header a...">wc_PKCS7_EncodeSignedData_ex</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
