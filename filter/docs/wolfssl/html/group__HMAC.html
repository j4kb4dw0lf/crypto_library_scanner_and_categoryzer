<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>My Project: Algorithms - HMAC</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="wolfssl_logo" style="width: 150px; height: 100px; display: inline-block;"><img alt="Logo" src="../images/wolfssl_logo.png" style="width: 150px; height: 100px;"/></div>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Algorithms - HMAC </div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaa1ed3269712d18437a618acb7a278dae" id="r_gaa1ed3269712d18437a618acb7a278dae"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa1ed3269712d18437a618acb7a278dae">wc_HmacSetKey</a> (Hmac *hmac, int type, const byte *key, word32 keySz)</td></tr>
<tr class="memdesc:gaa1ed3269712d18437a618acb7a278dae"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function initializes an Hmac object, setting its encryption type, key and HMAC length.  <br /></td></tr>
<tr class="memitem:ga4533277215772c6cea848d2ad072823c" id="r_ga4533277215772c6cea848d2ad072823c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga4533277215772c6cea848d2ad072823c">wc_HmacUpdate</a> (Hmac *hmac, const byte *in, word32 sz)</td></tr>
<tr class="memdesc:ga4533277215772c6cea848d2ad072823c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function updates the message to authenticate using HMAC. It should be called after the Hmac object has been initialized with wc_HmacSetKey. This function may be called multiple times to update the message to hash. After calling wc_HmacUpdate as desired, one should call wc_HmacFinal to obtain the final authenticated message tag.  <br /></td></tr>
<tr class="memitem:ga3c163b9dcb460081fd8c5d0885b21f7b" id="r_ga3c163b9dcb460081fd8c5d0885b21f7b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga3c163b9dcb460081fd8c5d0885b21f7b">wc_HmacFinal</a> (Hmac *hmac, byte *out)</td></tr>
<tr class="memdesc:ga3c163b9dcb460081fd8c5d0885b21f7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the final hash of an Hmac object's message.  <br /></td></tr>
<tr class="memitem:ga1a51bb4d737f62b8362a09bf92b330ed" id="r_ga1a51bb4d737f62b8362a09bf92b330ed"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga1a51bb4d737f62b8362a09bf92b330ed">wolfSSL_GetHmacMaxSize</a> (void)</td></tr>
<tr class="memdesc:ga1a51bb4d737f62b8362a09bf92b330ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the largest HMAC digest size available based on the configured cipher suites.  <br /></td></tr>
<tr class="memitem:gaaec145333b157e9cb6962ef324fd61ec" id="r_gaaec145333b157e9cb6962ef324fd61ec"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaaec145333b157e9cb6962ef324fd61ec">wc_HKDF</a> (int type, const byte *inKey, word32 inKeySz, const byte *salt, word32 saltSz, const byte *info, word32 infoSz, byte *out, word32 outSz)</td></tr>
<tr class="memdesc:gaaec145333b157e9cb6962ef324fd61ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert inKey, with an optional salt and optional info into a derived key, which it stores in out. The hash type defaults to MD5 if 0 or NULL is given.  <br /></td></tr>
<tr class="memitem:gaad84e6af901427d1af6c1878825e0dd7" id="r_gaad84e6af901427d1af6c1878825e0dd7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaad84e6af901427d1af6c1878825e0dd7">wc_HKDF_Extract</a> (int type, const byte *salt, word32 saltSz, const byte *inKey, word32 inKeySz, byte *out)</td></tr>
<tr class="memdesc:gaad84e6af901427d1af6c1878825e0dd7"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert inKey, with an optional salt into a derived key, which it stores in out. The hash type defaults to MD5 if 0 or NULL is given.  <br /></td></tr>
<tr class="memitem:gaaa3c1cff5e67d06e21fd3cd8c7b37bae" id="r_gaaa3c1cff5e67d06e21fd3cd8c7b37bae"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaaa3c1cff5e67d06e21fd3cd8c7b37bae">wc_HKDF_Extract_ex</a> (int type, const byte *salt, word32 saltSz, const byte *inKey, word32 inKeySz, byte *out, void *heap, int devId)</td></tr>
<tr class="memdesc:gaaa3c1cff5e67d06e21fd3cd8c7b37bae"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert inKey, with an optional salt into a derived key, which it stores in out. The hash type defaults to MD5 if 0 or NULL is given. This is the _ex version adding heap hint and device identifier.  <br /></td></tr>
<tr class="memitem:ga40742d591ae19f2d8f29b3fb2c34d264" id="r_ga40742d591ae19f2d8f29b3fb2c34d264"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga40742d591ae19f2d8f29b3fb2c34d264">wc_HKDF_Expand</a> (int type, const byte *inKey, word32 inKeySz, const byte *info, word32 infoSz, byte *out, word32 outSz)</td></tr>
<tr class="memdesc:ga40742d591ae19f2d8f29b3fb2c34d264"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert inKey, with optional info into a derived key, which it stores in out. The hash type defaults to MD5 if 0 or NULL is given.  <br /></td></tr>
<tr class="memitem:ga35854d88a7e502ead605d721f0315225" id="r_ga35854d88a7e502ead605d721f0315225"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga35854d88a7e502ead605d721f0315225">wc_HKDF_Expand_ex</a> (int type, const byte *inKey, word32 inKeySz, const byte *info, word32 infoSz, byte *out, word32 outSz, void *heap, int devId)</td></tr>
<tr class="memdesc:ga35854d88a7e502ead605d721f0315225"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert inKey, with optional info into a derived key, which it stores in out. The hash type defaults to MD5 if 0 or NULL is given. This is the _ex version adding heap hint and device identifier.  <br /></td></tr>
<tr class="memitem:ga1c545644da050a4f481272d1fdfb41bf" id="r_ga1c545644da050a4f481272d1fdfb41bf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga1c545644da050a4f481272d1fdfb41bf">wc_Tls13_HKDF_Extract</a> (byte *prk, const byte *salt, word32 saltLen, byte *ikm, word32 ikmLen, int digest)</td></tr>
<tr class="memdesc:ga1c545644da050a4f481272d1fdfb41bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function provides access to RFC 5869 HMAC-based Extract-and-Expand Key Derivation Function (HKDF) for TLS v1.3 key derivation.  <br /></td></tr>
<tr class="memitem:gad254b375d35e368ee47b445c35d57abd" id="r_gad254b375d35e368ee47b445c35d57abd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gad254b375d35e368ee47b445c35d57abd">wc_Tls13_HKDF_Extract_ex</a> (byte *prk, const byte *salt, word32 saltLen, byte *ikm, word32 ikmLen, int digest, void *heap, int devId)</td></tr>
<tr class="memdesc:gad254b375d35e368ee47b445c35d57abd"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function provides access to RFC 5869 HMAC-based Extract-and-Expand Key Derivation Function (HKDF) for TLS v1.3 key derivation. This is the _ex version adding heap hint and device identifier.  <br /></td></tr>
<tr class="memitem:gabd086dd27bb1f55546a1681861b8fd89" id="r_gabd086dd27bb1f55546a1681861b8fd89"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gabd086dd27bb1f55546a1681861b8fd89">wc_Tls13_HKDF_Expand_Label_ex</a> (byte *okm, word32 okmLen, const byte *prk, word32 prkLen, const byte *protocol, word32 protocolLen, const byte *label, word32 labelLen, const byte *info, word32 infoLen, int digest, void *heap, int devId)</td></tr>
<tr class="memdesc:gabd086dd27bb1f55546a1681861b8fd89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Expand data using HMAC, salt and label and info. TLS v1.3 defines this function for key derivation. This is the _ex version adding heap hint and device identifier.  <br /></td></tr>
<tr class="memitem:gab6d3b312369cd5e12e5e7cc7a4aa9400" id="r_gab6d3b312369cd5e12e5e7cc7a4aa9400"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gab6d3b312369cd5e12e5e7cc7a4aa9400">wc_Tls13_HKDF_Expand_Label</a> (byte *okm, word32 okmLen, const byte *prk, word32 prkLen, const byte *protocol, word32 protocolLen, const byte *label, word32 labelLen, const byte *info, word32 infoLen, int digest)</td></tr>
<tr class="memdesc:gab6d3b312369cd5e12e5e7cc7a4aa9400"><td class="mdescLeft">&#160;</td><td class="mdescRight">Expand data using HMAC, salt and label and info. TLS v1.3 defines this function for key derivation. This is the _ex version adding heap hint and device identifier.  <br /></td></tr>
<tr class="memitem:ga6eb3e9c7073bbe2b2d6a2c2a03c3c8a4" id="r_ga6eb3e9c7073bbe2b2d6a2c2a03c3c8a4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga6eb3e9c7073bbe2b2d6a2c2a03c3c8a4">wc_Tls13_HKDF_Expand_Label_Alloc</a> (byte *okm, word32 okmLen, const byte *prk, word32 prkLen, const byte *protocol, word32 protocolLen, const byte *label, word32 labelLen, const byte *info, word32 infoLen, int digest, void *heap)</td></tr>
<tr class="memdesc:ga6eb3e9c7073bbe2b2d6a2c2a03c3c8a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This functions is very similar to <a class="el" href="#gab6d3b312369cd5e12e5e7cc7a4aa9400" title="Expand data using HMAC, salt and label and info. TLS v1.3 defines this function for key derivation....">wc_Tls13_HKDF_Expand_Label()</a>, but it allocates memory if the stack space usually used isn't enough. Expand data using HMAC, salt and label and info. TLS v1.3 defines this function for key derivation. This is the _ex version adding heap hint and device identifier.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="gaaec145333b157e9cb6962ef324fd61ec" name="gaaec145333b157e9cb6962ef324fd61ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaec145333b157e9cb6962ef324fd61ec">&#9670;&#160;</a></span>wc_HKDF()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_HKDF </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>inKey</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>inKeySz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>salt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>saltSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>info</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>infoSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>outSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert inKey, with an optional salt and optional info into a derived key, which it stores in out. The hash type defaults to MD5 if 0 or NULL is given. </p>
<p>The HMAC configure option is &ndash;enable-hmac (on by default) or if building sources directly HAVE_HKDF</p>
<dl class="section return"><dt>Returns</dt><dd>0 Returned upon successfully generating a key with the given inputs </dd>
<dd>
BAD_FUNC_ARG Returned if an invalid hash type is given (see type param) </dd>
<dd>
MEMORY_E Returned if there is an error allocating memory </dd>
<dd>
HMAC_MIN_KEYLEN_E May be returned when using a FIPS implementation and the key length specified is shorter than the minimum acceptable FIPS standard</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>hash type to use for the HKDF. Valid types are: WC_MD5, WC_SHA, WC_SHA256, WC_SHA384, WC_SHA512, WC_SHA3_224, WC_SHA3_256, WC_SHA3_384 or WC_SHA3_512 </td></tr>
    <tr><td class="paramname">inKey</td><td>pointer to the buffer containing the key to use for KDF </td></tr>
    <tr><td class="paramname">inKeySz</td><td>length of the input key </td></tr>
    <tr><td class="paramname">salt</td><td>pointer to a buffer containing an optional salt. Use NULL instead if not using a salt </td></tr>
    <tr><td class="paramname">saltSz</td><td>length of the salt. Use 0 if not using a salt </td></tr>
    <tr><td class="paramname">info</td><td>pointer to a buffer containing optional additional info. Use NULL if not appending extra info </td></tr>
    <tr><td class="paramname">infoSz</td><td>length of additional info. Use 0 if not using additional info </td></tr>
    <tr><td class="paramname">out</td><td>pointer to the buffer in which to store the derived key </td></tr>
    <tr><td class="paramname">outSz</td><td>space available in the output buffer to store the generated key</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="keywordtype">byte</span> key[] = { <span class="comment">// initialize with key };</span></div>
<div class="line"><span class="keywordtype">byte</span> salt[] = { <span class="comment">// initialize with salt };</span></div>
<div class="line"><span class="keywordtype">byte</span> derivedKey[MAX_DIGEST_SIZE];</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> ret = <a class="code hl_function" href="#gaaec145333b157e9cb6962ef324fd61ec">wc_HKDF</a>(WC_SHA512, key, <span class="keyword">sizeof</span>(key), salt, <span class="keyword">sizeof</span>(salt),</div>
<div class="line">NULL, 0, derivedKey, <span class="keyword">sizeof</span>(derivedKey));</div>
<div class="line"><span class="keywordflow">if</span> ( ret != 0 ) {</div>
<div class="line">    <span class="comment">// error generating derived key</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__HMAC_html_gaaec145333b157e9cb6962ef324fd61ec"><div class="ttname"><a href="#gaaec145333b157e9cb6962ef324fd61ec">wc_HKDF</a></div><div class="ttdeci">int wc_HKDF(int type, const byte *inKey, word32 inKeySz, const byte *salt, word32 saltSz, const byte *info, word32 infoSz, byte *out, word32 outSz)</div><div class="ttdoc">This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaa1ed3269712d18437a618acb7a278dae" title="This function initializes an Hmac object, setting its encryption type, key and HMAC length.">wc_HmacSetKey</a> </dd></dl>

</div>
</div>
<a id="ga40742d591ae19f2d8f29b3fb2c34d264" name="ga40742d591ae19f2d8f29b3fb2c34d264"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga40742d591ae19f2d8f29b3fb2c34d264">&#9670;&#160;</a></span>wc_HKDF_Expand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_HKDF_Expand </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>inKey</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>inKeySz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>info</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>infoSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>outSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert inKey, with optional info into a derived key, which it stores in out. The hash type defaults to MD5 if 0 or NULL is given. </p>
<p>The HMAC configure option is &ndash;enable-hmac (on by default) or if building sources directly HAVE_HKDF</p>
<dl class="section return"><dt>Returns</dt><dd>0 Returned upon successfully generating a key with the given inputs </dd>
<dd>
BAD_FUNC_ARG Returned if an invalid hash type is given (see type param) </dd>
<dd>
MEMORY_E Returned if there is an error allocating memory </dd>
<dd>
HMAC_MIN_KEYLEN_E May be returned when using a FIPS implementation and the key length specified is shorter than the minimum acceptable FIPS standard</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>hash type to use for the HKDF. Valid types are: WC_MD5, WC_SHA, WC_SHA256, WC_SHA384, WC_SHA512, WC_SHA3_224, WC_SHA3_256, WC_SHA3_384 or WC_SHA3_512 </td></tr>
    <tr><td class="paramname">inKey</td><td>pointer to the buffer containing the key to use for KDF </td></tr>
    <tr><td class="paramname">inKeySz</td><td>length of the input key </td></tr>
    <tr><td class="paramname">info</td><td>pointer to a buffer containing optional additional info. Use NULL if not appending extra info </td></tr>
    <tr><td class="paramname">infoSz</td><td>length of additional info. Use 0 if not using additional info </td></tr>
    <tr><td class="paramname">out</td><td>pointer to the buffer in which to store the derived key </td></tr>
    <tr><td class="paramname">outSz</td><td>space available in the output buffer to store the generated key</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="keywordtype">byte</span> key[] = { <span class="comment">// initialize with key };</span></div>
<div class="line"><span class="keywordtype">byte</span> salt[] = { <span class="comment">// initialize with salt };</span></div>
<div class="line"><span class="keywordtype">byte</span> derivedKey[MAX_DIGEST_SIZE];</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> ret = <a class="code hl_function" href="#ga40742d591ae19f2d8f29b3fb2c34d264">wc_HKDF_Expand</a>(WC_SHA512, key, <span class="keyword">sizeof</span>(key), NULL, 0,</div>
<div class="line">    derivedKey, <span class="keyword">sizeof</span>(derivedKey));</div>
<div class="line"><span class="keywordflow">if</span> ( ret != 0 ) {</div>
<div class="line">    <span class="comment">// error generating derived key</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__HMAC_html_ga40742d591ae19f2d8f29b3fb2c34d264"><div class="ttname"><a href="#ga40742d591ae19f2d8f29b3fb2c34d264">wc_HKDF_Expand</a></div><div class="ttdeci">int wc_HKDF_Expand(int type, const byte *inKey, word32 inKeySz, const byte *info, word32 infoSz, byte *out, word32 outSz)</div><div class="ttdoc">This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaaec145333b157e9cb6962ef324fd61ec" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF</a> </dd>
<dd>
<a class="el" href="#gaad84e6af901427d1af6c1878825e0dd7" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Extract</a> </dd>
<dd>
<a class="el" href="#gaaa3c1cff5e67d06e21fd3cd8c7b37bae" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Extract_ex</a> </dd>
<dd>
<a class="el" href="#ga35854d88a7e502ead605d721f0315225" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Expand_ex</a> </dd></dl>

</div>
</div>
<a id="ga35854d88a7e502ead605d721f0315225" name="ga35854d88a7e502ead605d721f0315225"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga35854d88a7e502ead605d721f0315225">&#9670;&#160;</a></span>wc_HKDF_Expand_ex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_HKDF_Expand_ex </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>inKey</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>inKeySz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>info</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>infoSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>outSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>heap</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>devId</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert inKey, with optional info into a derived key, which it stores in out. The hash type defaults to MD5 if 0 or NULL is given. This is the _ex version adding heap hint and device identifier. </p>
<p>The HMAC configure option is &ndash;enable-hmac (on by default) or if building sources directly HAVE_HKDF</p>
<dl class="section return"><dt>Returns</dt><dd>0 Returned upon successfully generating a key with the given inputs </dd>
<dd>
BAD_FUNC_ARG Returned if an invalid hash type is given (see type param) </dd>
<dd>
MEMORY_E Returned if there is an error allocating memory </dd>
<dd>
HMAC_MIN_KEYLEN_E May be returned when using a FIPS implementation and the key length specified is shorter than the minimum acceptable FIPS standard</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>hash type to use for the HKDF. Valid types are: WC_MD5, WC_SHA, WC_SHA256, WC_SHA384, WC_SHA512, WC_SHA3_224, WC_SHA3_256, WC_SHA3_384 or WC_SHA3_512 </td></tr>
    <tr><td class="paramname">inKey</td><td>pointer to the buffer containing the key to use for KDF </td></tr>
    <tr><td class="paramname">inKeySz</td><td>length of the input key </td></tr>
    <tr><td class="paramname">info</td><td>pointer to a buffer containing optional additional info. Use NULL if not appending extra info </td></tr>
    <tr><td class="paramname">infoSz</td><td>length of additional info. Use 0 if not using additional info </td></tr>
    <tr><td class="paramname">out</td><td>pointer to the buffer in which to store the derived key </td></tr>
    <tr><td class="paramname">outSz</td><td>space available in the output buffer to store the generated key </td></tr>
    <tr><td class="paramname">heap</td><td>heap hint to use for memory. Can be NULL </td></tr>
    <tr><td class="paramname">devId</td><td>ID to use with crypto callbacks or async hardware. Set to INVALID_DEVID (-2) if not used</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="keywordtype">byte</span> key[] = { <span class="comment">// initialize with key };</span></div>
<div class="line"><span class="keywordtype">byte</span> salt[] = { <span class="comment">// initialize with salt };</span></div>
<div class="line"><span class="keywordtype">byte</span> derivedKey[MAX_DIGEST_SIZE];</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> ret = <a class="code hl_function" href="#ga35854d88a7e502ead605d721f0315225">wc_HKDF_Expand_ex</a>(WC_SHA512, key, <span class="keyword">sizeof</span>(key), NULL, 0,</div>
<div class="line">    derivedKey, <span class="keyword">sizeof</span>(derivedKey), NULL, INVALID_DEVID);</div>
<div class="line"><span class="keywordflow">if</span> ( ret != 0 ) {</div>
<div class="line">    <span class="comment">// error generating derived key</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__HMAC_html_ga35854d88a7e502ead605d721f0315225"><div class="ttname"><a href="#ga35854d88a7e502ead605d721f0315225">wc_HKDF_Expand_ex</a></div><div class="ttdeci">int wc_HKDF_Expand_ex(int type, const byte *inKey, word32 inKeySz, const byte *info, word32 infoSz, byte *out, word32 outSz, void *heap, int devId)</div><div class="ttdoc">This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaaec145333b157e9cb6962ef324fd61ec" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF</a> </dd>
<dd>
<a class="el" href="#gaad84e6af901427d1af6c1878825e0dd7" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Extract</a> </dd>
<dd>
<a class="el" href="#gaaa3c1cff5e67d06e21fd3cd8c7b37bae" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Extract_ex</a> </dd>
<dd>
<a class="el" href="#ga40742d591ae19f2d8f29b3fb2c34d264" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Expand</a> </dd></dl>

</div>
</div>
<a id="gaad84e6af901427d1af6c1878825e0dd7" name="gaad84e6af901427d1af6c1878825e0dd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaad84e6af901427d1af6c1878825e0dd7">&#9670;&#160;</a></span>wc_HKDF_Extract()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_HKDF_Extract </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>salt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>saltSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>inKey</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>inKeySz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert inKey, with an optional salt into a derived key, which it stores in out. The hash type defaults to MD5 if 0 or NULL is given. </p>
<p>The HMAC configure option is &ndash;enable-hmac (on by default) or if building sources directly HAVE_HKDF</p>
<dl class="section return"><dt>Returns</dt><dd>0 Returned upon successfully generating a key with the given inputs </dd>
<dd>
BAD_FUNC_ARG Returned if an invalid hash type is given (see type param) </dd>
<dd>
MEMORY_E Returned if there is an error allocating memory </dd>
<dd>
HMAC_MIN_KEYLEN_E May be returned when using a FIPS implementation and the key length specified is shorter than the minimum acceptable FIPS standard</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>hash type to use for the HKDF. Valid types are: WC_MD5, WC_SHA, WC_SHA256, WC_SHA384, WC_SHA512, WC_SHA3_224, WC_SHA3_256, WC_SHA3_384 or WC_SHA3_512 </td></tr>
    <tr><td class="paramname">salt</td><td>pointer to a buffer containing an optional salt. Use NULL instead if not using a salt </td></tr>
    <tr><td class="paramname">saltSz</td><td>length of the salt. Use 0 if not using a salt </td></tr>
    <tr><td class="paramname">inKey</td><td>pointer to the buffer containing the key to use for KDF </td></tr>
    <tr><td class="paramname">inKeySz</td><td>length of the input key </td></tr>
    <tr><td class="paramname">out</td><td>pointer to the buffer in which to store the derived key</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="keywordtype">byte</span> key[] = { <span class="comment">// initialize with key };</span></div>
<div class="line"><span class="keywordtype">byte</span> salt[] = { <span class="comment">// initialize with salt };</span></div>
<div class="line"><span class="keywordtype">byte</span> derivedKey[MAX_DIGEST_SIZE];</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> ret = <a class="code hl_function" href="#gaad84e6af901427d1af6c1878825e0dd7">wc_HKDF_Extract</a>(WC_SHA512, salt, <span class="keyword">sizeof</span>(salt), key, <span class="keyword">sizeof</span>(key),</div>
<div class="line">    derivedKey);</div>
<div class="line"><span class="keywordflow">if</span> ( ret != 0 ) {</div>
<div class="line">    <span class="comment">// error generating derived key</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__HMAC_html_gaad84e6af901427d1af6c1878825e0dd7"><div class="ttname"><a href="#gaad84e6af901427d1af6c1878825e0dd7">wc_HKDF_Extract</a></div><div class="ttdeci">int wc_HKDF_Extract(int type, const byte *salt, word32 saltSz, const byte *inKey, word32 inKeySz, byte *out)</div><div class="ttdoc">This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaaec145333b157e9cb6962ef324fd61ec" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF</a> </dd>
<dd>
<a class="el" href="#gaaa3c1cff5e67d06e21fd3cd8c7b37bae" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Extract_ex</a> </dd>
<dd>
<a class="el" href="#ga40742d591ae19f2d8f29b3fb2c34d264" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Expand</a> </dd>
<dd>
<a class="el" href="#ga35854d88a7e502ead605d721f0315225" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Expand_ex</a> </dd></dl>

</div>
</div>
<a id="gaaa3c1cff5e67d06e21fd3cd8c7b37bae" name="gaaa3c1cff5e67d06e21fd3cd8c7b37bae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaa3c1cff5e67d06e21fd3cd8c7b37bae">&#9670;&#160;</a></span>wc_HKDF_Extract_ex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_HKDF_Extract_ex </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>salt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>saltSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>inKey</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>inKeySz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>heap</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>devId</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert inKey, with an optional salt into a derived key, which it stores in out. The hash type defaults to MD5 if 0 or NULL is given. This is the _ex version adding heap hint and device identifier. </p>
<p>The HMAC configure option is &ndash;enable-hmac (on by default) or if building sources directly HAVE_HKDF</p>
<dl class="section return"><dt>Returns</dt><dd>0 Returned upon successfully generating a key with the given inputs </dd>
<dd>
BAD_FUNC_ARG Returned if an invalid hash type is given (see type param) </dd>
<dd>
MEMORY_E Returned if there is an error allocating memory </dd>
<dd>
HMAC_MIN_KEYLEN_E May be returned when using a FIPS implementation and the key length specified is shorter than the minimum acceptable FIPS standard</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>hash type to use for the HKDF. Valid types are: WC_MD5, WC_SHA, WC_SHA256, WC_SHA384, WC_SHA512, WC_SHA3_224, WC_SHA3_256, WC_SHA3_384 or WC_SHA3_512 </td></tr>
    <tr><td class="paramname">salt</td><td>pointer to a buffer containing an optional salt. Use NULL instead if not using a salt </td></tr>
    <tr><td class="paramname">saltSz</td><td>length of the salt. Use 0 if not using a salt </td></tr>
    <tr><td class="paramname">inKey</td><td>pointer to the buffer containing the key to use for KDF </td></tr>
    <tr><td class="paramname">inKeySz</td><td>length of the input key </td></tr>
    <tr><td class="paramname">out</td><td>pointer to the buffer in which to store the derived key </td></tr>
    <tr><td class="paramname">heap</td><td>heap hint to use for memory. Can be NULL </td></tr>
    <tr><td class="paramname">devId</td><td>ID to use with crypto callbacks or async hardware. Set to INVALID_DEVID (-2) if not used</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="keywordtype">byte</span> key[] = { <span class="comment">// initialize with key };</span></div>
<div class="line"><span class="keywordtype">byte</span> salt[] = { <span class="comment">// initialize with salt };</span></div>
<div class="line"><span class="keywordtype">byte</span> derivedKey[MAX_DIGEST_SIZE];</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> ret = <a class="code hl_function" href="#gaaa3c1cff5e67d06e21fd3cd8c7b37bae">wc_HKDF_Extract_ex</a>(WC_SHA512, salt, <span class="keyword">sizeof</span>(salt), key, <span class="keyword">sizeof</span>(key),</div>
<div class="line">    derivedKey, NULL, INVALID_DEVID);</div>
<div class="line"><span class="keywordflow">if</span> ( ret != 0 ) {</div>
<div class="line">    <span class="comment">// error generating derived key</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__HMAC_html_gaaa3c1cff5e67d06e21fd3cd8c7b37bae"><div class="ttname"><a href="#gaaa3c1cff5e67d06e21fd3cd8c7b37bae">wc_HKDF_Extract_ex</a></div><div class="ttdeci">int wc_HKDF_Extract_ex(int type, const byte *salt, word32 saltSz, const byte *inKey, word32 inKeySz, byte *out, void *heap, int devId)</div><div class="ttdoc">This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaaec145333b157e9cb6962ef324fd61ec" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF</a> </dd>
<dd>
<a class="el" href="#gaad84e6af901427d1af6c1878825e0dd7" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Extract</a> </dd>
<dd>
<a class="el" href="#ga40742d591ae19f2d8f29b3fb2c34d264" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Expand</a> </dd>
<dd>
<a class="el" href="#ga35854d88a7e502ead605d721f0315225" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Expand_ex</a> </dd></dl>

</div>
</div>
<a id="ga3c163b9dcb460081fd8c5d0885b21f7b" name="ga3c163b9dcb460081fd8c5d0885b21f7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3c163b9dcb460081fd8c5d0885b21f7b">&#9670;&#160;</a></span>wc_HmacFinal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_HmacFinal </td>
          <td>(</td>
          <td class="paramtype">Hmac *</td>          <td class="paramname"><span class="paramname"><em>hmac</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes the final hash of an Hmac object's message. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Returned on successfully computing the final hash </dd>
<dd>
MEMORY_E Returned if there is an error allocating memory for use with a hashing algorithm</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hmac</td><td>pointer to the Hmac object for which to calculate the final hash </td></tr>
    <tr><td class="paramname">hash</td><td>pointer to the buffer in which to store the final hash. Should have room available as required by the hashing algorithm chosen</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Hmac hmac;</div>
<div class="line"><span class="keywordtype">byte</span> hash[MD5_DIGEST_SIZE];</div>
<div class="line"><span class="comment">// initialize hmac with MD5 as type</span></div>
<div class="line"><span class="comment">// wc_HmacUpdate() with messages</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="#ga3c163b9dcb460081fd8c5d0885b21f7b">wc_HmacFinal</a>(&amp;hmac, hash) != 0) {</div>
<div class="line">    <span class="comment">// error computing hash</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__HMAC_html_ga3c163b9dcb460081fd8c5d0885b21f7b"><div class="ttname"><a href="#ga3c163b9dcb460081fd8c5d0885b21f7b">wc_HmacFinal</a></div><div class="ttdeci">int wc_HmacFinal(Hmac *hmac, byte *out)</div><div class="ttdoc">This function computes the final hash of an Hmac object&#39;s message.</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaa1ed3269712d18437a618acb7a278dae" title="This function initializes an Hmac object, setting its encryption type, key and HMAC length.">wc_HmacSetKey</a> </dd>
<dd>
<a class="el" href="#ga4533277215772c6cea848d2ad072823c" title="This function updates the message to authenticate using HMAC. It should be called after the Hmac obje...">wc_HmacUpdate</a> </dd></dl>

</div>
</div>
<a id="gaa1ed3269712d18437a618acb7a278dae" name="gaa1ed3269712d18437a618acb7a278dae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa1ed3269712d18437a618acb7a278dae">&#9670;&#160;</a></span>wc_HmacSetKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_HmacSetKey </td>
          <td>(</td>
          <td class="paramtype">Hmac *</td>          <td class="paramname"><span class="paramname"><em>hmac</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>keySz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function initializes an Hmac object, setting its encryption type, key and HMAC length. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Returned on successfully initializing the Hmac object </dd>
<dd>
BAD_FUNC_ARG Returned if the input type is invalid (see type param) </dd>
<dd>
MEMORY_E Returned if there is an error allocating memory for the structure to use for hashing </dd>
<dd>
HMAC_MIN_KEYLEN_E Returned when using a FIPS implementation and the key length specified is shorter than the minimum acceptable FIPS standard of 14 bytes</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hmac</td><td>pointer to the Hmac object to initialize </td></tr>
    <tr><td class="paramname">type</td><td>type specifying which encryption method the Hmac object should use. Valid options are: WC_MD5, WC_SHA, WC_SHA256, WC_SHA384, WC_SHA512, WC_SHA3_224, WC_SHA3_256, WC_SHA3_384 or WC_SHA3_512 </td></tr>
    <tr><td class="paramname">key</td><td>pointer to a buffer containing the key with which to initialize the Hmac object </td></tr>
    <tr><td class="paramname">length</td><td>length of the key</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Hmac hmac;</div>
<div class="line"><span class="keywordtype">byte</span> key[] = { <span class="comment">// initialize with key to use for encryption };</span></div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="#gaa1ed3269712d18437a618acb7a278dae">wc_HmacSetKey</a>(&amp;hmac, WC_MD5, key, <span class="keyword">sizeof</span>(key)) != 0) {</div>
<div class="line">    <span class="comment">// error initializing Hmac object</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__HMAC_html_gaa1ed3269712d18437a618acb7a278dae"><div class="ttname"><a href="#gaa1ed3269712d18437a618acb7a278dae">wc_HmacSetKey</a></div><div class="ttdeci">int wc_HmacSetKey(Hmac *hmac, int type, const byte *key, word32 keySz)</div><div class="ttdoc">This function initializes an Hmac object, setting its encryption type, key and HMAC length.</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga4533277215772c6cea848d2ad072823c" title="This function updates the message to authenticate using HMAC. It should be called after the Hmac obje...">wc_HmacUpdate</a> </dd>
<dd>
<a class="el" href="#ga3c163b9dcb460081fd8c5d0885b21f7b" title="This function computes the final hash of an Hmac object&#39;s message.">wc_HmacFinal</a> </dd></dl>

</div>
</div>
<a id="ga4533277215772c6cea848d2ad072823c" name="ga4533277215772c6cea848d2ad072823c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4533277215772c6cea848d2ad072823c">&#9670;&#160;</a></span>wc_HmacUpdate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_HmacUpdate </td>
          <td>(</td>
          <td class="paramtype">Hmac *</td>          <td class="paramname"><span class="paramname"><em>hmac</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>sz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function updates the message to authenticate using HMAC. It should be called after the Hmac object has been initialized with wc_HmacSetKey. This function may be called multiple times to update the message to hash. After calling wc_HmacUpdate as desired, one should call wc_HmacFinal to obtain the final authenticated message tag. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Returned on successfully updating the message to authenticate </dd>
<dd>
MEMORY_E Returned if there is an error allocating memory for use with a hashing algorithm</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hmac</td><td>pointer to the Hmac object for which to update the message </td></tr>
    <tr><td class="paramname">msg</td><td>pointer to the buffer containing the message to append </td></tr>
    <tr><td class="paramname">length</td><td>length of the message to append</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Hmac hmac;</div>
<div class="line"><span class="keywordtype">byte</span> msg[] = { <span class="comment">// initialize with message to authenticate };</span></div>
<div class="line"><span class="keywordtype">byte</span> msg2[] = { <span class="comment">// initialize with second half of message };</span></div>
<div class="line"><span class="comment">// initialize hmac</span></div>
<div class="line"><span class="keywordflow">if</span>( <a class="code hl_function" href="#ga4533277215772c6cea848d2ad072823c">wc_HmacUpdate</a>(&amp;hmac, msg, <span class="keyword">sizeof</span>(msg)) != 0) {</div>
<div class="line">    <span class="comment">// error updating message</span></div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">if</span>( <a class="code hl_function" href="#ga4533277215772c6cea848d2ad072823c">wc_HmacUpdate</a>(&amp;hmac, msg2, <span class="keyword">sizeof</span>(msg)) != 0) {</div>
<div class="line">    <span class="comment">// error updating with second message</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__HMAC_html_ga4533277215772c6cea848d2ad072823c"><div class="ttname"><a href="#ga4533277215772c6cea848d2ad072823c">wc_HmacUpdate</a></div><div class="ttdeci">int wc_HmacUpdate(Hmac *hmac, const byte *in, word32 sz)</div><div class="ttdoc">This function updates the message to authenticate using HMAC. It should be called after the Hmac obje...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaa1ed3269712d18437a618acb7a278dae" title="This function initializes an Hmac object, setting its encryption type, key and HMAC length.">wc_HmacSetKey</a> </dd>
<dd>
<a class="el" href="#ga3c163b9dcb460081fd8c5d0885b21f7b" title="This function computes the final hash of an Hmac object&#39;s message.">wc_HmacFinal</a> </dd></dl>

</div>
</div>
<a id="gab6d3b312369cd5e12e5e7cc7a4aa9400" name="gab6d3b312369cd5e12e5e7cc7a4aa9400"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab6d3b312369cd5e12e5e7cc7a4aa9400">&#9670;&#160;</a></span>wc_Tls13_HKDF_Expand_Label()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_Tls13_HKDF_Expand_Label </td>
          <td>(</td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>okm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>okmLen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>prk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>prkLen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>protocol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>protocolLen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>labelLen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>info</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>infoLen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>digest</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Expand data using HMAC, salt and label and info. TLS v1.3 defines this function for key derivation. This is the _ex version adding heap hint and device identifier. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Returned upon successfully generating a key with the given inputs </dd>
<dd>
BAD_FUNC_ARG Returned if an invalid hash type is given (see type param) </dd>
<dd>
MEMORY_E Returned if there is an error allocating memory </dd>
<dd>
HMAC_MIN_KEYLEN_E May be returned when using a FIPS implementation and the key length specified is shorter than the minimum acceptable FIPS standard</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">okm</td><td>Generated pseudorandom key - output key material. </td></tr>
    <tr><td class="paramname">okmLen</td><td>Length of generated pseudorandom key - output key material. </td></tr>
    <tr><td class="paramname">prk</td><td>Salt - pseudo-random key. </td></tr>
    <tr><td class="paramname">prkLen</td><td>Length of the salt - pseudo-random key. </td></tr>
    <tr><td class="paramname">protocol</td><td>TLS protocol label. </td></tr>
    <tr><td class="paramname">protocolLen</td><td>Length of the TLS protocol label. </td></tr>
    <tr><td class="paramname">info</td><td>Information to expand. </td></tr>
    <tr><td class="paramname">infoLen</td><td>Length of the information. </td></tr>
    <tr><td class="paramname">digest</td><td>Hash type to use for the HKDF. Valid types are: WC_SHA256, WC_SHA384 or WC_SHA512</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaaec145333b157e9cb6962ef324fd61ec" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF</a> </dd>
<dd>
<a class="el" href="#gaad84e6af901427d1af6c1878825e0dd7" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Extract</a> </dd>
<dd>
<a class="el" href="#gaaa3c1cff5e67d06e21fd3cd8c7b37bae" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Extract_ex</a> </dd>
<dd>
<a class="el" href="#ga40742d591ae19f2d8f29b3fb2c34d264" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Expand</a> </dd>
<dd>
<a class="el" href="#gabd086dd27bb1f55546a1681861b8fd89" title="Expand data using HMAC, salt and label and info. TLS v1.3 defines this function for key derivation....">wc_Tls13_HKDF_Expand_Label_ex</a> </dd>
<dd>
<a class="el" href="#ga6eb3e9c7073bbe2b2d6a2c2a03c3c8a4" title="This functions is very similar to wc_Tls13_HKDF_Expand_Label(), but it allocates memory if the stack ...">wc_Tls13_HKDF_Expand_Label_Alloc</a> </dd></dl>

</div>
</div>
<a id="ga6eb3e9c7073bbe2b2d6a2c2a03c3c8a4" name="ga6eb3e9c7073bbe2b2d6a2c2a03c3c8a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6eb3e9c7073bbe2b2d6a2c2a03c3c8a4">&#9670;&#160;</a></span>wc_Tls13_HKDF_Expand_Label_Alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_Tls13_HKDF_Expand_Label_Alloc </td>
          <td>(</td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>okm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>okmLen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>prk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>prkLen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>protocol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>protocolLen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>labelLen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>info</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>infoLen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>digest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>heap</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This functions is very similar to <a class="el" href="#gab6d3b312369cd5e12e5e7cc7a4aa9400" title="Expand data using HMAC, salt and label and info. TLS v1.3 defines this function for key derivation....">wc_Tls13_HKDF_Expand_Label()</a>, but it allocates memory if the stack space usually used isn't enough. Expand data using HMAC, salt and label and info. TLS v1.3 defines this function for key derivation. This is the _ex version adding heap hint and device identifier. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Returned upon successfully generating a key with the given inputs </dd>
<dd>
BAD_FUNC_ARG Returned if an invalid hash type is given (see type param) </dd>
<dd>
MEMORY_E Returned if there is an error allocating memory </dd>
<dd>
HMAC_MIN_KEYLEN_E May be returned when using a FIPS implementation and the key length specified is shorter than the minimum acceptable FIPS standard</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">okm</td><td>Generated pseudorandom key - output key material. </td></tr>
    <tr><td class="paramname">okmLen</td><td>Length of generated pseudorandom key - output key material. </td></tr>
    <tr><td class="paramname">prk</td><td>Salt - pseudo-random key. </td></tr>
    <tr><td class="paramname">prkLen</td><td>Length of the salt - pseudo-random key. </td></tr>
    <tr><td class="paramname">protocol</td><td>TLS protocol label. </td></tr>
    <tr><td class="paramname">protocolLen</td><td>Length of the TLS protocol label. </td></tr>
    <tr><td class="paramname">info</td><td>Information to expand. </td></tr>
    <tr><td class="paramname">infoLen</td><td>Length of the information. </td></tr>
    <tr><td class="paramname">digest</td><td>Hash type to use for the HKDF. Valid types are: WC_SHA256, WC_SHA384 or WC_SHA512 </td></tr>
    <tr><td class="paramname">heap</td><td>Heap hint to use for memory. Can be NULL</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaaec145333b157e9cb6962ef324fd61ec" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF</a> </dd>
<dd>
<a class="el" href="#gaad84e6af901427d1af6c1878825e0dd7" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Extract</a> </dd>
<dd>
<a class="el" href="#gaaa3c1cff5e67d06e21fd3cd8c7b37bae" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Extract_ex</a> </dd>
<dd>
<a class="el" href="#ga40742d591ae19f2d8f29b3fb2c34d264" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Expand</a> </dd>
<dd>
<a class="el" href="#gab6d3b312369cd5e12e5e7cc7a4aa9400" title="Expand data using HMAC, salt and label and info. TLS v1.3 defines this function for key derivation....">wc_Tls13_HKDF_Expand_Label</a> </dd>
<dd>
<a class="el" href="#gabd086dd27bb1f55546a1681861b8fd89" title="Expand data using HMAC, salt and label and info. TLS v1.3 defines this function for key derivation....">wc_Tls13_HKDF_Expand_Label_ex</a> </dd></dl>

</div>
</div>
<a id="gabd086dd27bb1f55546a1681861b8fd89" name="gabd086dd27bb1f55546a1681861b8fd89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabd086dd27bb1f55546a1681861b8fd89">&#9670;&#160;</a></span>wc_Tls13_HKDF_Expand_Label_ex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_Tls13_HKDF_Expand_Label_ex </td>
          <td>(</td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>okm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>okmLen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>prk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>prkLen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>protocol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>protocolLen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>labelLen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>info</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>infoLen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>digest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>heap</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>devId</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Expand data using HMAC, salt and label and info. TLS v1.3 defines this function for key derivation. This is the _ex version adding heap hint and device identifier. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Returned upon successfully generating a key with the given inputs </dd>
<dd>
BAD_FUNC_ARG Returned if an invalid hash type is given (see type param) </dd>
<dd>
MEMORY_E Returned if there is an error allocating memory </dd>
<dd>
HMAC_MIN_KEYLEN_E May be returned when using a FIPS implementation and the key length specified is shorter than the minimum acceptable FIPS standard</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">okm</td><td>Generated pseudorandom key - output key material. </td></tr>
    <tr><td class="paramname">okmLen</td><td>Length of generated pseudorandom key - output key material. </td></tr>
    <tr><td class="paramname">prk</td><td>Salt - pseudo-random key. </td></tr>
    <tr><td class="paramname">prkLen</td><td>Length of the salt - pseudo-random key. </td></tr>
    <tr><td class="paramname">protocol</td><td>TLS protocol label. </td></tr>
    <tr><td class="paramname">protocolLen</td><td>Length of the TLS protocol label. </td></tr>
    <tr><td class="paramname">info</td><td>Information to expand. </td></tr>
    <tr><td class="paramname">infoLen</td><td>Length of the information. </td></tr>
    <tr><td class="paramname">digest</td><td>Hash type to use for the HKDF. Valid types are: WC_SHA256, WC_SHA384 or WC_SHA512 </td></tr>
    <tr><td class="paramname">heap</td><td>Heap hint to use for memory. Can be NULL </td></tr>
    <tr><td class="paramname">devId</td><td>ID to use with crypto callbacks or async hardware. Set to INVALID_DEVID (-2) if not used</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaaec145333b157e9cb6962ef324fd61ec" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF</a> </dd>
<dd>
<a class="el" href="#gaad84e6af901427d1af6c1878825e0dd7" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Extract</a> </dd>
<dd>
<a class="el" href="#gaaa3c1cff5e67d06e21fd3cd8c7b37bae" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Extract_ex</a> </dd>
<dd>
<a class="el" href="#ga40742d591ae19f2d8f29b3fb2c34d264" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Expand</a> </dd>
<dd>
<a class="el" href="#gab6d3b312369cd5e12e5e7cc7a4aa9400" title="Expand data using HMAC, salt and label and info. TLS v1.3 defines this function for key derivation....">wc_Tls13_HKDF_Expand_Label</a> </dd>
<dd>
<a class="el" href="#ga6eb3e9c7073bbe2b2d6a2c2a03c3c8a4" title="This functions is very similar to wc_Tls13_HKDF_Expand_Label(), but it allocates memory if the stack ...">wc_Tls13_HKDF_Expand_Label_Alloc</a> </dd></dl>

</div>
</div>
<a id="ga1c545644da050a4f481272d1fdfb41bf" name="ga1c545644da050a4f481272d1fdfb41bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1c545644da050a4f481272d1fdfb41bf">&#9670;&#160;</a></span>wc_Tls13_HKDF_Extract()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_Tls13_HKDF_Extract </td>
          <td>(</td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>prk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>salt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>saltLen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>ikm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>ikmLen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>digest</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function provides access to RFC 5869 HMAC-based Extract-and-Expand Key Derivation Function (HKDF) for TLS v1.3 key derivation. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Returned upon successfully generating a key with the given inputs </dd>
<dd>
BAD_FUNC_ARG Returned if an invalid hash type is given (see type param) </dd>
<dd>
MEMORY_E Returned if there is an error allocating memory </dd>
<dd>
HMAC_MIN_KEYLEN_E May be returned when using a FIPS implementation and the key length specified is shorter than the minimum acceptable FIPS standard</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">prk</td><td>Generated pseudorandom key </td></tr>
    <tr><td class="paramname">salt</td><td>salt. </td></tr>
    <tr><td class="paramname">saltLen</td><td>length of the salt </td></tr>
    <tr><td class="paramname">ikm</td><td>pointer to putput for keying material </td></tr>
    <tr><td class="paramname">ikmLen</td><td>length of the input keying material buffer </td></tr>
    <tr><td class="paramname">digest</td><td>hash type to use for the HKDF. Valid types are: WC_SHA256, WC_SHA384 or WC_SHA512</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="keywordtype">byte</span> secret[] = { <span class="comment">// initialize with random key };</span></div>
<div class="line"><span class="keywordtype">byte</span> salt[] = { <span class="comment">// initialize with optional salt };</span></div>
<div class="line"><span class="keywordtype">byte</span> masterSecret[MAX_DIGEST_SIZE];</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> ret = <a class="code hl_function" href="#ga1c545644da050a4f481272d1fdfb41bf">wc_Tls13_HKDF_Extract</a>(secret, salt, <span class="keyword">sizeof</span>(salt), 0,</div>
<div class="line">    masterSecret, <span class="keyword">sizeof</span>(masterSecret), WC_SHA512);</div>
<div class="line"><span class="keywordflow">if</span> ( ret != 0 ) {</div>
<div class="line">    <span class="comment">// error generating derived key</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__HMAC_html_ga1c545644da050a4f481272d1fdfb41bf"><div class="ttname"><a href="#ga1c545644da050a4f481272d1fdfb41bf">wc_Tls13_HKDF_Extract</a></div><div class="ttdeci">int wc_Tls13_HKDF_Extract(byte *prk, const byte *salt, word32 saltLen, byte *ikm, word32 ikmLen, int digest)</div><div class="ttdoc">This function provides access to RFC 5869 HMAC-based Extract-and-Expand Key Derivation Function (HKDF...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaaec145333b157e9cb6962ef324fd61ec" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF</a> </dd>
<dd>
<a class="el" href="#gaad84e6af901427d1af6c1878825e0dd7" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Extract</a> </dd>
<dd>
<a class="el" href="#gaaa3c1cff5e67d06e21fd3cd8c7b37bae" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Extract_ex</a> </dd>
<dd>
<a class="el" href="#ga40742d591ae19f2d8f29b3fb2c34d264" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Expand</a> </dd>
<dd>
<a class="el" href="#gad254b375d35e368ee47b445c35d57abd" title="This function provides access to RFC 5869 HMAC-based Extract-and-Expand Key Derivation Function (HKDF...">wc_Tls13_HKDF_Extract_ex</a> </dd></dl>

</div>
</div>
<a id="gad254b375d35e368ee47b445c35d57abd" name="gad254b375d35e368ee47b445c35d57abd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad254b375d35e368ee47b445c35d57abd">&#9670;&#160;</a></span>wc_Tls13_HKDF_Extract_ex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_Tls13_HKDF_Extract_ex </td>
          <td>(</td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>prk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>salt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>saltLen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>ikm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>ikmLen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>digest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>heap</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>devId</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function provides access to RFC 5869 HMAC-based Extract-and-Expand Key Derivation Function (HKDF) for TLS v1.3 key derivation. This is the _ex version adding heap hint and device identifier. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Returned upon successfully generating a key with the given inputs </dd>
<dd>
BAD_FUNC_ARG Returned if an invalid hash type is given (see type param) </dd>
<dd>
MEMORY_E Returned if there is an error allocating memory </dd>
<dd>
HMAC_MIN_KEYLEN_E May be returned when using a FIPS implementation and the key length specified is shorter than the minimum acceptable FIPS standard</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">prk</td><td>Generated pseudorandom key </td></tr>
    <tr><td class="paramname">salt</td><td>Salt. </td></tr>
    <tr><td class="paramname">saltLen</td><td>Length of the salt </td></tr>
    <tr><td class="paramname">ikm</td><td>Pointer to output for keying material </td></tr>
    <tr><td class="paramname">ikmLen</td><td>Length of the input keying material buffer </td></tr>
    <tr><td class="paramname">digest</td><td>Hash type to use for the HKDF. Valid types are: WC_SHA256, WC_SHA384 or WC_SHA512 </td></tr>
    <tr><td class="paramname">heap</td><td>Heap hint to use for memory. Can be NULL </td></tr>
    <tr><td class="paramname">devId</td><td>ID to use with crypto callbacks or async hardware. Set to INVALID_DEVID (-2) if not used</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="keywordtype">byte</span> secret[] = { <span class="comment">// initialize with random key };</span></div>
<div class="line"><span class="keywordtype">byte</span> salt[] = { <span class="comment">// initialize with optional salt };</span></div>
<div class="line"><span class="keywordtype">byte</span> masterSecret[MAX_DIGEST_SIZE];</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> ret = <a class="code hl_function" href="#gad254b375d35e368ee47b445c35d57abd">wc_Tls13_HKDF_Extract_ex</a>(secret, salt, <span class="keyword">sizeof</span>(salt), 0,</div>
<div class="line">    masterSecret, <span class="keyword">sizeof</span>(masterSecret), WC_SHA512, NULL, INVALID_DEVID);</div>
<div class="line"><span class="keywordflow">if</span> ( ret != 0 ) {</div>
<div class="line">    <span class="comment">// error generating derived key</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__HMAC_html_gad254b375d35e368ee47b445c35d57abd"><div class="ttname"><a href="#gad254b375d35e368ee47b445c35d57abd">wc_Tls13_HKDF_Extract_ex</a></div><div class="ttdeci">int wc_Tls13_HKDF_Extract_ex(byte *prk, const byte *salt, word32 saltLen, byte *ikm, word32 ikmLen, int digest, void *heap, int devId)</div><div class="ttdoc">This function provides access to RFC 5869 HMAC-based Extract-and-Expand Key Derivation Function (HKDF...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaaec145333b157e9cb6962ef324fd61ec" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF</a> </dd>
<dd>
<a class="el" href="#gaad84e6af901427d1af6c1878825e0dd7" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Extract</a> </dd>
<dd>
<a class="el" href="#gaaa3c1cff5e67d06e21fd3cd8c7b37bae" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Extract_ex</a> </dd>
<dd>
<a class="el" href="#ga40742d591ae19f2d8f29b3fb2c34d264" title="This function provides access to a HMAC Key Derivation Function (HKDF). It utilizes HMAC to convert i...">wc_HKDF_Expand</a> </dd>
<dd>
<a class="el" href="#ga1c545644da050a4f481272d1fdfb41bf" title="This function provides access to RFC 5869 HMAC-based Extract-and-Expand Key Derivation Function (HKDF...">wc_Tls13_HKDF_Extract</a> </dd></dl>

</div>
</div>
<a id="ga1a51bb4d737f62b8362a09bf92b330ed" name="ga1a51bb4d737f62b8362a09bf92b330ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1a51bb4d737f62b8362a09bf92b330ed">&#9670;&#160;</a></span>wolfSSL_GetHmacMaxSize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wolfSSL_GetHmacMaxSize </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns the largest HMAC digest size available based on the configured cipher suites. </p>
<dl class="section return"><dt>Returns</dt><dd>Success Returns the largest HMAC digest size available based on the configured cipher suites</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">none</td><td>No parameters.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> maxDigestSz = <a class="code hl_function" href="#ga1a51bb4d737f62b8362a09bf92b330ed">wolfSSL_GetHmacMaxSize</a>();</div>
<div class="ttc" id="agroup__HMAC_html_ga1a51bb4d737f62b8362a09bf92b330ed"><div class="ttname"><a href="#ga1a51bb4d737f62b8362a09bf92b330ed">wolfSSL_GetHmacMaxSize</a></div><div class="ttdeci">int wolfSSL_GetHmacMaxSize(void)</div><div class="ttdoc">This function returns the largest HMAC digest size available based on the configured cipher suites.</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd>none </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
