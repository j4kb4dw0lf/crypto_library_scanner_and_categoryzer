<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>My Project: Algorithms - SRP</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="wolfssl_logo" style="width: 150px; height: 100px; display: inline-block;"><img alt="Logo" src="../images/wolfssl_logo.png" style="width: 150px; height: 100px;"/></div>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Algorithms - SRP </div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gae8584f826660880783a9603579f856af" id="r_gae8584f826660880783a9603579f856af"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gae8584f826660880783a9603579f856af">wc_SrpInit</a> (Srp *srp, SrpType type, SrpSide side)</td></tr>
<tr class="memdesc:gae8584f826660880783a9603579f856af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the Srp struct for usage.  <br /></td></tr>
<tr class="memitem:ga72b7e47afb9f716247d22c432480b226" id="r_ga72b7e47afb9f716247d22c432480b226"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga72b7e47afb9f716247d22c432480b226">wc_SrpTerm</a> (Srp *srp)</td></tr>
<tr class="memdesc:ga72b7e47afb9f716247d22c432480b226"><td class="mdescLeft">&#160;</td><td class="mdescRight">Releases the Srp struct resources after usage.  <br /></td></tr>
<tr class="memitem:ga7acf63aa2c1a1e2cf9cc1837b2b92ab0" id="r_ga7acf63aa2c1a1e2cf9cc1837b2b92ab0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga7acf63aa2c1a1e2cf9cc1837b2b92ab0">wc_SrpSetUsername</a> (Srp *srp, const byte *username, word32 size)</td></tr>
<tr class="memdesc:ga7acf63aa2c1a1e2cf9cc1837b2b92ab0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the username. This function MUST be called after wc_SrpInit.  <br /></td></tr>
<tr class="memitem:ga20edf7d124ae9ac9b8011c8171f46015" id="r_ga20edf7d124ae9ac9b8011c8171f46015"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga20edf7d124ae9ac9b8011c8171f46015">wc_SrpSetParams</a> (Srp *srp, const byte *N, word32 nSz, const byte *g, word32 gSz, const byte *salt, word32 saltSz)</td></tr>
<tr class="memdesc:ga20edf7d124ae9ac9b8011c8171f46015"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the srp parameters based on the username.. Must be called after wc_SrpSetUsername.  <br /></td></tr>
<tr class="memitem:gaa61b2ac6a14357ef0499a107b293edd9" id="r_gaa61b2ac6a14357ef0499a107b293edd9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa61b2ac6a14357ef0499a107b293edd9">wc_SrpSetPassword</a> (Srp *srp, const byte *password, word32 size)</td></tr>
<tr class="memdesc:gaa61b2ac6a14357ef0499a107b293edd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the password. Setting the password does not persists the clear password data in the srp structure. The client calculates x = H(salt + H(user:pswd)) and stores it in the auth field. This function MUST be called after wc_SrpSetParams and is CLIENT SIDE ONLY.  <br /></td></tr>
<tr class="memitem:ga5f9fa3b0ab92c78139534a1338f27f48" id="r_ga5f9fa3b0ab92c78139534a1338f27f48"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga5f9fa3b0ab92c78139534a1338f27f48">wc_SrpSetVerifier</a> (Srp *srp, const byte *verifier, word32 size)</td></tr>
<tr class="memdesc:ga5f9fa3b0ab92c78139534a1338f27f48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the verifier. This function MUST be called after wc_SrpSetParams and is SERVER SIDE ONLY.  <br /></td></tr>
<tr class="memitem:ga2ac38c69fcf5b918c07858b9d2325d00" id="r_ga2ac38c69fcf5b918c07858b9d2325d00"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga2ac38c69fcf5b918c07858b9d2325d00">wc_SrpGetVerifier</a> (Srp *srp, byte *verifier, word32 *size)</td></tr>
<tr class="memdesc:ga2ac38c69fcf5b918c07858b9d2325d00"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the verifier. The client calculates the verifier with v = g ^ x % N. This function MAY be called after wc_SrpSetPassword and is CLIENT SIDE ONLY.  <br /></td></tr>
<tr class="memitem:ga30a3f45c5d54d58a491e8054a8147ed0" id="r_ga30a3f45c5d54d58a491e8054a8147ed0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga30a3f45c5d54d58a491e8054a8147ed0">wc_SrpSetPrivate</a> (Srp *srp, const byte *priv, word32 size)</td></tr>
<tr class="memdesc:ga30a3f45c5d54d58a491e8054a8147ed0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the private ephemeral value. The private ephemeral value is known as: a at the client side. a = random() b at the server side. b = random() This function is handy for unit test cases or if the developer wants to use an external random source to set the ephemeral value. This function MAY be called before wc_SrpGetPublic.  <br /></td></tr>
<tr class="memitem:ga355d15b75810986f22e904ca6dc92e6a" id="r_ga355d15b75810986f22e904ca6dc92e6a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga355d15b75810986f22e904ca6dc92e6a">wc_SrpGetPublic</a> (Srp *srp, byte *pub, word32 *size)</td></tr>
<tr class="memdesc:ga355d15b75810986f22e904ca6dc92e6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the public ephemeral value. The public ephemeral value is known as: A at the client side. A = g ^ a % N B at the server side. B = (k * v + (g ˆ b % N)) % N This function MUST be called after wc_SrpSetPassword or wc_SrpSetVerifier. The function wc_SrpSetPrivate may be called before wc_SrpGetPublic.  <br /></td></tr>
<tr class="memitem:ga07b6f312117b6324189a137c3e2e6201" id="r_ga07b6f312117b6324189a137c3e2e6201"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga07b6f312117b6324189a137c3e2e6201">wc_SrpComputeKey</a> (Srp *srp, byte *clientPubKey, word32 clientPubKeySz, byte *serverPubKey, word32 serverPubKeySz)</td></tr>
<tr class="memdesc:ga07b6f312117b6324189a137c3e2e6201"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the session key. The key can be accessed at srp-&gt;key after success.  <br /></td></tr>
<tr class="memitem:gacf4349192069b647d6f5b34deab4f5ff" id="r_gacf4349192069b647d6f5b34deab4f5ff"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gacf4349192069b647d6f5b34deab4f5ff">wc_SrpGetProof</a> (Srp *srp, byte *proof, word32 *size)</td></tr>
<tr class="memdesc:gacf4349192069b647d6f5b34deab4f5ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the proof. This function MUST be called after wc_SrpComputeKey.  <br /></td></tr>
<tr class="memitem:ga55c898aca55ea35235cddfdd628c2080" id="r_ga55c898aca55ea35235cddfdd628c2080"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga55c898aca55ea35235cddfdd628c2080">wc_SrpVerifyPeersProof</a> (Srp *srp, byte *proof, word32 size)</td></tr>
<tr class="memdesc:ga55c898aca55ea35235cddfdd628c2080"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies the peers proof. This function MUST be called before wc_SrpGetSessionKey.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="ga07b6f312117b6324189a137c3e2e6201" name="ga07b6f312117b6324189a137c3e2e6201"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga07b6f312117b6324189a137c3e2e6201">&#9670;&#160;</a></span>wc_SrpComputeKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_SrpComputeKey </td>
          <td>(</td>
          <td class="paramtype">Srp *</td>          <td class="paramname"><span class="paramname"><em>srp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>clientPubKey</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>clientPubKeySz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>serverPubKey</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>serverPubKeySz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the session key. The key can be accessed at srp-&gt;key after success. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Success </dd>
<dd>
BAD_FUNC_ARG Returned if srp, clientPubKey, or serverPubKey or if clientPubKeySz or serverPubKeySz is 0. </dd>
<dd>
SRP_CALL_ORDER_E Returned if wc_SrpComputeKey is called out of order. </dd>
<dd>
&lt;0 Error</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srp</td><td>the Srp structure. </td></tr>
    <tr><td class="paramname">clientPubKey</td><td>the client's public ephemeral value. </td></tr>
    <tr><td class="paramname">clientPubKeySz</td><td>the client's public ephemeral value size. </td></tr>
    <tr><td class="paramname">serverPubKey</td><td>the server's public ephemeral value. </td></tr>
    <tr><td class="paramname">serverPubKeySz</td><td>the server's public ephemeral value size.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Srp server;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">byte</span> username[] = <span class="stringliteral">&quot;user&quot;</span>;</div>
<div class="line">    word32 usernameSize = 4;</div>
<div class="line"><span class="keywordtype">byte</span> password[] = <span class="stringliteral">&quot;password&quot;</span>;</div>
<div class="line">word32 passwordSize = 8;</div>
<div class="line"><span class="keywordtype">byte</span> N[] = { }; <span class="comment">// Contents of byte array N</span></div>
<div class="line"><span class="keywordtype">byte</span> g[] = { }; <span class="comment">// Contents of byte array g</span></div>
<div class="line"><span class="keywordtype">byte</span> salt[] = { }; <span class="comment">// Contents of byte array salt</span></div>
<div class="line"><span class="keywordtype">byte</span> verifier[] = { }; <span class="comment">// Contents of some verifier</span></div>
<div class="line"><span class="keywordtype">byte</span> serverPubKey[] = { }; <span class="comment">// Contents of server pub key</span></div>
<div class="line">word32 serverPubKeySize = <span class="keyword">sizeof</span>(serverPubKey);</div>
<div class="line"><span class="keywordtype">byte</span> clientPubKey[64];</div>
<div class="line">word32 clientPubKeySize = 64;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#gae8584f826660880783a9603579f856af">wc_SrpInit</a>(&amp;server, SRP_TYPE_SHA, SRP_SERVER_SIDE);</div>
<div class="line"><a class="code hl_function" href="#ga7acf63aa2c1a1e2cf9cc1837b2b92ab0">wc_SrpSetUsername</a>(&amp;server, username, usernameSize);</div>
<div class="line"><a class="code hl_function" href="#ga20edf7d124ae9ac9b8011c8171f46015">wc_SrpSetParams</a>(&amp;server, N, <span class="keyword">sizeof</span>(N), g, <span class="keyword">sizeof</span>(g), salt, <span class="keyword">sizeof</span>(salt));</div>
<div class="line"><a class="code hl_function" href="#ga5f9fa3b0ab92c78139534a1338f27f48">wc_SrpSetVerifier</a>(&amp;server, verifier, <span class="keyword">sizeof</span>(verifier));</div>
<div class="line"><a class="code hl_function" href="#ga355d15b75810986f22e904ca6dc92e6a">wc_SrpGetPublic</a>(&amp;server, serverPubKey, &amp;serverPubKeySize);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ga07b6f312117b6324189a137c3e2e6201">wc_SrpComputeKey</a>(&amp;server, clientPubKey, clientPubKeySz,</div>
<div class="line">                                      serverPubKey, serverPubKeySize)</div>
<div class="line"><a class="code hl_function" href="#ga72b7e47afb9f716247d22c432480b226">wc_SrpTerm</a>(&amp;server);</div>
<div class="ttc" id="agroup__SRP_html_ga07b6f312117b6324189a137c3e2e6201"><div class="ttname"><a href="#ga07b6f312117b6324189a137c3e2e6201">wc_SrpComputeKey</a></div><div class="ttdeci">int wc_SrpComputeKey(Srp *srp, byte *clientPubKey, word32 clientPubKeySz, byte *serverPubKey, word32 serverPubKeySz)</div><div class="ttdoc">Computes the session key. The key can be accessed at srp-&gt;key after success.</div></div>
<div class="ttc" id="agroup__SRP_html_ga20edf7d124ae9ac9b8011c8171f46015"><div class="ttname"><a href="#ga20edf7d124ae9ac9b8011c8171f46015">wc_SrpSetParams</a></div><div class="ttdeci">int wc_SrpSetParams(Srp *srp, const byte *N, word32 nSz, const byte *g, word32 gSz, const byte *salt, word32 saltSz)</div><div class="ttdoc">Sets the srp parameters based on the username.. Must be called after wc_SrpSetUsername.</div></div>
<div class="ttc" id="agroup__SRP_html_ga355d15b75810986f22e904ca6dc92e6a"><div class="ttname"><a href="#ga355d15b75810986f22e904ca6dc92e6a">wc_SrpGetPublic</a></div><div class="ttdeci">int wc_SrpGetPublic(Srp *srp, byte *pub, word32 *size)</div><div class="ttdoc">Gets the public ephemeral value. The public ephemeral value is known as: A at the client side....</div></div>
<div class="ttc" id="agroup__SRP_html_ga5f9fa3b0ab92c78139534a1338f27f48"><div class="ttname"><a href="#ga5f9fa3b0ab92c78139534a1338f27f48">wc_SrpSetVerifier</a></div><div class="ttdeci">int wc_SrpSetVerifier(Srp *srp, const byte *verifier, word32 size)</div><div class="ttdoc">Sets the verifier. This function MUST be called after wc_SrpSetParams and is SERVER SIDE ONLY.</div></div>
<div class="ttc" id="agroup__SRP_html_ga72b7e47afb9f716247d22c432480b226"><div class="ttname"><a href="#ga72b7e47afb9f716247d22c432480b226">wc_SrpTerm</a></div><div class="ttdeci">void wc_SrpTerm(Srp *srp)</div><div class="ttdoc">Releases the Srp struct resources after usage.</div></div>
<div class="ttc" id="agroup__SRP_html_ga7acf63aa2c1a1e2cf9cc1837b2b92ab0"><div class="ttname"><a href="#ga7acf63aa2c1a1e2cf9cc1837b2b92ab0">wc_SrpSetUsername</a></div><div class="ttdeci">int wc_SrpSetUsername(Srp *srp, const byte *username, word32 size)</div><div class="ttdoc">Sets the username. This function MUST be called after wc_SrpInit.</div></div>
<div class="ttc" id="agroup__SRP_html_gae8584f826660880783a9603579f856af"><div class="ttname"><a href="#gae8584f826660880783a9603579f856af">wc_SrpInit</a></div><div class="ttdeci">int wc_SrpInit(Srp *srp, SrpType type, SrpSide side)</div><div class="ttdoc">Initializes the Srp struct for usage.</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga355d15b75810986f22e904ca6dc92e6a" title="Gets the public ephemeral value. The public ephemeral value is known as: A at the client side....">wc_SrpGetPublic</a> </dd></dl>

</div>
</div>
<a id="gacf4349192069b647d6f5b34deab4f5ff" name="gacf4349192069b647d6f5b34deab4f5ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacf4349192069b647d6f5b34deab4f5ff">&#9670;&#160;</a></span>wc_SrpGetProof()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_SrpGetProof </td>
          <td>(</td>
          <td class="paramtype">Srp *</td>          <td class="paramname"><span class="paramname"><em>srp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>proof</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32 *</td>          <td class="paramname"><span class="paramname"><em>size</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the proof. This function MUST be called after wc_SrpComputeKey. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Success </dd>
<dd>
BAD_FUNC_ARG Returns if srp, proof, or size is null. </dd>
<dd>
BUFFER_E Returns if size is less than the hash size of srp-&gt;type. </dd>
<dd>
&lt;0 Error</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srp</td><td>the Srp structure. </td></tr>
    <tr><td class="paramname">proof</td><td>the peers proof. </td></tr>
    <tr><td class="paramname">size</td><td>the proof size in bytes.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Srp cli;</div>
<div class="line"><span class="keywordtype">byte</span> clientProof[SRP_MAX_DIGEST_SIZE];</div>
<div class="line">word32 clientProofSz = SRP_MAX_DIGEST_SIZE;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Initialize Srp following steps from previous examples</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="#gacf4349192069b647d6f5b34deab4f5ff">wc_SrpGetProof</a>(&amp;cli, clientProof, &amp;clientProofSz) != 0)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Error getting proof</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__SRP_html_gacf4349192069b647d6f5b34deab4f5ff"><div class="ttname"><a href="#gacf4349192069b647d6f5b34deab4f5ff">wc_SrpGetProof</a></div><div class="ttdeci">int wc_SrpGetProof(Srp *srp, byte *proof, word32 *size)</div><div class="ttdoc">Gets the proof. This function MUST be called after wc_SrpComputeKey.</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga07b6f312117b6324189a137c3e2e6201" title="Computes the session key. The key can be accessed at srp-&gt;key after success.">wc_SrpComputeKey</a> </dd></dl>

</div>
</div>
<a id="ga355d15b75810986f22e904ca6dc92e6a" name="ga355d15b75810986f22e904ca6dc92e6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga355d15b75810986f22e904ca6dc92e6a">&#9670;&#160;</a></span>wc_SrpGetPublic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_SrpGetPublic </td>
          <td>(</td>
          <td class="paramtype">Srp *</td>          <td class="paramname"><span class="paramname"><em>srp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>pub</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32 *</td>          <td class="paramname"><span class="paramname"><em>size</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the public ephemeral value. The public ephemeral value is known as: A at the client side. A = g ^ a % N B at the server side. B = (k * v + (g ˆ b % N)) % N This function MUST be called after wc_SrpSetPassword or wc_SrpSetVerifier. The function wc_SrpSetPrivate may be called before wc_SrpGetPublic. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Success </dd>
<dd>
BAD_FUNC_ARG Returned if srp, pub, or size is null. </dd>
<dd>
SRP_CALL_ORDER_E Returned if wc_SrpGetPublic is called out of order. </dd>
<dd>
BUFFER_E Returned if size &lt; srp.N. </dd>
<dd>
&lt;0 Error</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srp</td><td>the Srp structure. </td></tr>
    <tr><td class="paramname">pub</td><td>the buffer to write the public ephemeral value. </td></tr>
    <tr><td class="paramname">size</td><td>the the buffer size in bytes. Will be updated with the ephemeral value size.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Srp srp;</div>
<div class="line"><span class="keywordtype">byte</span> username[] = <span class="stringliteral">&quot;user&quot;</span>;</div>
<div class="line">word32 usernameSize = 4;</div>
<div class="line"><span class="keywordtype">byte</span> password[] = <span class="stringliteral">&quot;password&quot;</span>;</div>
<div class="line">word32 passwordSize = 8;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">byte</span> N[] = { }; <span class="comment">// Contents of byte array N</span></div>
<div class="line"><span class="keywordtype">byte</span> g[] = { }; <span class="comment">// Contents of byte array g</span></div>
<div class="line"><span class="keywordtype">byte</span> salt[] = { }; <span class="comment">// Contents of byte array salt</span></div>
<div class="line"><a class="code hl_function" href="#gae8584f826660880783a9603579f856af">wc_SrpInit</a>(&amp;srp, SRP_TYPE_SHA, SRP_CLIENT_SIDE);</div>
<div class="line"><a class="code hl_function" href="#ga7acf63aa2c1a1e2cf9cc1837b2b92ab0">wc_SrpSetUsername</a>(&amp;srp, username, usernameSize);</div>
<div class="line"><a class="code hl_function" href="#ga20edf7d124ae9ac9b8011c8171f46015">wc_SrpSetParams</a>(&amp;srp, N, <span class="keyword">sizeof</span>(N), g, <span class="keyword">sizeof</span>(g), salt, <span class="keyword">sizeof</span>(salt));</div>
<div class="line"><a class="code hl_function" href="#gaa61b2ac6a14357ef0499a107b293edd9">wc_SrpSetPassword</a>(&amp;srp, password, passwordSize)</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">byte</span> <span class="keyword">public</span>[64];</div>
<div class="line">word32 publicSz = 0;</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>( <a class="code hl_function" href="#ga355d15b75810986f22e904ca6dc92e6a">wc_SrpGetPublic</a>(&amp;srp, <span class="keyword">public</span>, &amp;publicSz) != 0)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Error getting public ephemeral</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ga72b7e47afb9f716247d22c432480b226">wc_SrpTerm</a>(&amp;srp);</div>
<div class="ttc" id="agroup__SRP_html_gaa61b2ac6a14357ef0499a107b293edd9"><div class="ttname"><a href="#gaa61b2ac6a14357ef0499a107b293edd9">wc_SrpSetPassword</a></div><div class="ttdeci">int wc_SrpSetPassword(Srp *srp, const byte *password, word32 size)</div><div class="ttdoc">Sets the password. Setting the password does not persists the clear password data in the srp structur...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga30a3f45c5d54d58a491e8054a8147ed0" title="Sets the private ephemeral value. The private ephemeral value is known as: a at the client side....">wc_SrpSetPrivate</a> </dd>
<dd>
<a class="el" href="#gaa61b2ac6a14357ef0499a107b293edd9" title="Sets the password. Setting the password does not persists the clear password data in the srp structur...">wc_SrpSetPassword</a> </dd>
<dd>
<a class="el" href="#ga5f9fa3b0ab92c78139534a1338f27f48" title="Sets the verifier. This function MUST be called after wc_SrpSetParams and is SERVER SIDE ONLY.">wc_SrpSetVerifier</a> </dd></dl>

</div>
</div>
<a id="ga2ac38c69fcf5b918c07858b9d2325d00" name="ga2ac38c69fcf5b918c07858b9d2325d00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2ac38c69fcf5b918c07858b9d2325d00">&#9670;&#160;</a></span>wc_SrpGetVerifier()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_SrpGetVerifier </td>
          <td>(</td>
          <td class="paramtype">Srp *</td>          <td class="paramname"><span class="paramname"><em>srp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>verifier</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32 *</td>          <td class="paramname"><span class="paramname"><em>size</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the verifier. The client calculates the verifier with v = g ^ x % N. This function MAY be called after wc_SrpSetPassword and is CLIENT SIDE ONLY. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Success </dd>
<dd>
BAD_FUNC_ARG Returned if srp, verifier or size is null or if srp-&gt;side is not SRP_CLIENT_SIDE. </dd>
<dd>
SRP_CALL_ORDER_E Returned if wc_SrpGetVerifier is called out of order. </dd>
<dd>
&lt;0 Error</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srp</td><td>The Srp structure. </td></tr>
    <tr><td class="paramname">verifier</td><td>The buffer to write the verifier. </td></tr>
    <tr><td class="paramname">size</td><td>Buffer size in bytes. Updated with the verifier size.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Srp srp;</div>
<div class="line"><span class="keywordtype">byte</span> username[] = <span class="stringliteral">&quot;user&quot;</span>;</div>
<div class="line">word32 usernameSize = 4;</div>
<div class="line"><span class="keywordtype">byte</span> password[] = <span class="stringliteral">&quot;password&quot;</span>;</div>
<div class="line">word32 passwordSize = 8;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">byte</span> N[] = { }; <span class="comment">// Contents of byte array N</span></div>
<div class="line"><span class="keywordtype">byte</span> g[] = { }; <span class="comment">// Contents of byte array g</span></div>
<div class="line"><span class="keywordtype">byte</span> salt[] = { }; <span class="comment">// Contents of byte array salt</span></div>
<div class="line"><span class="keywordtype">byte</span> v[64];</div>
<div class="line">word32 vSz = 0;</div>
<div class="line">vSz = <span class="keyword">sizeof</span>(v);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#gae8584f826660880783a9603579f856af">wc_SrpInit</a>(&amp;srp, SRP_TYPE_SHA, SRP_CLIENT_SIDE);</div>
<div class="line"><a class="code hl_function" href="#ga7acf63aa2c1a1e2cf9cc1837b2b92ab0">wc_SrpSetUsername</a>(&amp;srp, username, usernameSize);</div>
<div class="line"><a class="code hl_function" href="#ga20edf7d124ae9ac9b8011c8171f46015">wc_SrpSetParams</a>(&amp;srp, N, <span class="keyword">sizeof</span>(N), g, <span class="keyword">sizeof</span>(g), salt, <span class="keyword">sizeof</span>(salt))</div>
<div class="line"><a class="code hl_function" href="#gaa61b2ac6a14357ef0499a107b293edd9">wc_SrpSetPassword</a>(&amp;srp, password, passwordSize)</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>( <a class="code hl_function" href="#ga2ac38c69fcf5b918c07858b9d2325d00">wc_SrpGetVerifier</a>(&amp;srp, v, &amp;vSz ) != 0)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Error getting verifier</span></div>
<div class="line">}</div>
<div class="line"><a class="code hl_function" href="#ga72b7e47afb9f716247d22c432480b226">wc_SrpTerm</a>(&amp;srp);</div>
<div class="ttc" id="agroup__SRP_html_ga2ac38c69fcf5b918c07858b9d2325d00"><div class="ttname"><a href="#ga2ac38c69fcf5b918c07858b9d2325d00">wc_SrpGetVerifier</a></div><div class="ttdeci">int wc_SrpGetVerifier(Srp *srp, byte *verifier, word32 *size)</div><div class="ttdoc">Gets the verifier. The client calculates the verifier with v = g ^ x % N. This function MAY be called...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga5f9fa3b0ab92c78139534a1338f27f48" title="Sets the verifier. This function MUST be called after wc_SrpSetParams and is SERVER SIDE ONLY.">wc_SrpSetVerifier</a> </dd>
<dd>
<a class="el" href="#gaa61b2ac6a14357ef0499a107b293edd9" title="Sets the password. Setting the password does not persists the clear password data in the srp structur...">wc_SrpSetPassword</a> </dd></dl>

</div>
</div>
<a id="gae8584f826660880783a9603579f856af" name="gae8584f826660880783a9603579f856af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae8584f826660880783a9603579f856af">&#9670;&#160;</a></span>wc_SrpInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_SrpInit </td>
          <td>(</td>
          <td class="paramtype">Srp *</td>          <td class="paramname"><span class="paramname"><em>srp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SrpType</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SrpSide</td>          <td class="paramname"><span class="paramname"><em>side</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the Srp struct for usage. </p>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd>
<dd>
BAD_FUNC_ARG Returns when there's an issue with the arguments such as srp being null or SrpSide not being SRP_CLIENT_SIDE or SRP_SERVER_SIDE. </dd>
<dd>
NOT_COMPILED_IN Returns when a type is passed as an argument but hasn't been configured in the wolfCrypt build. </dd>
<dd>
&lt;0 on error.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srp</td><td>the Srp structure to be initialized. </td></tr>
    <tr><td class="paramname">type</td><td>the hash type to be used. </td></tr>
    <tr><td class="paramname">side</td><td>the side of the communication.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Srp srp;</div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="#gae8584f826660880783a9603579f856af">wc_SrpInit</a>(&amp;srp, SRP_TYPE_SHA, SRP_CLIENT_SIDE) != 0)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Initialization error</span></div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">{</div>
<div class="line">    <a class="code hl_function" href="#ga72b7e47afb9f716247d22c432480b226">wc_SrpTerm</a>(&amp;srp);</div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga72b7e47afb9f716247d22c432480b226" title="Releases the Srp struct resources after usage.">wc_SrpTerm</a> </dd>
<dd>
<a class="el" href="#ga7acf63aa2c1a1e2cf9cc1837b2b92ab0" title="Sets the username. This function MUST be called after wc_SrpInit.">wc_SrpSetUsername</a> </dd></dl>

</div>
</div>
<a id="ga20edf7d124ae9ac9b8011c8171f46015" name="ga20edf7d124ae9ac9b8011c8171f46015"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga20edf7d124ae9ac9b8011c8171f46015">&#9670;&#160;</a></span>wc_SrpSetParams()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_SrpSetParams </td>
          <td>(</td>
          <td class="paramtype">Srp *</td>          <td class="paramname"><span class="paramname"><em>srp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>N</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>nSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>g</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>gSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>salt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>saltSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the srp parameters based on the username.. Must be called after wc_SrpSetUsername. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Success </dd>
<dd>
BAD_FUNC_ARG Returns if srp, N, g, or salt is null or if nSz &lt; gSz. </dd>
<dd>
SRP_CALL_ORDER_E Returns if wc_SrpSetParams is called before wc_SrpSetUsername. </dd>
<dd>
&lt;0 Error</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srp</td><td>the Srp structure. </td></tr>
    <tr><td class="paramname">N</td><td>the Modulus. N = 2q+1, [q, N] are primes. </td></tr>
    <tr><td class="paramname">nSz</td><td>the N size in bytes. </td></tr>
    <tr><td class="paramname">g</td><td>the Generator modulo N. </td></tr>
    <tr><td class="paramname">gSz</td><td>the g size in bytes </td></tr>
    <tr><td class="paramname">salt</td><td>a small random salt. Specific for each username. </td></tr>
    <tr><td class="paramname">saltSz</td><td>the salt size in bytes</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Srp srp;</div>
<div class="line"><span class="keywordtype">byte</span> username[] = <span class="stringliteral">&quot;user&quot;</span>;</div>
<div class="line">word32 usernameSize = 4;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">byte</span> N[] = { }; <span class="comment">// Contents of byte array N</span></div>
<div class="line"><span class="keywordtype">byte</span> g[] = { }; <span class="comment">// Contents of byte array g</span></div>
<div class="line"><span class="keywordtype">byte</span> salt[] = { }; <span class="comment">// Contents of byte array salt</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#gae8584f826660880783a9603579f856af">wc_SrpInit</a>(&amp;srp, SRP_TYPE_SHA, SRP_CLIENT_SIDE);</div>
<div class="line"><a class="code hl_function" href="#ga7acf63aa2c1a1e2cf9cc1837b2b92ab0">wc_SrpSetUsername</a>(&amp;srp, username, usernameSize);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>(<a class="code hl_function" href="#ga20edf7d124ae9ac9b8011c8171f46015">wc_SrpSetParams</a>(&amp;srp, N, <span class="keyword">sizeof</span>(N), g, <span class="keyword">sizeof</span>(g), salt,</div>
<div class="line"><span class="keyword">sizeof</span>(salt)) != 0)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Error setting params</span></div>
<div class="line">}</div>
<div class="line"><a class="code hl_function" href="#ga72b7e47afb9f716247d22c432480b226">wc_SrpTerm</a>(&amp;srp);</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gae8584f826660880783a9603579f856af" title="Initializes the Srp struct for usage.">wc_SrpInit</a> </dd>
<dd>
<a class="el" href="#ga7acf63aa2c1a1e2cf9cc1837b2b92ab0" title="Sets the username. This function MUST be called after wc_SrpInit.">wc_SrpSetUsername</a> </dd>
<dd>
<a class="el" href="#ga72b7e47afb9f716247d22c432480b226" title="Releases the Srp struct resources after usage.">wc_SrpTerm</a> </dd></dl>

</div>
</div>
<a id="gaa61b2ac6a14357ef0499a107b293edd9" name="gaa61b2ac6a14357ef0499a107b293edd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa61b2ac6a14357ef0499a107b293edd9">&#9670;&#160;</a></span>wc_SrpSetPassword()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_SrpSetPassword </td>
          <td>(</td>
          <td class="paramtype">Srp *</td>          <td class="paramname"><span class="paramname"><em>srp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>password</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>size</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the password. Setting the password does not persists the clear password data in the srp structure. The client calculates x = H(salt + H(user:pswd)) and stores it in the auth field. This function MUST be called after wc_SrpSetParams and is CLIENT SIDE ONLY. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Success </dd>
<dd>
BAD_FUNC_ARG Returns if srp or password is null or if srp-&gt;side is not set to SRP_CLIENT_SIDE. </dd>
<dd>
SRP_CALL_ORDER_E Returns when wc_SrpSetPassword is called out of order. </dd>
<dd>
&lt;0 Error</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srp</td><td>The Srp structure. </td></tr>
    <tr><td class="paramname">password</td><td>The buffer containing the password. </td></tr>
    <tr><td class="paramname">size</td><td>The size of the password in bytes.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Srp srp;</div>
<div class="line"><span class="keywordtype">byte</span> username[] = <span class="stringliteral">&quot;user&quot;</span>;</div>
<div class="line">word32 usernameSize = 4;</div>
<div class="line"><span class="keywordtype">byte</span> password[] = <span class="stringliteral">&quot;password&quot;</span>;</div>
<div class="line">word32 passwordSize = 8;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">byte</span> N[] = { }; <span class="comment">// Contents of byte array N</span></div>
<div class="line"><span class="keywordtype">byte</span> g[] = { }; <span class="comment">// Contents of byte array g</span></div>
<div class="line"><span class="keywordtype">byte</span> salt[] = { }; <span class="comment">// Contents of byte array salt</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#gae8584f826660880783a9603579f856af">wc_SrpInit</a>(&amp;srp, SRP_TYPE_SHA, SRP_CLIENT_SIDE);</div>
<div class="line"><a class="code hl_function" href="#ga7acf63aa2c1a1e2cf9cc1837b2b92ab0">wc_SrpSetUsername</a>(&amp;srp, username, usernameSize);</div>
<div class="line"><a class="code hl_function" href="#ga20edf7d124ae9ac9b8011c8171f46015">wc_SrpSetParams</a>(&amp;srp, N, <span class="keyword">sizeof</span>(N), g, <span class="keyword">sizeof</span>(g), salt, <span class="keyword">sizeof</span>(salt));</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>(<a class="code hl_function" href="#gaa61b2ac6a14357ef0499a107b293edd9">wc_SrpSetPassword</a>(&amp;srp, password, passwordSize) != 0)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Error setting password</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ga72b7e47afb9f716247d22c432480b226">wc_SrpTerm</a>(&amp;srp);</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gae8584f826660880783a9603579f856af" title="Initializes the Srp struct for usage.">wc_SrpInit</a> </dd>
<dd>
<a class="el" href="#ga7acf63aa2c1a1e2cf9cc1837b2b92ab0" title="Sets the username. This function MUST be called after wc_SrpInit.">wc_SrpSetUsername</a> </dd>
<dd>
<a class="el" href="#ga20edf7d124ae9ac9b8011c8171f46015" title="Sets the srp parameters based on the username.. Must be called after wc_SrpSetUsername.">wc_SrpSetParams</a> </dd></dl>

</div>
</div>
<a id="ga30a3f45c5d54d58a491e8054a8147ed0" name="ga30a3f45c5d54d58a491e8054a8147ed0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga30a3f45c5d54d58a491e8054a8147ed0">&#9670;&#160;</a></span>wc_SrpSetPrivate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_SrpSetPrivate </td>
          <td>(</td>
          <td class="paramtype">Srp *</td>          <td class="paramname"><span class="paramname"><em>srp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>priv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>size</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the private ephemeral value. The private ephemeral value is known as: a at the client side. a = random() b at the server side. b = random() This function is handy for unit test cases or if the developer wants to use an external random source to set the ephemeral value. This function MAY be called before wc_SrpGetPublic. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Success </dd>
<dd>
BAD_FUNC_ARG Returned if srp, private, or size is null. </dd>
<dd>
SRP_CALL_ORDER_E Returned if wc_SrpSetPrivate is called out of order. </dd>
<dd>
&lt;0 Error</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srp</td><td>the Srp structure. </td></tr>
    <tr><td class="paramname">priv</td><td>the ephemeral value. </td></tr>
    <tr><td class="paramname">size</td><td>the private size in bytes.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Srp srp;</div>
<div class="line"><span class="keywordtype">byte</span> username[] = <span class="stringliteral">&quot;user&quot;</span>;</div>
<div class="line">word32 usernameSize = 4;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">byte</span> N[] = { }; <span class="comment">// Contents of byte array N</span></div>
<div class="line"><span class="keywordtype">byte</span> g[] = { }; <span class="comment">// Contents of byte array g</span></div>
<div class="line"><span class="keywordtype">byte</span> salt[] = { }; <span class="comment">// Contents of byte array salt</span></div>
<div class="line"><span class="keywordtype">byte</span> verifier = { }; <span class="comment">// Contents of some verifier</span></div>
<div class="line"><a class="code hl_function" href="#gae8584f826660880783a9603579f856af">wc_SrpInit</a>(&amp;srp, SRP_TYPE_SHA, SRP_SERVER_SIDE);</div>
<div class="line"><a class="code hl_function" href="#ga7acf63aa2c1a1e2cf9cc1837b2b92ab0">wc_SrpSetUsername</a>(&amp;srp, username, usernameSize);</div>
<div class="line"><a class="code hl_function" href="#ga20edf7d124ae9ac9b8011c8171f46015">wc_SrpSetParams</a>(&amp;srp, N, <span class="keyword">sizeof</span>(N), g, <span class="keyword">sizeof</span>(g), salt, <span class="keyword">sizeof</span>(salt))</div>
<div class="line"><a class="code hl_function" href="#ga5f9fa3b0ab92c78139534a1338f27f48">wc_SrpSetVerifier</a>(&amp;srp, verifier, <span class="keyword">sizeof</span>(verifier))</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">byte</span> <a class="code hl_variable" href="random_8h.html#ac5f0c3220b340f4f78d34bca64c6c699">b</a>[] = { }; <span class="comment">// Some ephemeral value</span></div>
<div class="line"><span class="keywordflow">if</span>( <a class="code hl_function" href="#ga30a3f45c5d54d58a491e8054a8147ed0">wc_SrpSetPrivate</a>(&amp;srp, <a class="code hl_variable" href="random_8h.html#ac5f0c3220b340f4f78d34bca64c6c699">b</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="random_8h.html#ac5f0c3220b340f4f78d34bca64c6c699">b</a>)) != 0)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Error setting private ephemeral</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ga72b7e47afb9f716247d22c432480b226">wc_SrpTerm</a>(&amp;srp);</div>
<div class="ttc" id="agroup__SRP_html_ga30a3f45c5d54d58a491e8054a8147ed0"><div class="ttname"><a href="#ga30a3f45c5d54d58a491e8054a8147ed0">wc_SrpSetPrivate</a></div><div class="ttdeci">int wc_SrpSetPrivate(Srp *srp, const byte *priv, word32 size)</div><div class="ttdoc">Sets the private ephemeral value. The private ephemeral value is known as: a at the client side....</div></div>
<div class="ttc" id="arandom_8h_html_ac5f0c3220b340f4f78d34bca64c6c699"><div class="ttname"><a href="random_8h.html#ac5f0c3220b340f4f78d34bca64c6c699">b</a></div><div class="ttdeci">WC_RNG byte * b</div><div class="ttdef"><b>Definition</b> random.h:210</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga355d15b75810986f22e904ca6dc92e6a" title="Gets the public ephemeral value. The public ephemeral value is known as: A at the client side....">wc_SrpGetPublic</a> </dd></dl>

</div>
</div>
<a id="ga7acf63aa2c1a1e2cf9cc1837b2b92ab0" name="ga7acf63aa2c1a1e2cf9cc1837b2b92ab0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7acf63aa2c1a1e2cf9cc1837b2b92ab0">&#9670;&#160;</a></span>wc_SrpSetUsername()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_SrpSetUsername </td>
          <td>(</td>
          <td class="paramtype">Srp *</td>          <td class="paramname"><span class="paramname"><em>srp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>username</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>size</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the username. This function MUST be called after wc_SrpInit. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Username set successfully. </dd>
<dd>
BAD_FUNC_ARG: Return if srp or username is null. </dd>
<dd>
MEMORY_E: Returns if there is an issue allocating memory for srp-&gt;user </dd>
<dd>
&lt; 0: Error.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srp</td><td>the Srp structure. </td></tr>
    <tr><td class="paramname">username</td><td>the buffer containing the username. </td></tr>
    <tr><td class="paramname">size</td><td>the username size in bytes</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Srp srp;</div>
<div class="line"><span class="keywordtype">byte</span> username[] = <span class="stringliteral">&quot;user&quot;</span>;</div>
<div class="line">word32 usernameSize = 4;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#gae8584f826660880783a9603579f856af">wc_SrpInit</a>(&amp;srp, SRP_TYPE_SHA, SRP_CLIENT_SIDE);</div>
<div class="line"><span class="keywordflow">if</span>(<a class="code hl_function" href="#ga7acf63aa2c1a1e2cf9cc1837b2b92ab0">wc_SrpSetUsername</a>(&amp;srp, username, usernameSize) != 0)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Error occurred setting username.</span></div>
<div class="line">}</div>
<div class="line"><a class="code hl_function" href="#ga72b7e47afb9f716247d22c432480b226">wc_SrpTerm</a>(&amp;srp);</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gae8584f826660880783a9603579f856af" title="Initializes the Srp struct for usage.">wc_SrpInit</a> </dd>
<dd>
<a class="el" href="#ga20edf7d124ae9ac9b8011c8171f46015" title="Sets the srp parameters based on the username.. Must be called after wc_SrpSetUsername.">wc_SrpSetParams</a> </dd>
<dd>
<a class="el" href="#ga72b7e47afb9f716247d22c432480b226" title="Releases the Srp struct resources after usage.">wc_SrpTerm</a> </dd></dl>

</div>
</div>
<a id="ga5f9fa3b0ab92c78139534a1338f27f48" name="ga5f9fa3b0ab92c78139534a1338f27f48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5f9fa3b0ab92c78139534a1338f27f48">&#9670;&#160;</a></span>wc_SrpSetVerifier()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_SrpSetVerifier </td>
          <td>(</td>
          <td class="paramtype">Srp *</td>          <td class="paramname"><span class="paramname"><em>srp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>verifier</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>size</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the verifier. This function MUST be called after wc_SrpSetParams and is SERVER SIDE ONLY. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Success </dd>
<dd>
BAD_FUNC_ARG Returned if srp or verifier is null or srp-&gt;side is not SRP_SERVER_SIDE. </dd>
<dd>
&lt;0 Error</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srp</td><td>The Srp structure. </td></tr>
    <tr><td class="paramname">verifier</td><td>The structure containing the verifier. </td></tr>
    <tr><td class="paramname">size</td><td>The verifier size in bytes.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Srp srp;</div>
<div class="line"><span class="keywordtype">byte</span> username[] = <span class="stringliteral">&quot;user&quot;</span>;</div>
<div class="line">word32 usernameSize = 4;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">byte</span> N[] = { }; <span class="comment">// Contents of byte array N</span></div>
<div class="line"><span class="keywordtype">byte</span> g[] = { }; <span class="comment">// Contents of byte array g</span></div>
<div class="line"><span class="keywordtype">byte</span> salt[] = { }; <span class="comment">// Contents of byte array salt</span></div>
<div class="line"><a class="code hl_function" href="#gae8584f826660880783a9603579f856af">wc_SrpInit</a>(&amp;srp, SRP_TYPE_SHA, SRP_SERVER_SIDE);</div>
<div class="line"><a class="code hl_function" href="#ga7acf63aa2c1a1e2cf9cc1837b2b92ab0">wc_SrpSetUsername</a>(&amp;srp, username, usernameSize);</div>
<div class="line"><a class="code hl_function" href="#ga20edf7d124ae9ac9b8011c8171f46015">wc_SrpSetParams</a>(&amp;srp, N, <span class="keyword">sizeof</span>(N), g, <span class="keyword">sizeof</span>(g), salt, <span class="keyword">sizeof</span>(salt))</div>
<div class="line"><span class="keywordtype">byte</span> verifier[] = { }; <span class="comment">// Contents of some verifier</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>(<a class="code hl_function" href="#ga5f9fa3b0ab92c78139534a1338f27f48">wc_SrpSetVerifier</a>(&amp;srp, verifier, <span class="keyword">sizeof</span>(verifier)) != 0)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Error setting verifier</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ga72b7e47afb9f716247d22c432480b226">wc_SrpTerm</a>(&amp;srp);</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gae8584f826660880783a9603579f856af" title="Initializes the Srp struct for usage.">wc_SrpInit</a> </dd>
<dd>
<a class="el" href="#ga20edf7d124ae9ac9b8011c8171f46015" title="Sets the srp parameters based on the username.. Must be called after wc_SrpSetUsername.">wc_SrpSetParams</a> </dd>
<dd>
<a class="el" href="#ga2ac38c69fcf5b918c07858b9d2325d00" title="Gets the verifier. The client calculates the verifier with v = g ^ x % N. This function MAY be called...">wc_SrpGetVerifier</a> </dd></dl>

</div>
</div>
<a id="ga72b7e47afb9f716247d22c432480b226" name="ga72b7e47afb9f716247d22c432480b226"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga72b7e47afb9f716247d22c432480b226">&#9670;&#160;</a></span>wc_SrpTerm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wc_SrpTerm </td>
          <td>(</td>
          <td class="paramtype">Srp *</td>          <td class="paramname"><span class="paramname"><em>srp</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Releases the Srp struct resources after usage. </p>
<dl class="section return"><dt>Returns</dt><dd>none No returns.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srp</td><td>Pointer to the Srp structure to be terminated.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Srp srp;</div>
<div class="line"><a class="code hl_function" href="#gae8584f826660880783a9603579f856af">wc_SrpInit</a>(&amp;srp, SRP_TYPE_SHA, SRP_CLIENT_SIDE);</div>
<div class="line"><span class="comment">// Use srp</span></div>
<div class="line"><a class="code hl_function" href="#ga72b7e47afb9f716247d22c432480b226">wc_SrpTerm</a>(&amp;srp)</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gae8584f826660880783a9603579f856af" title="Initializes the Srp struct for usage.">wc_SrpInit</a> </dd></dl>

</div>
</div>
<a id="ga55c898aca55ea35235cddfdd628c2080" name="ga55c898aca55ea35235cddfdd628c2080"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga55c898aca55ea35235cddfdd628c2080">&#9670;&#160;</a></span>wc_SrpVerifyPeersProof()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_SrpVerifyPeersProof </td>
          <td>(</td>
          <td class="paramtype">Srp *</td>          <td class="paramname"><span class="paramname"><em>srp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>proof</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>size</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verifies the peers proof. This function MUST be called before wc_SrpGetSessionKey. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Success </dd>
<dd>
&lt;0 Error</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srp</td><td>the Srp structure. </td></tr>
    <tr><td class="paramname">proof</td><td>the peers proof. </td></tr>
    <tr><td class="paramname">size</td><td>the proof size in bytes.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Srp cli;</div>
<div class="line">Srp srv;</div>
<div class="line"><span class="keywordtype">byte</span> clientProof[SRP_MAX_DIGEST_SIZE];</div>
<div class="line">word32 clientProofSz = SRP_MAX_DIGEST_SIZE;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Initialize Srp following steps from previous examples</span></div>
<div class="line"><span class="comment">// First get the proof</span></div>
<div class="line"><a class="code hl_function" href="#gacf4349192069b647d6f5b34deab4f5ff">wc_SrpGetProof</a>(&amp;cli, clientProof, &amp;clientProofSz)</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="#ga55c898aca55ea35235cddfdd628c2080">wc_SrpVerifyPeersProof</a>(&amp;srv, clientProof, clientProofSz) != 0)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Error verifying proof</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__SRP_html_ga55c898aca55ea35235cddfdd628c2080"><div class="ttname"><a href="#ga55c898aca55ea35235cddfdd628c2080">wc_SrpVerifyPeersProof</a></div><div class="ttdeci">int wc_SrpVerifyPeersProof(Srp *srp, byte *proof, word32 size)</div><div class="ttdoc">Verifies the peers proof. This function MUST be called before wc_SrpGetSessionKey.</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd>wc_SrpGetSessionKey </dd>
<dd>
<a class="el" href="#gacf4349192069b647d6f5b34deab4f5ff" title="Gets the proof. This function MUST be called after wc_SrpComputeKey.">wc_SrpGetProof</a> </dd>
<dd>
<a class="el" href="#ga72b7e47afb9f716247d22c432480b226" title="Releases the Srp struct resources after usage.">wc_SrpTerm</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
