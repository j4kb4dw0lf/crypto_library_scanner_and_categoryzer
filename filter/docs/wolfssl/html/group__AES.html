<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>My Project: Algorithms - AES</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="wolfssl_logo" style="width: 150px; height: 100px; display: inline-block;"><img alt="Logo" src="../images/wolfssl_logo.png" style="width: 150px; height: 100px;"/></div>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Algorithms - AES </div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gad52b440a630fb94e4250a37b7682ab3b" id="r_gad52b440a630fb94e4250a37b7682ab3b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gad52b440a630fb94e4250a37b7682ab3b">wc_AesSetKey</a> (Aes *aes, const byte *key, word32 len, const byte *iv, int dir)</td></tr>
<tr class="memdesc:gad52b440a630fb94e4250a37b7682ab3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function initializes an AES structure by setting the key and then setting the initialization vector.  <br /></td></tr>
<tr class="memitem:ga58d80e002c87e2d5d1c8b01f0a7156fc" id="r_ga58d80e002c87e2d5d1c8b01f0a7156fc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga58d80e002c87e2d5d1c8b01f0a7156fc">wc_AesSetIV</a> (Aes *aes, const byte *iv)</td></tr>
<tr class="memdesc:ga58d80e002c87e2d5d1c8b01f0a7156fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sets the initialization vector for a particular AES object. The AES object should be initialized before calling this function.  <br /></td></tr>
<tr class="memitem:gaed1e38cd30d917165183fc68dd4b218b" id="r_gaed1e38cd30d917165183fc68dd4b218b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaed1e38cd30d917165183fc68dd4b218b">wc_AesCbcEncrypt</a> (Aes *aes, byte *out, const byte *in, word32 sz)</td></tr>
<tr class="memdesc:gaed1e38cd30d917165183fc68dd4b218b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypts a plaintext message from the input buffer in, and places the resulting cipher text in the output buffer out using cipher block chaining with AES. This function requires that the AES object has been initialized by calling AesSetKey before a message is able to be encrypted. This function assumes that the input message is AES block length aligned, and expects the input length to be a multiple of the block length, which will optionally be checked and enforced if WOLFSSL_AES_CBC_LENGTH_CHECKS is defined in the build configuration. In order to assure block-multiple input, PKCS#7 style padding should be added beforehand. This differs from the OpenSSL AES-CBC methods which add the padding for you. To make the wolfSSL and corresponding OpenSSL functions interoperate, one should specify the -nopad option in the OpenSSL command line function so that it behaves like the wolfSSL AesCbcEncrypt method and does not add extra padding during encryption.  <br /></td></tr>
<tr class="memitem:ga35713fdddf94f25ca7bd1a60249b041c" id="r_ga35713fdddf94f25ca7bd1a60249b041c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga35713fdddf94f25ca7bd1a60249b041c">wc_AesCbcDecrypt</a> (Aes *aes, byte *out, const byte *in, word32 sz)</td></tr>
<tr class="memdesc:ga35713fdddf94f25ca7bd1a60249b041c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypts a cipher from the input buffer in, and places the resulting plain text in the output buffer out using cipher block chaining with AES. This function requires that the AES structure has been initialized by calling AesSetKey before a message is able to be decrypted. This function assumes that the original message was AES block length aligned, and expects the input length to be a multiple of the block length, which will optionally be checked and enforced if WOLFSSL_AES_CBC_LENGTH_CHECKS is defined in the build configuration. This differs from the OpenSSL AES-CBC methods, which add PKCS#7 padding automatically, and so do not require block-multiple input. To make the wolfSSL function and equivalent OpenSSL functions interoperate, one should specify the -nopad option in the OpenSSL command line function so that it behaves like the wolfSSL AesCbcEncrypt method and does not create errors during decryption.  <br /></td></tr>
<tr class="memitem:gabe7557f4867c7d8f84cecaa000fe43a1" id="r_gabe7557f4867c7d8f84cecaa000fe43a1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gabe7557f4867c7d8f84cecaa000fe43a1">wc_AesCtrEncrypt</a> (Aes *aes, byte *out, const byte *in, word32 sz)</td></tr>
<tr class="memdesc:gabe7557f4867c7d8f84cecaa000fe43a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypts/Decrypts a message from the input buffer in, and places the resulting cipher text in the output buffer out using CTR mode with AES. This function is only enabled if WOLFSSL_AES_COUNTER is enabled at compile time. The AES structure should be initialized through AesSetKey before calling this function. Note that this function is used for both decryption and encryption. <em>NOTE:</em> Regarding using same API for encryption and decryption. User should differentiate between Aes structures for encrypt/decrypt.  <br /></td></tr>
<tr class="memitem:gadf98e960a0f388486fed8b4b576c7514" id="r_gadf98e960a0f388486fed8b4b576c7514"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gadf98e960a0f388486fed8b4b576c7514">wc_AesEncryptDirect</a> (Aes *aes, byte *out, const byte *in)</td></tr>
<tr class="memdesc:gadf98e960a0f388486fed8b4b576c7514"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is a one-block encrypt of the input block, in, into the output block, out. It uses the key of the provided AES structure, which should be initialized with wc_AesSetKey before calling this function. wc_AesSetKey should have been called with the iv set to NULL. This is only enabled if the configure option WOLFSSL_AES_DIRECT is enabled. <b>Warning:</b> In nearly all use cases ECB mode is considered to be less secure. Please avoid using ECB API’s directly whenever possible.  <br /></td></tr>
<tr class="memitem:gac03c7c2d8fc31cb4bc4d26d8dcb10fd2" id="r_gac03c7c2d8fc31cb4bc4d26d8dcb10fd2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gac03c7c2d8fc31cb4bc4d26d8dcb10fd2">wc_AesDecryptDirect</a> (Aes *aes, byte *out, const byte *in)</td></tr>
<tr class="memdesc:gac03c7c2d8fc31cb4bc4d26d8dcb10fd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is a one-block decrypt of the input block, in, into the output block, out. It uses the key of the provided AES structure, which should be initialized with wc_AesSetKey before calling this function. wc_AesSetKey should have been called with the iv set to NULL. This is only enabled if the configure option WOLFSSL_AES_DIRECT is enabled. <b>Warning:</b> In nearly all use cases ECB mode is considered to be less secure. Please avoid using ECB API’s directly whenever possible.  <br /></td></tr>
<tr class="memitem:gafc1e71615652e4870a7c3de627be5e9b" id="r_gafc1e71615652e4870a7c3de627be5e9b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gafc1e71615652e4870a7c3de627be5e9b">wc_AesSetKeyDirect</a> (Aes *aes, const byte *key, word32 len, const byte *iv, int dir)</td></tr>
<tr class="memdesc:gafc1e71615652e4870a7c3de627be5e9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is used to set the AES keys for CTR mode with AES. It initializes an AES object with the given key, iv (initialization vector), and encryption dir (direction). It is only enabled if the configure option WOLFSSL_AES_DIRECT is enabled. Currently wc_AesSetKeyDirect uses wc_AesSetKey internally. <b>Warning:</b> In nearly all use cases ECB mode is considered to be less secure. Please avoid using ECB API’s directly whenever possible.  <br /></td></tr>
<tr class="memitem:ga4d88b09e44908284d49ecbbfe389816b" id="r_ga4d88b09e44908284d49ecbbfe389816b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga4d88b09e44908284d49ecbbfe389816b">wc_AesGcmSetKey</a> (Aes *aes, const byte *key, word32 len)</td></tr>
<tr class="memdesc:ga4d88b09e44908284d49ecbbfe389816b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is used to set the key for AES GCM (Galois/Counter Mode). It initializes an AES object with the given key. It is only enabled if the configure option HAVE_AESGCM is enabled at compile time.  <br /></td></tr>
<tr class="memitem:ga8ca2509cefd6a9d4b446c1ee38140fe1" id="r_ga8ca2509cefd6a9d4b446c1ee38140fe1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga8ca2509cefd6a9d4b446c1ee38140fe1">wc_AesGcmEncrypt</a> (Aes *aes, byte *out, const byte *in, word32 sz, const byte *iv, word32 ivSz, byte *authTag, word32 authTagSz, const byte *authIn, word32 authInSz)</td></tr>
<tr class="memdesc:ga8ca2509cefd6a9d4b446c1ee38140fe1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function encrypts the input message, held in the buffer in, and stores the resulting cipher text in the output buffer out. It requires a new iv (initialization vector) for each call to encrypt. It also encodes the input authentication vector, authIn, into the authentication tag, authTag.  <br /></td></tr>
<tr class="memitem:ga3abce2439b7cf22adbf5c800a9b79d7d" id="r_ga3abce2439b7cf22adbf5c800a9b79d7d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga3abce2439b7cf22adbf5c800a9b79d7d">wc_AesGcmDecrypt</a> (Aes *aes, byte *out, const byte *in, word32 sz, const byte *iv, word32 ivSz, const byte *authTag, word32 authTagSz, const byte *authIn, word32 authInSz)</td></tr>
<tr class="memdesc:ga3abce2439b7cf22adbf5c800a9b79d7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function decrypts the input cipher text, held in the buffer in, and stores the resulting message text in the output buffer out. It also checks the input authentication vector, authIn, against the supplied authentication tag, authTag. If a nonzero error code is returned, the output data is undefined. However, callers must unconditionally zeroize the output buffer to guard against leakage of cleartext data.  <br /></td></tr>
<tr class="memitem:gae42e0250f7ec82cf1dce498d59b5f725" id="r_gae42e0250f7ec82cf1dce498d59b5f725"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gae42e0250f7ec82cf1dce498d59b5f725">wc_GmacSetKey</a> (Gmac *gmac, const byte *key, word32 len)</td></tr>
<tr class="memdesc:gae42e0250f7ec82cf1dce498d59b5f725"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function initializes and sets the key for a GMAC object to be used for Galois Message Authentication.  <br /></td></tr>
<tr class="memitem:gaeb328cdd7c9ff7433198a0c4b19416af" id="r_gaeb328cdd7c9ff7433198a0c4b19416af"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaeb328cdd7c9ff7433198a0c4b19416af">wc_GmacUpdate</a> (Gmac *gmac, const byte *iv, word32 ivSz, const byte *authIn, word32 authInSz, byte *authTag, word32 authTagSz)</td></tr>
<tr class="memdesc:gaeb328cdd7c9ff7433198a0c4b19416af"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function generates the Gmac hash of the authIn input and stores the result in the authTag buffer. After running wc_GmacUpdate, one should compare the generated authTag to a known authentication tag to verify the authenticity of a message.  <br /></td></tr>
<tr class="memitem:ga093c15adc447598d0a8def1676ee9939" id="r_ga093c15adc447598d0a8def1676ee9939"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga093c15adc447598d0a8def1676ee9939">wc_AesCcmSetKey</a> (Aes *aes, const byte *key, word32 keySz)</td></tr>
<tr class="memdesc:ga093c15adc447598d0a8def1676ee9939"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sets the key for an AES object using CCM (Counter with CBC-MAC). It takes a pointer to an AES structure and initializes it with supplied key.  <br /></td></tr>
<tr class="memitem:ga5742b8232c72e07262d8daff5b6da21c" id="r_ga5742b8232c72e07262d8daff5b6da21c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga5742b8232c72e07262d8daff5b6da21c">wc_AesCcmEncrypt</a> (Aes *aes, byte *out, const byte *in, word32 inSz, const byte *nonce, word32 nonceSz, byte *authTag, word32 authTagSz, const byte *authIn, word32 authInSz)</td></tr>
<tr class="memdesc:ga5742b8232c72e07262d8daff5b6da21c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function encrypts the input message, in, into the output buffer, out, using CCM (Counter with CBC-MAC). It subsequently calculates and stores the authorization tag, authTag, from the authIn input.  <br /></td></tr>
<tr class="memitem:ga74f0c4e47cecadaf02c1e5a756fcb0e2" id="r_ga74f0c4e47cecadaf02c1e5a756fcb0e2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga74f0c4e47cecadaf02c1e5a756fcb0e2">wc_AesCcmDecrypt</a> (Aes *aes, byte *out, const byte *in, word32 inSz, const byte *nonce, word32 nonceSz, const byte *authTag, word32 authTagSz, const byte *authIn, word32 authInSz)</td></tr>
<tr class="memdesc:ga74f0c4e47cecadaf02c1e5a756fcb0e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function decrypts the input cipher text, in, into the output buffer, out, using CCM (Counter with CBC-MAC). It subsequently calculates the authorization tag, authTag, from the authIn input. If a nonzero error code is returned, the output data is undefined. However, callers must unconditionally zeroize the output buffer to guard against leakage of cleartext data.  <br /></td></tr>
<tr class="memitem:ga01b5393003225bd3ed93c5e3bb73a184" id="r_ga01b5393003225bd3ed93c5e3bb73a184"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga01b5393003225bd3ed93c5e3bb73a184">wc_AesXtsInit</a> (XtsAes *aes, void *heap, int devId)</td></tr>
<tr class="memdesc:ga01b5393003225bd3ed93c5e3bb73a184"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is to initialize an AES-XTS context. It is up to user to call wc_AesXtsFree on aes key when done.  <br /></td></tr>
<tr class="memitem:ga8b89849095c6d10b248dd2ccf6dff5e7" id="r_ga8b89849095c6d10b248dd2ccf6dff5e7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga8b89849095c6d10b248dd2ccf6dff5e7">wc_AesXtsSetKeyNoInit</a> (XtsAes *aes, const byte *key, word32 len, int dir)</td></tr>
<tr class="memdesc:ga8b89849095c6d10b248dd2ccf6dff5e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is to help with setting keys to correct encrypt or decrypt type, after first calling <a class="el" href="#ga01b5393003225bd3ed93c5e3bb73a184" title="This is to initialize an AES-XTS context. It is up to user to call wc_AesXtsFree on aes key when done...">wc_AesXtsInit()</a>. It is up to user to call wc_AesXtsFree on aes key when done.  <br /></td></tr>
<tr class="memitem:gaa1a5c32613382ca969ef11b875752f51" id="r_gaa1a5c32613382ca969ef11b875752f51"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa1a5c32613382ca969ef11b875752f51">wc_AesXtsSetKey</a> (XtsAes *aes, const byte *key, word32 len, int dir, void *heap, int devId)</td></tr>
<tr class="memdesc:gaa1a5c32613382ca969ef11b875752f51"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is to help with setting keys to correct encrypt or decrypt type. It is up to user to call wc_AesXtsFree on aes key when done.  <br /></td></tr>
<tr class="memitem:gaf06ea9dce97f3bda7d1ce373c6a917c3" id="r_gaf06ea9dce97f3bda7d1ce373c6a917c3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaf06ea9dce97f3bda7d1ce373c6a917c3">wc_AesXtsEncryptSector</a> (XtsAes *aes, byte *out, const byte *in, word32 sz, word64 sector)</td></tr>
<tr class="memdesc:gaf06ea9dce97f3bda7d1ce373c6a917c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Same process as wc_AesXtsEncrypt but uses a word64 type as the tweak value instead of a byte array. This just converts the word64 to a byte array and calls wc_AesXtsEncrypt.  <br /></td></tr>
<tr class="memitem:ga656aa1de00e3d73649726a9303ac863d" id="r_ga656aa1de00e3d73649726a9303ac863d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga656aa1de00e3d73649726a9303ac863d">wc_AesXtsDecryptSector</a> (XtsAes *aes, byte *out, const byte *in, word32 sz, word64 sector)</td></tr>
<tr class="memdesc:ga656aa1de00e3d73649726a9303ac863d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Same process as wc_AesXtsDecrypt but uses a word64 type as the tweak value instead of a byte array. This just converts the word64 to a byte array.  <br /></td></tr>
<tr class="memitem:ga0372af5fdae94d196c977e28c3e35a81" id="r_ga0372af5fdae94d196c977e28c3e35a81"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga0372af5fdae94d196c977e28c3e35a81">wc_AesXtsEncrypt</a> (XtsAes *aes, byte *out, const byte *in, word32 sz, const byte *i, word32 iSz)</td></tr>
<tr class="memdesc:ga0372af5fdae94d196c977e28c3e35a81"><td class="mdescLeft">&#160;</td><td class="mdescRight">AES with XTS mode. (XTS) XEX encryption with Tweak and cipher text Stealing.  <br /></td></tr>
<tr class="memitem:gad3aea81076e797ce28aa77e9cd610779" id="r_gad3aea81076e797ce28aa77e9cd610779"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gad3aea81076e797ce28aa77e9cd610779">wc_AesXtsDecrypt</a> (XtsAes *aes, byte *out, const byte *in, word32 sz, const byte *i, word32 iSz)</td></tr>
<tr class="memdesc:gad3aea81076e797ce28aa77e9cd610779"><td class="mdescLeft">&#160;</td><td class="mdescRight">Same process as encryption but Aes key is AES_DECRYPTION type.  <br /></td></tr>
<tr class="memitem:ga8d63d909dd415e2954daec23cb4851ab" id="r_ga8d63d909dd415e2954daec23cb4851ab"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga8d63d909dd415e2954daec23cb4851ab">wc_AesXtsFree</a> (XtsAes *aes)</td></tr>
<tr class="memdesc:ga8d63d909dd415e2954daec23cb4851ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is to free up any resources used by the XtsAes structure.  <br /></td></tr>
<tr class="memitem:ga430f0c344e8e8132bceec748483212c1" id="r_ga430f0c344e8e8132bceec748483212c1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga430f0c344e8e8132bceec748483212c1">wc_AesInit</a> (Aes *aes, void *heap, int devId)</td></tr>
<tr class="memdesc:ga430f0c344e8e8132bceec748483212c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize Aes structure. Sets heap hint to be used and ID for use with async hardware. It is up to the user to call wc_AesFree on the Aes structure when done.  <br /></td></tr>
<tr class="memitem:ga976e1b14c12dca0a43aebe9f70339739" id="r_ga976e1b14c12dca0a43aebe9f70339739"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga976e1b14c12dca0a43aebe9f70339739">wc_AesFree</a> (Aes *aes)</td></tr>
<tr class="memdesc:ga976e1b14c12dca0a43aebe9f70339739"><td class="mdescLeft">&#160;</td><td class="mdescRight">free resources associated with the Aes structure when applicable. Internally may sometimes be a no-op but still recommended to call in all cases as a general best-practice (IE if application code is ported for use on new environments where the call is applicable).  <br /></td></tr>
<tr class="memitem:ga92c53cbd730d329fe59a15b372495d3a" id="r_ga92c53cbd730d329fe59a15b372495d3a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga92c53cbd730d329fe59a15b372495d3a">wc_AesCfbEncrypt</a> (Aes *aes, byte *out, const byte *in, word32 sz)</td></tr>
<tr class="memdesc:ga92c53cbd730d329fe59a15b372495d3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">AES with CFB mode.  <br /></td></tr>
<tr class="memitem:ga311d4f8105b7f3b1d5a3b46fca440b6d" id="r_ga311d4f8105b7f3b1d5a3b46fca440b6d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga311d4f8105b7f3b1d5a3b46fca440b6d">wc_AesCfbDecrypt</a> (Aes *aes, byte *out, const byte *in, word32 sz)</td></tr>
<tr class="memdesc:ga311d4f8105b7f3b1d5a3b46fca440b6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">AES with CFB mode.  <br /></td></tr>
<tr class="memitem:ga49ecb8fde33e33ad2287e4d28b74a5c7" id="r_ga49ecb8fde33e33ad2287e4d28b74a5c7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga49ecb8fde33e33ad2287e4d28b74a5c7">wc_AesSivEncrypt</a> (const byte *key, word32 keySz, const byte *assoc, word32 assocSz, const byte *nonce, word32 nonceSz, const byte *in, word32 inSz, byte *siv, byte *out)</td></tr>
<tr class="memdesc:ga49ecb8fde33e33ad2287e4d28b74a5c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function performs SIV (synthetic initialization vector) encryption as described in RFC 5297.  <br /></td></tr>
<tr class="memitem:ga91be158d881bb0c56fa3a03660917da6" id="r_ga91be158d881bb0c56fa3a03660917da6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga91be158d881bb0c56fa3a03660917da6">wc_AesSivDecrypt</a> (const byte *key, word32 keySz, const byte *assoc, word32 assocSz, const byte *nonce, word32 nonceSz, const byte *in, word32 inSz, byte *siv, byte *out)</td></tr>
<tr class="memdesc:ga91be158d881bb0c56fa3a03660917da6"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function performs SIV (synthetic initialization vector) decryption as described in RFC 5297. If a nonzero error code is returned, the output data is undefined. However, callers must unconditionally zeroize the output buffer to guard against leakage of cleartext data.  <br /></td></tr>
<tr class="memitem:ga0f183ab13031accc6325eba552c113e1" id="r_ga0f183ab13031accc6325eba552c113e1"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga0f183ab13031accc6325eba552c113e1">wc_AesEaxEncryptAuth</a> (const byte *key, word32 keySz, byte *out, const byte *in, word32 inSz, const byte *nonce, word32 nonceSz, byte *authTag, word32 authTagSz, const byte *authIn, word32 authInSz)</td></tr>
<tr class="memdesc:ga0f183ab13031accc6325eba552c113e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function performs AES EAX encryption and authentication as described in "EAX: A Conventional Authenticated-Encryption Mode" (<a href="https://eprint.iacr.org/2003/069">https://eprint.iacr.org/2003/069</a>). It is a "one-shot" API that performs all encryption and authentication operations in one function call.  <br /></td></tr>
<tr class="memitem:ga06d085c91a969020b4d6977dc6d08ef2" id="r_ga06d085c91a969020b4d6977dc6d08ef2"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga06d085c91a969020b4d6977dc6d08ef2">wc_AesEaxDecryptAuth</a> (const byte *key, word32 keySz, byte *out, const byte *in, word32 inSz, const byte *nonce, word32 nonceSz, const byte *authTag, word32 authTagSz, const byte *authIn, word32 authInSz)</td></tr>
<tr class="memdesc:ga06d085c91a969020b4d6977dc6d08ef2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function performs AES EAX decryption and authentication as described in "EAX: A Conventional Authenticated-Encryption Mode" (<a href="https://eprint.iacr.org/2003/069">https://eprint.iacr.org/2003/069</a>). It is a "one-shot" API that performs all decryption and authentication operations in one function call. If a nonzero error code is returned, the output data is undefined. However, callers must unconditionally zeroize the output buffer to guard against leakage of cleartext data.  <br /></td></tr>
<tr class="memitem:ga828f06a8a61fcaae275559f64f9bcf34" id="r_ga828f06a8a61fcaae275559f64f9bcf34"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga828f06a8a61fcaae275559f64f9bcf34">wc_AesEaxInit</a> (AesEax *eax, const byte *key, word32 keySz, const byte *nonce, word32 nonceSz, const byte *authIn, word32 authInSz)</td></tr>
<tr class="memdesc:ga828f06a8a61fcaae275559f64f9bcf34"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function initializes an AesEax object for use in authenticated encryption or decryption. This function must be called on an AesEax object before using it with any of the AES EAX incremental API functions. It does not need to be called if using the one-shot EAX API functions. All AesEax instances initialized with this function need to be freed with a call to <a class="el" href="#gad4d997173c1afc8abba8140c635b0ca0" title="This frees up any resources, specifically keys, used by the Aes instance inside the AesEax wrapper st...">wc_AesEaxFree()</a> when done using the instance.  <br /></td></tr>
<tr class="memitem:ga22db03a2c23b9a24eef4191391c85147" id="r_ga22db03a2c23b9a24eef4191391c85147"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga22db03a2c23b9a24eef4191391c85147">wc_AesEaxEncryptUpdate</a> (AesEax *eax, byte *out, const byte *in, word32 inSz, const byte *authIn, word32 authInSz)</td></tr>
<tr class="memdesc:ga22db03a2c23b9a24eef4191391c85147"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function uses AES EAX to encrypt input data, and optionally, add more input data to the authentication stream. <code>eax</code> must have been previously initialized with a call to <a class="el" href="#ga828f06a8a61fcaae275559f64f9bcf34">wc_AesEaxInit</a>.  <br /></td></tr>
<tr class="memitem:ga43fa6d7e6e0f22bd0c10fc15abfb054b" id="r_ga43fa6d7e6e0f22bd0c10fc15abfb054b"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga43fa6d7e6e0f22bd0c10fc15abfb054b">wc_AesEaxDecryptUpdate</a> (AesEax *eax, byte *out, const byte *in, word32 inSz, const byte *authIn, word32 authInSz)</td></tr>
<tr class="memdesc:ga43fa6d7e6e0f22bd0c10fc15abfb054b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function uses AES EAX to decrypt input data, and optionally, add more input data to the authentication stream. <code>eax</code> must have been previously initialized with a call to <a class="el" href="#ga828f06a8a61fcaae275559f64f9bcf34">wc_AesEaxInit</a>.  <br /></td></tr>
<tr class="memitem:ga8420179c682c323a07913b5172965478" id="r_ga8420179c682c323a07913b5172965478"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga8420179c682c323a07913b5172965478">wc_AesEaxAuthDataUpdate</a> (AesEax *eax, const byte *authIn, word32 authInSz)</td></tr>
<tr class="memdesc:ga8420179c682c323a07913b5172965478"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function adds input data to the authentication stream. <code>eax</code> must have been previously initialized with a call to <a class="el" href="#ga828f06a8a61fcaae275559f64f9bcf34">wc_AesEaxInit</a>.  <br /></td></tr>
<tr class="memitem:ga7142a20798bd52058da5a89ab2c41a91" id="r_ga7142a20798bd52058da5a89ab2c41a91"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga7142a20798bd52058da5a89ab2c41a91">wc_AesEaxEncryptFinal</a> (AesEax *eax, byte *authTag, word32 authTagSz)</td></tr>
<tr class="memdesc:ga7142a20798bd52058da5a89ab2c41a91"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function finalizes the encrypt AEAD operation, producing an auth tag over the current authentication stream. <code>eax</code> must have been previously initialized with a call to <a class="el" href="#ga828f06a8a61fcaae275559f64f9bcf34">wc_AesEaxInit</a>. When done using the <code>AesEax</code> context structure, make sure to free it using <a class="el" href="#gad4d997173c1afc8abba8140c635b0ca0">wc_AesEaxFree</a>.  <br /></td></tr>
<tr class="memitem:gaad5366b06f2e8b07674d06451bf08082" id="r_gaad5366b06f2e8b07674d06451bf08082"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaad5366b06f2e8b07674d06451bf08082">wc_AesEaxDecryptFinal</a> (AesEax *eax, const byte *authIn, word32 authInSz)</td></tr>
<tr class="memdesc:gaad5366b06f2e8b07674d06451bf08082"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function finalizes the decrypt AEAD operation, finalizing the auth tag computation and checking it for validity against the user supplied tag. <code>eax</code> must have been previously initialized with a call to <a class="el" href="#ga828f06a8a61fcaae275559f64f9bcf34">wc_AesEaxInit</a>. When done using the <code>AesEax</code> context structure, make sure to free it using <a class="el" href="#gad4d997173c1afc8abba8140c635b0ca0">wc_AesEaxFree</a>.  <br /></td></tr>
<tr class="memitem:gad4d997173c1afc8abba8140c635b0ca0" id="r_gad4d997173c1afc8abba8140c635b0ca0"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gad4d997173c1afc8abba8140c635b0ca0">wc_AesEaxFree</a> (AesEax *eax)</td></tr>
<tr class="memdesc:gad4d997173c1afc8abba8140c635b0ca0"><td class="mdescLeft">&#160;</td><td class="mdescRight">This frees up any resources, specifically keys, used by the Aes instance inside the AesEax wrapper struct. It should be called on the AesEax struct after it has been initialized with wc_AesEaxInit, and all desired EAX operations are complete.  <br /></td></tr>
<tr class="memitem:gaba13cae6b85c2ea43cfbd8b9100ab05e" id="r_gaba13cae6b85c2ea43cfbd8b9100ab05e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaba13cae6b85c2ea43cfbd8b9100ab05e">wc_AesCtsEncrypt</a> (const byte *key, word32 keySz, byte *out, const byte *in, word32 inSz, const byte *iv)</td></tr>
<tr class="memdesc:gaba13cae6b85c2ea43cfbd8b9100ab05e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function performs AES encryption using Ciphertext Stealing (CTS) mode. It is a one-shot API that handles all operations in a single call.  <br /></td></tr>
<tr class="memitem:ga4a2a1f1c4e587134fdcf03ba1faf2e4b" id="r_ga4a2a1f1c4e587134fdcf03ba1faf2e4b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga4a2a1f1c4e587134fdcf03ba1faf2e4b">wc_AesCtsDecrypt</a> (const byte *key, word32 keySz, byte *out, const byte *in, word32 inSz, const byte *iv)</td></tr>
<tr class="memdesc:ga4a2a1f1c4e587134fdcf03ba1faf2e4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function performs AES decryption using Ciphertext Stealing (CTS) mode. It is a one-shot API that handles all operations in a single call.  <br /></td></tr>
<tr class="memitem:gaed7ca64828d8429b7c140941561c57a5" id="r_gaed7ca64828d8429b7c140941561c57a5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaed7ca64828d8429b7c140941561c57a5">wc_AesCtsEncryptUpdate</a> (Aes *aes, byte *out, word32 *outSz, const byte *in, word32 inSz)</td></tr>
<tr class="memdesc:gaed7ca64828d8429b7c140941561c57a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function performs an update step of the AES CTS encryption. It processes a chunk of plaintext and stores intermediate data.  <br /></td></tr>
<tr class="memitem:gac64d26302b62805366927f15fc36daef" id="r_gac64d26302b62805366927f15fc36daef"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gac64d26302b62805366927f15fc36daef">wc_AesCtsEncryptFinal</a> (Aes *aes, byte *out, word32 *outSz)</td></tr>
<tr class="memdesc:gac64d26302b62805366927f15fc36daef"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function finalizes the AES CTS encryption operation. It processes any remaining plaintext and completes the encryption.  <br /></td></tr>
<tr class="memitem:gaf192cb665cccec364e60be89e5cd4b5b" id="r_gaf192cb665cccec364e60be89e5cd4b5b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaf192cb665cccec364e60be89e5cd4b5b">wc_AesCtsDecryptUpdate</a> (Aes *aes, byte *out, word32 *outSz, const byte *in, word32 inSz)</td></tr>
<tr class="memdesc:gaf192cb665cccec364e60be89e5cd4b5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function performs an update step of the AES CTS decryption. It processes a chunk of ciphertext and stores intermediate data.  <br /></td></tr>
<tr class="memitem:gaa1f9afc8880044a57b9e404653581871" id="r_gaa1f9afc8880044a57b9e404653581871"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa1f9afc8880044a57b9e404653581871">wc_AesCtsDecryptFinal</a> (Aes *aes, byte *out, word32 *outSz)</td></tr>
<tr class="memdesc:gaa1f9afc8880044a57b9e404653581871"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function finalizes the AES CTS decryption operation. It processes any remaining ciphertext and completes the decryption.  <br /></td></tr>
<tr class="memitem:ga7f27a5f5f50fe1da277fafff27fa2173" id="r_ga7f27a5f5f50fe1da277fafff27fa2173"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga7f27a5f5f50fe1da277fafff27fa2173">wc_AesCbcDecryptWithKey</a> (byte *out, const byte *in, word32 inSz, const byte *key, word32 keySz, const byte *iv)</td></tr>
<tr class="memdesc:ga7f27a5f5f50fe1da277fafff27fa2173"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypts a cipher from the input buffer in, and places the resulting plain text in the output buffer out using cipher block chaining with AES. This function does not require an AES structure to be initialized. Instead, it takes in a key and an iv (initialization vector) and uses these to initialize an AES object and then decrypt the cipher text.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="ga35713fdddf94f25ca7bd1a60249b041c" name="ga35713fdddf94f25ca7bd1a60249b041c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga35713fdddf94f25ca7bd1a60249b041c">&#9670;&#160;</a></span>wc_AesCbcDecrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesCbcDecrypt </td>
          <td>(</td>
          <td class="paramtype">Aes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>sz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypts a cipher from the input buffer in, and places the resulting plain text in the output buffer out using cipher block chaining with AES. This function requires that the AES structure has been initialized by calling AesSetKey before a message is able to be decrypted. This function assumes that the original message was AES block length aligned, and expects the input length to be a multiple of the block length, which will optionally be checked and enforced if WOLFSSL_AES_CBC_LENGTH_CHECKS is defined in the build configuration. This differs from the OpenSSL AES-CBC methods, which add PKCS#7 padding automatically, and so do not require block-multiple input. To make the wolfSSL function and equivalent OpenSSL functions interoperate, one should specify the -nopad option in the OpenSSL command line function so that it behaves like the wolfSSL AesCbcEncrypt method and does not create errors during decryption. </p>
<dl class="section return"><dt>Returns</dt><dd>0 On successfully decrypting message. </dd>
<dd>
BAD_ALIGN_E may be returned on block align error. </dd>
<dd>
BAD_LENGTH_E will be returned if the input length isn't a multiple of the AES block length, when the library is built with WOLFSSL_AES_CBC_LENGTH_CHECKS.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>pointer to the AES object used to decrypt data. </td></tr>
    <tr><td class="paramname">out</td><td>pointer to the output buffer in which to store the plain text of the decrypted message. size must be a multiple of AES_BLOCK_LENGTH, padded if necessary </td></tr>
    <tr><td class="paramname">in</td><td>pointer to the input buffer containing cipher text to be decrypted. size must be a multiple of AES_BLOCK_LENGTH, padded if necessary </td></tr>
    <tr><td class="paramname">sz</td><td>size of input message.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Aes dec;</div>
<div class="line"><span class="keywordtype">int</span> ret = 0;</div>
<div class="line"><span class="comment">// initialize dec with wc_AesInit and wc_AesSetKey, using direction</span></div>
<div class="line"><span class="comment">// AES_DECRYPTION</span></div>
<div class="line"><span class="keywordtype">byte</span> cipher[AES_BLOCK_SIZE * n]; <span class="comment">// some multiple of 16 bytes</span></div>
<div class="line"><span class="comment">// fill cipher with cipher text</span></div>
<div class="line"><span class="keywordtype">byte</span> plain [AES_BLOCK_SIZE * n];</div>
<div class="line"><span class="keywordflow">if</span> ((ret = <a class="code hl_function" href="#ga35713fdddf94f25ca7bd1a60249b041c">wc_AesCbcDecrypt</a>(&amp;dec, plain, cipher, <span class="keyword">sizeof</span>(cipher))) != 0 ) {</div>
<div class="line"><span class="comment">// block align error</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__AES_html_ga35713fdddf94f25ca7bd1a60249b041c"><div class="ttname"><a href="#ga35713fdddf94f25ca7bd1a60249b041c">wc_AesCbcDecrypt</a></div><div class="ttdeci">int wc_AesCbcDecrypt(Aes *aes, byte *out, const byte *in, word32 sz)</div><div class="ttdoc">Decrypts a cipher from the input buffer in, and places the resulting plain text in the output buffer ...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga430f0c344e8e8132bceec748483212c1" title="Initialize Aes structure. Sets heap hint to be used and ID for use with async hardware....">wc_AesInit</a> </dd>
<dd>
<a class="el" href="#gad52b440a630fb94e4250a37b7682ab3b" title="This function initializes an AES structure by setting the key and then setting the initialization vec...">wc_AesSetKey</a> </dd>
<dd>
<a class="el" href="#gaed1e38cd30d917165183fc68dd4b218b" title="Encrypts a plaintext message from the input buffer in, and places the resulting cipher text in the ou...">wc_AesCbcEncrypt</a> </dd></dl>

</div>
</div>
<a id="ga7f27a5f5f50fe1da277fafff27fa2173" name="ga7f27a5f5f50fe1da277fafff27fa2173"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7f27a5f5f50fe1da277fafff27fa2173">&#9670;&#160;</a></span>wc_AesCbcDecryptWithKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesCbcDecryptWithKey </td>
          <td>(</td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>inSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>keySz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>iv</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypts a cipher from the input buffer in, and places the resulting plain text in the output buffer out using cipher block chaining with AES. This function does not require an AES structure to be initialized. Instead, it takes in a key and an iv (initialization vector) and uses these to initialize an AES object and then decrypt the cipher text. </p>
<dl class="section return"><dt>Returns</dt><dd>0 On successfully decrypting message </dd>
<dd>
BAD_ALIGN_E Returned on block align error </dd>
<dd>
BAD_FUNC_ARG Returned if key length is invalid or AES object is null during AesSetIV </dd>
<dd>
MEMORY_E Returned if WOLFSSL_SMALL_STACK is enabled and XMALLOC fails to instantiate an AES object.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">out</td><td>pointer to the output buffer in which to store the plain text of the decrypted message </td></tr>
    <tr><td class="paramname">in</td><td>pointer to the input buffer containing cipher text to be decrypted </td></tr>
    <tr><td class="paramname">inSz</td><td>size of input message </td></tr>
    <tr><td class="paramname">key</td><td>16, 24, or 32 byte secret key for decryption </td></tr>
    <tr><td class="paramname">keySz</td><td>size of key used for decryption</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> ret = 0;</div>
<div class="line"><span class="keywordtype">byte</span> key[] = { some 16, 24, or 32 <span class="keywordtype">byte</span> key };</div>
<div class="line"><span class="keywordtype">byte</span> iv[]  = { some 16 <span class="keywordtype">byte</span> iv };</div>
<div class="line"><span class="keywordtype">byte</span> cipher[AES_BLOCK_SIZE * n]; <span class="comment">//n being a positive integer making</span></div>
<div class="line">cipher some multiple of 16 bytes</div>
<div class="line"><span class="comment">// fill cipher with cipher text</span></div>
<div class="line"><span class="keywordtype">byte</span> plain [AES_BLOCK_SIZE * n];</div>
<div class="line"><span class="keywordflow">if</span> ((ret = <a class="code hl_function" href="#ga7f27a5f5f50fe1da277fafff27fa2173">wc_AesCbcDecryptWithKey</a>(plain, cipher, AES_BLOCK_SIZE, key,</div>
<div class="line">AES_BLOCK_SIZE, iv)) != 0 ) {</div>
<div class="line"><span class="comment">// Decrypt Error</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__AES_html_ga7f27a5f5f50fe1da277fafff27fa2173"><div class="ttname"><a href="#ga7f27a5f5f50fe1da277fafff27fa2173">wc_AesCbcDecryptWithKey</a></div><div class="ttdeci">int wc_AesCbcDecryptWithKey(byte *out, const byte *in, word32 inSz, const byte *key, word32 keySz, const byte *iv)</div><div class="ttdoc">Decrypts a cipher from the input buffer in, and places the resulting plain text in the output buffer ...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gad52b440a630fb94e4250a37b7682ab3b" title="This function initializes an AES structure by setting the key and then setting the initialization vec...">wc_AesSetKey</a> </dd>
<dd>
<a class="el" href="#ga58d80e002c87e2d5d1c8b01f0a7156fc" title="This function sets the initialization vector for a particular AES object. The AES object should be in...">wc_AesSetIV</a> </dd>
<dd>
<a class="el" href="#gaed1e38cd30d917165183fc68dd4b218b" title="Encrypts a plaintext message from the input buffer in, and places the resulting cipher text in the ou...">wc_AesCbcEncrypt</a> </dd>
<dd>
<a class="el" href="#ga35713fdddf94f25ca7bd1a60249b041c" title="Decrypts a cipher from the input buffer in, and places the resulting plain text in the output buffer ...">wc_AesCbcDecrypt</a> </dd></dl>

</div>
</div>
<a id="gaed1e38cd30d917165183fc68dd4b218b" name="gaed1e38cd30d917165183fc68dd4b218b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaed1e38cd30d917165183fc68dd4b218b">&#9670;&#160;</a></span>wc_AesCbcEncrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesCbcEncrypt </td>
          <td>(</td>
          <td class="paramtype">Aes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>sz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypts a plaintext message from the input buffer in, and places the resulting cipher text in the output buffer out using cipher block chaining with AES. This function requires that the AES object has been initialized by calling AesSetKey before a message is able to be encrypted. This function assumes that the input message is AES block length aligned, and expects the input length to be a multiple of the block length, which will optionally be checked and enforced if WOLFSSL_AES_CBC_LENGTH_CHECKS is defined in the build configuration. In order to assure block-multiple input, PKCS#7 style padding should be added beforehand. This differs from the OpenSSL AES-CBC methods which add the padding for you. To make the wolfSSL and corresponding OpenSSL functions interoperate, one should specify the -nopad option in the OpenSSL command line function so that it behaves like the wolfSSL AesCbcEncrypt method and does not add extra padding during encryption. </p>
<dl class="section return"><dt>Returns</dt><dd>0 On successfully encrypting message. </dd>
<dd>
BAD_ALIGN_E: may be returned on block align error </dd>
<dd>
BAD_LENGTH_E will be returned if the input length isn't a multiple of the AES block length, when the library is built with WOLFSSL_AES_CBC_LENGTH_CHECKS.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>pointer to the AES object used to encrypt data </td></tr>
    <tr><td class="paramname">out</td><td>pointer to the output buffer in which to store the ciphertext of the encrypted message </td></tr>
    <tr><td class="paramname">in</td><td>pointer to the input buffer containing message to be encrypted </td></tr>
    <tr><td class="paramname">sz</td><td>size of input message</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Aes enc;</div>
<div class="line"><span class="keywordtype">int</span> ret = 0;</div>
<div class="line"><span class="comment">// initialize enc with wc_AesInit and wc_AesSetKey, using direction</span></div>
<div class="line"><span class="comment">// AES_ENCRYPTION</span></div>
<div class="line"><span class="keywordtype">byte</span> msg[AES_BLOCK_SIZE * n]; <span class="comment">// multiple of 16 bytes</span></div>
<div class="line"><span class="comment">// fill msg with data</span></div>
<div class="line"><span class="keywordtype">byte</span> cipher[AES_BLOCK_SIZE * n]; <span class="comment">// Some multiple of 16 bytes</span></div>
<div class="line"><span class="keywordflow">if</span> ((ret = <a class="code hl_function" href="#gaed1e38cd30d917165183fc68dd4b218b">wc_AesCbcEncrypt</a>(&amp;enc, cipher, message, <span class="keyword">sizeof</span>(msg))) != 0 ) {</div>
<div class="line"><span class="comment">// block align error</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__AES_html_gaed1e38cd30d917165183fc68dd4b218b"><div class="ttname"><a href="#gaed1e38cd30d917165183fc68dd4b218b">wc_AesCbcEncrypt</a></div><div class="ttdeci">int wc_AesCbcEncrypt(Aes *aes, byte *out, const byte *in, word32 sz)</div><div class="ttdoc">Encrypts a plaintext message from the input buffer in, and places the resulting cipher text in the ou...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga430f0c344e8e8132bceec748483212c1" title="Initialize Aes structure. Sets heap hint to be used and ID for use with async hardware....">wc_AesInit</a> </dd>
<dd>
<a class="el" href="#gad52b440a630fb94e4250a37b7682ab3b" title="This function initializes an AES structure by setting the key and then setting the initialization vec...">wc_AesSetKey</a> </dd>
<dd>
<a class="el" href="#ga58d80e002c87e2d5d1c8b01f0a7156fc" title="This function sets the initialization vector for a particular AES object. The AES object should be in...">wc_AesSetIV</a> </dd>
<dd>
<a class="el" href="#ga35713fdddf94f25ca7bd1a60249b041c" title="Decrypts a cipher from the input buffer in, and places the resulting plain text in the output buffer ...">wc_AesCbcDecrypt</a> </dd></dl>

</div>
</div>
<a id="ga74f0c4e47cecadaf02c1e5a756fcb0e2" name="ga74f0c4e47cecadaf02c1e5a756fcb0e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga74f0c4e47cecadaf02c1e5a756fcb0e2">&#9670;&#160;</a></span>wc_AesCcmDecrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesCcmDecrypt </td>
          <td>(</td>
          <td class="paramtype">Aes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>inSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>nonce</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>nonceSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>authTag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>authTagSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>authIn</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>authInSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function decrypts the input cipher text, in, into the output buffer, out, using CCM (Counter with CBC-MAC). It subsequently calculates the authorization tag, authTag, from the authIn input. If a nonzero error code is returned, the output data is undefined. However, callers must unconditionally zeroize the output buffer to guard against leakage of cleartext data. </p>
<dl class="section return"><dt>Returns</dt><dd>0 On successfully decrypting the input message </dd>
<dd>
AES_CCM_AUTH_E If the authentication tag does not match the supplied authentication code vector, authTag.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>pointer to the AES object used to encrypt data </td></tr>
    <tr><td class="paramname">out</td><td>pointer to the output buffer in which to store the cipher text </td></tr>
    <tr><td class="paramname">in</td><td>pointer to the input buffer holding the message to encrypt </td></tr>
    <tr><td class="paramname">sz</td><td>length of the input cipher text to decrypt </td></tr>
    <tr><td class="paramname">nonce</td><td>pointer to the buffer containing the nonce (number only used once) </td></tr>
    <tr><td class="paramname">nonceSz</td><td>length of the nonce </td></tr>
    <tr><td class="paramname">authTag</td><td>pointer to the buffer in which to store the authentication tag </td></tr>
    <tr><td class="paramname">authTagSz</td><td>length of the desired authentication tag </td></tr>
    <tr><td class="paramname">authIn</td><td>pointer to the buffer containing the input authentication vector </td></tr>
    <tr><td class="paramname">authInSz</td><td>length of the input authentication vector</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Aes dec;</div>
<div class="line"><span class="comment">// initialize dec with wc_AesInit and wc_AesCcmSetKey</span></div>
<div class="line"> </div>
<div class="line">nonce[] = { initialize nonce };</div>
<div class="line">cipher[] = { encrypted message };</div>
<div class="line">plain[<span class="keyword">sizeof</span>(cipher)];</div>
<div class="line"> </div>
<div class="line">authIn[] = { some 16 <span class="keywordtype">byte</span> authentication input };</div>
<div class="line">tag[AES_BLOCK_SIZE] = { authentication tag received <span class="keywordflow">for</span> verification };</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <span class="keywordflow">return</span> = <a class="code hl_function" href="#ga74f0c4e47cecadaf02c1e5a756fcb0e2">wc_AesCcmDecrypt</a>(&amp;dec, plain, cipher, <span class="keyword">sizeof</span>(cipher),</div>
<div class="line">nonce, <span class="keyword">sizeof</span>(nonce),tag, <span class="keyword">sizeof</span>(tag), authIn, <span class="keyword">sizeof</span>(authIn));</div>
<div class="line"><span class="keywordflow">if</span>(<span class="keywordflow">return</span> != 0) {</div>
<div class="line"><span class="comment">// decrypt error, invalid authentication code</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__AES_html_ga74f0c4e47cecadaf02c1e5a756fcb0e2"><div class="ttname"><a href="#ga74f0c4e47cecadaf02c1e5a756fcb0e2">wc_AesCcmDecrypt</a></div><div class="ttdeci">int wc_AesCcmDecrypt(Aes *aes, byte *out, const byte *in, word32 inSz, const byte *nonce, word32 nonceSz, const byte *authTag, word32 authTagSz, const byte *authIn, word32 authInSz)</div><div class="ttdoc">This function decrypts the input cipher text, in, into the output buffer, out, using CCM (Counter wit...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga093c15adc447598d0a8def1676ee9939" title="This function sets the key for an AES object using CCM (Counter with CBC-MAC). It takes a pointer to ...">wc_AesCcmSetKey</a> </dd>
<dd>
<a class="el" href="#ga5742b8232c72e07262d8daff5b6da21c" title="This function encrypts the input message, in, into the output buffer, out, using CCM (Counter with CB...">wc_AesCcmEncrypt</a> </dd></dl>

</div>
</div>
<a id="ga5742b8232c72e07262d8daff5b6da21c" name="ga5742b8232c72e07262d8daff5b6da21c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5742b8232c72e07262d8daff5b6da21c">&#9670;&#160;</a></span>wc_AesCcmEncrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesCcmEncrypt </td>
          <td>(</td>
          <td class="paramtype">Aes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>inSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>nonce</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>nonceSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>authTag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>authTagSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>authIn</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>authInSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function encrypts the input message, in, into the output buffer, out, using CCM (Counter with CBC-MAC). It subsequently calculates and stores the authorization tag, authTag, from the authIn input. </p>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>pointer to the AES object used to encrypt data </td></tr>
    <tr><td class="paramname">out</td><td>pointer to the output buffer in which to store the cipher text </td></tr>
    <tr><td class="paramname">in</td><td>pointer to the input buffer holding the message to encrypt </td></tr>
    <tr><td class="paramname">sz</td><td>length of the input message to encrypt </td></tr>
    <tr><td class="paramname">nonce</td><td>pointer to the buffer containing the nonce (number only used once) </td></tr>
    <tr><td class="paramname">nonceSz</td><td>length of the nonce </td></tr>
    <tr><td class="paramname">authTag</td><td>pointer to the buffer in which to store the authentication tag </td></tr>
    <tr><td class="paramname">authTagSz</td><td>length of the desired authentication tag </td></tr>
    <tr><td class="paramname">authIn</td><td>pointer to the buffer containing the input authentication vector </td></tr>
    <tr><td class="paramname">authInSz</td><td>length of the input authentication vector</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Aes enc;</div>
<div class="line"><span class="comment">// initialize enc with wc_AesInit and wc_AesCcmSetKey</span></div>
<div class="line"> </div>
<div class="line">nonce[] = { initialize nonce };</div>
<div class="line">plain[] = { some plain text message };</div>
<div class="line">cipher[<span class="keyword">sizeof</span>(plain)];</div>
<div class="line"> </div>
<div class="line">authIn[] = { some 16 <span class="keywordtype">byte</span> authentication input };</div>
<div class="line">tag[AES_BLOCK_SIZE]; <span class="comment">// will store authentication code</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ga5742b8232c72e07262d8daff5b6da21c">wc_AesCcmEncrypt</a>(&amp;enc, cipher, plain, <span class="keyword">sizeof</span>(plain), nonce, <span class="keyword">sizeof</span>(nonce),</div>
<div class="line">        tag, <span class="keyword">sizeof</span>(tag), authIn, <span class="keyword">sizeof</span>(authIn));</div>
<div class="ttc" id="agroup__AES_html_ga5742b8232c72e07262d8daff5b6da21c"><div class="ttname"><a href="#ga5742b8232c72e07262d8daff5b6da21c">wc_AesCcmEncrypt</a></div><div class="ttdeci">int wc_AesCcmEncrypt(Aes *aes, byte *out, const byte *in, word32 inSz, const byte *nonce, word32 nonceSz, byte *authTag, word32 authTagSz, const byte *authIn, word32 authInSz)</div><div class="ttdoc">This function encrypts the input message, in, into the output buffer, out, using CCM (Counter with CB...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga093c15adc447598d0a8def1676ee9939" title="This function sets the key for an AES object using CCM (Counter with CBC-MAC). It takes a pointer to ...">wc_AesCcmSetKey</a> </dd>
<dd>
<a class="el" href="#ga74f0c4e47cecadaf02c1e5a756fcb0e2" title="This function decrypts the input cipher text, in, into the output buffer, out, using CCM (Counter wit...">wc_AesCcmDecrypt</a> </dd></dl>

</div>
</div>
<a id="ga093c15adc447598d0a8def1676ee9939" name="ga093c15adc447598d0a8def1676ee9939"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga093c15adc447598d0a8def1676ee9939">&#9670;&#160;</a></span>wc_AesCcmSetKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesCcmSetKey </td>
          <td>(</td>
          <td class="paramtype">Aes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>keySz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function sets the key for an AES object using CCM (Counter with CBC-MAC). It takes a pointer to an AES structure and initializes it with supplied key. </p>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>aes structure in which to store the supplied key </td></tr>
    <tr><td class="paramname">key</td><td>16, 24, or 32 byte secret key for encryption and decryption </td></tr>
    <tr><td class="paramname">keySz</td><td>size of the supplied key</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Aes enc;</div>
<div class="line">key[] = { some 16, 24, or 32 <span class="keywordtype">byte</span> length key };</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ga430f0c344e8e8132bceec748483212c1">wc_AesInit</a>(&amp;enc, HEAP_HINT, INVALID_DEVID); <span class="comment">// Make sure devId updated</span></div>
<div class="line"><a class="code hl_function" href="#ga093c15adc447598d0a8def1676ee9939">wc_AesCcmSetKey</a>(&amp;enc, key, <span class="keyword">sizeof</span>(key));</div>
<div class="ttc" id="agroup__AES_html_ga093c15adc447598d0a8def1676ee9939"><div class="ttname"><a href="#ga093c15adc447598d0a8def1676ee9939">wc_AesCcmSetKey</a></div><div class="ttdeci">int wc_AesCcmSetKey(Aes *aes, const byte *key, word32 keySz)</div><div class="ttdoc">This function sets the key for an AES object using CCM (Counter with CBC-MAC). It takes a pointer to ...</div></div>
<div class="ttc" id="agroup__AES_html_ga430f0c344e8e8132bceec748483212c1"><div class="ttname"><a href="#ga430f0c344e8e8132bceec748483212c1">wc_AesInit</a></div><div class="ttdeci">int wc_AesInit(Aes *aes, void *heap, int devId)</div><div class="ttdoc">Initialize Aes structure. Sets heap hint to be used and ID for use with async hardware....</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga5742b8232c72e07262d8daff5b6da21c" title="This function encrypts the input message, in, into the output buffer, out, using CCM (Counter with CB...">wc_AesCcmEncrypt</a> </dd>
<dd>
<a class="el" href="#ga74f0c4e47cecadaf02c1e5a756fcb0e2" title="This function decrypts the input cipher text, in, into the output buffer, out, using CCM (Counter wit...">wc_AesCcmDecrypt</a> </dd></dl>

</div>
</div>
<a id="ga311d4f8105b7f3b1d5a3b46fca440b6d" name="ga311d4f8105b7f3b1d5a3b46fca440b6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga311d4f8105b7f3b1d5a3b46fca440b6d">&#9670;&#160;</a></span>wc_AesCfbDecrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesCfbDecrypt </td>
          <td>(</td>
          <td class="paramtype">Aes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>sz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>AES with CFB mode. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Success and negative error values on failure</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>AES keys to use for block encrypt/decrypt </td></tr>
    <tr><td class="paramname">out</td><td>output buffer to hold decrypted text must be at least as large as inputbuffer) </td></tr>
    <tr><td class="paramname">in</td><td>input buffer to decrypt </td></tr>
    <tr><td class="paramname">sz</td><td>size of input buffer</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Aes aes;</div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> plain[SIZE];</div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> cipher[SIZE];</div>
<div class="line"> </div>
<div class="line"><span class="comment">//set up key with AES_ENCRYPTION as dir for both encrypt and decrypt</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>(<a class="code hl_function" href="#ga311d4f8105b7f3b1d5a3b46fca440b6d">wc_AesCfbDecrypt</a>(&amp;aes, plain, cipher, SIZE) != 0)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Handle error</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__AES_html_ga311d4f8105b7f3b1d5a3b46fca440b6d"><div class="ttname"><a href="#ga311d4f8105b7f3b1d5a3b46fca440b6d">wc_AesCfbDecrypt</a></div><div class="ttdeci">int wc_AesCfbDecrypt(Aes *aes, byte *out, const byte *in, word32 sz)</div><div class="ttdoc">AES with CFB mode.</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga92c53cbd730d329fe59a15b372495d3a" title="AES with CFB mode.">wc_AesCfbEncrypt</a> </dd>
<dd>
<a class="el" href="#gad52b440a630fb94e4250a37b7682ab3b" title="This function initializes an AES structure by setting the key and then setting the initialization vec...">wc_AesSetKey</a> </dd></dl>

</div>
</div>
<a id="ga92c53cbd730d329fe59a15b372495d3a" name="ga92c53cbd730d329fe59a15b372495d3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga92c53cbd730d329fe59a15b372495d3a">&#9670;&#160;</a></span>wc_AesCfbEncrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesCfbEncrypt </td>
          <td>(</td>
          <td class="paramtype">Aes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>sz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>AES with CFB mode. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Success and negative error values on failure</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>AES keys to use for block encrypt/decrypt </td></tr>
    <tr><td class="paramname">out</td><td>output buffer to hold cipher text must be at least as large as inputbuffer) </td></tr>
    <tr><td class="paramname">in</td><td>input plain text buffer to encrypt </td></tr>
    <tr><td class="paramname">sz</td><td>size of input buffer</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Aes aes;</div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> plain[SIZE];</div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> cipher[SIZE];</div>
<div class="line"> </div>
<div class="line"><span class="comment">//set up key with AES_ENCRYPTION as dir for both encrypt and decrypt</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>(<a class="code hl_function" href="#ga92c53cbd730d329fe59a15b372495d3a">wc_AesCfbEncrypt</a>(&amp;aes, cipher, plain, SIZE) != 0)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Handle error</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__AES_html_ga92c53cbd730d329fe59a15b372495d3a"><div class="ttname"><a href="#ga92c53cbd730d329fe59a15b372495d3a">wc_AesCfbEncrypt</a></div><div class="ttdeci">int wc_AesCfbEncrypt(Aes *aes, byte *out, const byte *in, word32 sz)</div><div class="ttdoc">AES with CFB mode.</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga311d4f8105b7f3b1d5a3b46fca440b6d" title="AES with CFB mode.">wc_AesCfbDecrypt</a> </dd>
<dd>
<a class="el" href="#gad52b440a630fb94e4250a37b7682ab3b" title="This function initializes an AES structure by setting the key and then setting the initialization vec...">wc_AesSetKey</a> </dd></dl>

</div>
</div>
<a id="gabe7557f4867c7d8f84cecaa000fe43a1" name="gabe7557f4867c7d8f84cecaa000fe43a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabe7557f4867c7d8f84cecaa000fe43a1">&#9670;&#160;</a></span>wc_AesCtrEncrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesCtrEncrypt </td>
          <td>(</td>
          <td class="paramtype">Aes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>sz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypts/Decrypts a message from the input buffer in, and places the resulting cipher text in the output buffer out using CTR mode with AES. This function is only enabled if WOLFSSL_AES_COUNTER is enabled at compile time. The AES structure should be initialized through AesSetKey before calling this function. Note that this function is used for both decryption and encryption. <em>NOTE:</em> Regarding using same API for encryption and decryption. User should differentiate between Aes structures for encrypt/decrypt. </p>
<dl class="section return"><dt>Returns</dt><dd>int integer values corresponding to wolfSSL error or success status</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>pointer to the AES object used to decrypt data </td></tr>
    <tr><td class="paramname">out</td><td>pointer to the output buffer in which to store the cipher text of the encrypted message size must be a multiple of AES_BLOCK_LENGTH, padded if necessary </td></tr>
    <tr><td class="paramname">in</td><td>pointer to the input buffer containing plain text to be encrypted size must be a multiple of AES_BLOCK_LENGTH, padded if necessary </td></tr>
    <tr><td class="paramname">sz</td><td>size of the input plain text</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Aes enc;</div>
<div class="line">Aes dec;</div>
<div class="line"><span class="comment">// initialize enc and dec with wc_AesInit and wc_AesSetKeyDirect, using</span></div>
<div class="line"><span class="comment">// direction AES_ENCRYPTION since the underlying API only calls Encrypt</span></div>
<div class="line"><span class="comment">// and by default calling encrypt on a cipher results in a decryption of</span></div>
<div class="line"><span class="comment">// the cipher</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">byte</span> msg[AES_BLOCK_SIZE * n]; <span class="comment">//n being a positive integer making msg</span></div>
<div class="line">some multiple of 16 bytes</div>
<div class="line"><span class="comment">// fill plain with message text</span></div>
<div class="line"><span class="keywordtype">byte</span> cipher[AES_BLOCK_SIZE * n];</div>
<div class="line"><span class="keywordtype">byte</span> decrypted[AES_BLOCK_SIZE * n];</div>
<div class="line"><a class="code hl_function" href="#gabe7557f4867c7d8f84cecaa000fe43a1">wc_AesCtrEncrypt</a>(&amp;enc, cipher, msg, <span class="keyword">sizeof</span>(msg)); <span class="comment">// encrypt plain</span></div>
<div class="line"><a class="code hl_function" href="#gabe7557f4867c7d8f84cecaa000fe43a1">wc_AesCtrEncrypt</a>(&amp;dec, decrypted, cipher, <span class="keyword">sizeof</span>(cipher));</div>
<div class="line"><span class="comment">// decrypt cipher text</span></div>
<div class="ttc" id="agroup__AES_html_gabe7557f4867c7d8f84cecaa000fe43a1"><div class="ttname"><a href="#gabe7557f4867c7d8f84cecaa000fe43a1">wc_AesCtrEncrypt</a></div><div class="ttdeci">int wc_AesCtrEncrypt(Aes *aes, byte *out, const byte *in, word32 sz)</div><div class="ttdoc">Encrypts/Decrypts a message from the input buffer in, and places the resulting cipher text in the out...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gad52b440a630fb94e4250a37b7682ab3b" title="This function initializes an AES structure by setting the key and then setting the initialization vec...">wc_AesSetKey</a> </dd></dl>

</div>
</div>
<a id="ga4a2a1f1c4e587134fdcf03ba1faf2e4b" name="ga4a2a1f1c4e587134fdcf03ba1faf2e4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4a2a1f1c4e587134fdcf03ba1faf2e4b">&#9670;&#160;</a></span>wc_AesCtsDecrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesCtsDecrypt </td>
          <td>(</td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>keySz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>inSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>iv</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function performs AES decryption using Ciphertext Stealing (CTS) mode. It is a one-shot API that handles all operations in a single call. </p>
<dl class="section return"><dt>Returns</dt><dd>0 on successful decryption. </dd>
<dd>
BAD_FUNC_ARG if input arguments are invalid. </dd>
<dd>
other negative error codes for decryption failures. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">key</td><td>pointer to the AES key used for decryption. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">keySz</td><td>size of the AES key in bytes (16, 24, or 32 bytes). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>buffer to hold the decrypted plaintext. Must be at least the same size as the input ciphertext. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">in</td><td>pointer to the ciphertext input data to decrypt. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inSz</td><td>size of the ciphertext input data in bytes. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">iv</td><td>pointer to the initialization vector (IV) used for decryption. Must be 16 bytes. <em>Example</em> <div class="fragment"><div class="line"><span class="keywordtype">byte</span> key[16] = { 0 };</div>
<div class="line"><span class="keywordtype">byte</span> iv[16] = { 0 };</div>
<div class="line"><span class="keywordtype">byte</span> ciphertext[] = { 0x01, 0x02, 0x03, 0x04, 0x05 };</div>
<div class="line"><span class="keywordtype">byte</span> plaintext[<span class="keyword">sizeof</span>(ciphertext)];</div>
<div class="line"><span class="keywordtype">int</span> ret = <a class="code hl_function" href="#ga4a2a1f1c4e587134fdcf03ba1faf2e4b">wc_AesCtsDecrypt</a>(key, <span class="keyword">sizeof</span>(key), plaintext, ciphertext,</div>
<div class="line">                           <span class="keyword">sizeof</span>(ciphertext), iv);</div>
<div class="line"><span class="keywordflow">if</span> (ret != 0) {</div>
<div class="line">    <span class="comment">// handle decryption error</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__AES_html_ga4a2a1f1c4e587134fdcf03ba1faf2e4b"><div class="ttname"><a href="#ga4a2a1f1c4e587134fdcf03ba1faf2e4b">wc_AesCtsDecrypt</a></div><div class="ttdeci">int wc_AesCtsDecrypt(const byte *key, word32 keySz, byte *out, const byte *in, word32 inSz, const byte *iv)</div><div class="ttdoc">This function performs AES decryption using Ciphertext Stealing (CTS) mode. It is a one-shot API that...</div></div>
</div><!-- fragment --> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaba13cae6b85c2ea43cfbd8b9100ab05e" title="This function performs AES encryption using Ciphertext Stealing (CTS) mode. It is a one-shot API that...">wc_AesCtsEncrypt</a> </dd></dl>

</div>
</div>
<a id="gaa1f9afc8880044a57b9e404653581871" name="gaa1f9afc8880044a57b9e404653581871"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa1f9afc8880044a57b9e404653581871">&#9670;&#160;</a></span>wc_AesCtsDecryptFinal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesCtsDecryptFinal </td>
          <td>(</td>
          <td class="paramtype">Aes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32 *</td>          <td class="paramname"><span class="paramname"><em>outSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function finalizes the AES CTS decryption operation. It processes any remaining ciphertext and completes the decryption. </p>
<dl class="section return"><dt>Returns</dt><dd>0 on successful decryption completion. </dd>
<dd>
BAD_FUNC_ARG if input arguments are invalid. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">aes</td><td>pointer to the Aes structure holding the context of the operation. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>buffer to hold the final decrypted plaintext. Must be large enough to store any remaining plaintext from this final step. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">outSz</td><td>size in bytes of the output data written to the <code>out</code> buffer. On input, it should contain the maximum number of bytes that can be written to the <code>out</code> buffer. <em>Example</em> <div class="fragment"><div class="line">Aes aes;</div>
<div class="line"><a class="code hl_function" href="#ga430f0c344e8e8132bceec748483212c1">wc_AesInit</a>(&amp;aes, NULL, INVALID_DEVID);</div>
<div class="line"><span class="keywordtype">byte</span> key[16] = { 0 };</div>
<div class="line"><span class="keywordtype">byte</span> iv[16] = { 0 };</div>
<div class="line"><span class="keywordtype">byte</span> ciphertext[] = { ... };</div>
<div class="line"><span class="keywordtype">byte</span> plaintext[<span class="keyword">sizeof</span>(ciphertext)];</div>
<div class="line">word32 outSz = <span class="keyword">sizeof</span>(plaintext);</div>
<div class="line"><a class="code hl_function" href="#gad52b440a630fb94e4250a37b7682ab3b">wc_AesSetKey</a>(&amp;aes, key, <span class="keyword">sizeof</span>(key), iv, AES_DECRYPTION);</div>
<div class="line"><span class="comment">// Perform any required update steps using wc_AesCtsDecryptUpdate</span></div>
<div class="line"><span class="keywordtype">int</span> ret = <a class="code hl_function" href="#gaa1f9afc8880044a57b9e404653581871">wc_AesCtsDecryptFinal</a>(&amp;aes, plaintext, &amp;outSz);</div>
<div class="line"><span class="keywordflow">if</span> (ret != 0) {</div>
<div class="line">    <span class="comment">// handle error</span></div>
<div class="line">}</div>
<div class="line"><a class="code hl_function" href="#ga976e1b14c12dca0a43aebe9f70339739">wc_AesFree</a>(&amp;aes);</div>
<div class="ttc" id="agroup__AES_html_ga976e1b14c12dca0a43aebe9f70339739"><div class="ttname"><a href="#ga976e1b14c12dca0a43aebe9f70339739">wc_AesFree</a></div><div class="ttdeci">int wc_AesFree(Aes *aes)</div><div class="ttdoc">free resources associated with the Aes structure when applicable. Internally may sometimes be a no-op...</div></div>
<div class="ttc" id="agroup__AES_html_gaa1f9afc8880044a57b9e404653581871"><div class="ttname"><a href="#gaa1f9afc8880044a57b9e404653581871">wc_AesCtsDecryptFinal</a></div><div class="ttdeci">int wc_AesCtsDecryptFinal(Aes *aes, byte *out, word32 *outSz)</div><div class="ttdoc">This function finalizes the AES CTS decryption operation. It processes any remaining ciphertext and c...</div></div>
<div class="ttc" id="agroup__AES_html_gad52b440a630fb94e4250a37b7682ab3b"><div class="ttname"><a href="#gad52b440a630fb94e4250a37b7682ab3b">wc_AesSetKey</a></div><div class="ttdeci">int wc_AesSetKey(Aes *aes, const byte *key, word32 len, const byte *iv, int dir)</div><div class="ttdoc">This function initializes an AES structure by setting the key and then setting the initialization vec...</div></div>
</div><!-- fragment --> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gac64d26302b62805366927f15fc36daef" title="This function finalizes the AES CTS encryption operation. It processes any remaining plaintext and co...">wc_AesCtsEncryptFinal</a> </dd></dl>

</div>
</div>
<a id="gaf192cb665cccec364e60be89e5cd4b5b" name="gaf192cb665cccec364e60be89e5cd4b5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf192cb665cccec364e60be89e5cd4b5b">&#9670;&#160;</a></span>wc_AesCtsDecryptUpdate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesCtsDecryptUpdate </td>
          <td>(</td>
          <td class="paramtype">Aes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32 *</td>          <td class="paramname"><span class="paramname"><em>outSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>inSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function performs an update step of the AES CTS decryption. It processes a chunk of ciphertext and stores intermediate data. </p>
<dl class="section return"><dt>Returns</dt><dd>0 on successful processing. </dd>
<dd>
BAD_FUNC_ARG if input arguments are invalid. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">aes</td><td>pointer to the Aes structure holding the context of the operation. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>buffer to hold the decrypted plaintext. Must be large enough to store the output from this update step. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">outSz</td><td>size in bytes of the output data written to the <code>out</code> buffer. On input, it should contain the maximum number of bytes that can be written to the <code>out</code> buffer. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">in</td><td>pointer to the ciphertext input data to decrypt. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inSz</td><td>size of the ciphertext input data in bytes. <em>Example</em> <div class="fragment"><div class="line">Aes aes;</div>
<div class="line"><a class="code hl_function" href="#ga430f0c344e8e8132bceec748483212c1">wc_AesInit</a>(&amp;aes, NULL, INVALID_DEVID);</div>
<div class="line"><span class="keywordtype">byte</span> key[16] = { 0 };</div>
<div class="line"><span class="keywordtype">byte</span> iv[16] = { 0 };</div>
<div class="line"><span class="keywordtype">byte</span> ciphertext[] = { ... };</div>
<div class="line"><span class="keywordtype">byte</span> plaintext[<span class="keyword">sizeof</span>(ciphertext)];</div>
<div class="line">word32 outSz = <span class="keyword">sizeof</span>(plaintext);</div>
<div class="line"><a class="code hl_function" href="#gad52b440a630fb94e4250a37b7682ab3b">wc_AesSetKey</a>(&amp;aes, key, <span class="keyword">sizeof</span>(key), iv, AES_DECRYPTION);</div>
<div class="line"><span class="keywordtype">int</span> ret = <a class="code hl_function" href="#gaf192cb665cccec364e60be89e5cd4b5b">wc_AesCtsDecryptUpdate</a>(&amp;aes, plaintext, &amp;outSz, ciphertext, <span class="keyword">sizeof</span>(ciphertext));</div>
<div class="line"><span class="keywordflow">if</span> (ret != 0) {</div>
<div class="line">    <span class="comment">// handle error</span></div>
<div class="line">}</div>
<div class="line"><a class="code hl_function" href="#ga976e1b14c12dca0a43aebe9f70339739">wc_AesFree</a>(&amp;aes);</div>
<div class="ttc" id="agroup__AES_html_gaf192cb665cccec364e60be89e5cd4b5b"><div class="ttname"><a href="#gaf192cb665cccec364e60be89e5cd4b5b">wc_AesCtsDecryptUpdate</a></div><div class="ttdeci">int wc_AesCtsDecryptUpdate(Aes *aes, byte *out, word32 *outSz, const byte *in, word32 inSz)</div><div class="ttdoc">This function performs an update step of the AES CTS decryption. It processes a chunk of ciphertext a...</div></div>
</div><!-- fragment --> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaed7ca64828d8429b7c140941561c57a5" title="This function performs an update step of the AES CTS encryption. It processes a chunk of plaintext an...">wc_AesCtsEncryptUpdate</a> </dd></dl>

</div>
</div>
<a id="gaba13cae6b85c2ea43cfbd8b9100ab05e" name="gaba13cae6b85c2ea43cfbd8b9100ab05e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaba13cae6b85c2ea43cfbd8b9100ab05e">&#9670;&#160;</a></span>wc_AesCtsEncrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesCtsEncrypt </td>
          <td>(</td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>keySz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>inSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>iv</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function performs AES encryption using Ciphertext Stealing (CTS) mode. It is a one-shot API that handles all operations in a single call. </p>
<dl class="section return"><dt>Returns</dt><dd>0 on successful encryption. </dd>
<dd>
BAD_FUNC_ARG if input arguments are invalid. </dd>
<dd>
other negative error codes for encryption failures.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">key</td><td>pointer to the AES key used for encryption. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">keySz</td><td>size of the AES key in bytes (16, 24, or 32 bytes). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>buffer to hold the encrypted ciphertext. Must be at least the size of the input. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">in</td><td>pointer to the plaintext input data to encrypt. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inSz</td><td>size of the plaintext input data in bytes. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">iv</td><td>pointer to the initialization vector (IV) used for encryption. Must be 16 bytes.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">    <span class="keywordtype">byte</span> key[16] = { 0 };</div>
<div class="line">    <span class="keywordtype">byte</span> iv[16] = { 0 };</div>
<div class="line">    <span class="keywordtype">byte</span> plaintext[] = { 0x01, 0x02, 0x03, 0x04, 0x05 };</div>
<div class="line">    <span class="keywordtype">byte</span> ciphertext[<span class="keyword">sizeof</span>(plaintext)];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> ret = <a class="code hl_function" href="#gaba13cae6b85c2ea43cfbd8b9100ab05e">wc_AesCtsEncrypt</a>(key, <span class="keyword">sizeof</span>(key), ciphertext, plaintext,</div>
<div class="line">        <span class="keyword">sizeof</span>(plaintext), iv);</div>
<div class="line">    <span class="keywordflow">if</span> (ret != 0) {</div>
<div class="line">    <span class="comment">// handle encryption error</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__AES_html_gaba13cae6b85c2ea43cfbd8b9100ab05e"><div class="ttname"><a href="#gaba13cae6b85c2ea43cfbd8b9100ab05e">wc_AesCtsEncrypt</a></div><div class="ttdeci">int wc_AesCtsEncrypt(const byte *key, word32 keySz, byte *out, const byte *in, word32 inSz, const byte *iv)</div><div class="ttdoc">This function performs AES encryption using Ciphertext Stealing (CTS) mode. It is a one-shot API that...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga4a2a1f1c4e587134fdcf03ba1faf2e4b" title="This function performs AES decryption using Ciphertext Stealing (CTS) mode. It is a one-shot API that...">wc_AesCtsDecrypt</a></dd></dl>
<dl class="section return"><dt>Returns</dt><dd>0 on successful encryption. </dd>
<dd>
BAD_FUNC_ARG if input arguments are invalid. </dd>
<dd>
other negative error codes for encryption failures.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">key</td><td>pointer to the AES key used for encryption. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">keySz</td><td>size of the AES key in bytes (16, 24, or 32 bytes). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>buffer to hold the encrypted ciphertext. Must be at least the same size as the input plaintext. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">in</td><td>pointer to the plaintext input data to encrypt. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inSz</td><td>size of the plaintext input data in bytes. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">iv</td><td>pointer to the initialization vector (IV) used for encryption. Must be 16 bytes. <em>Example</em> <div class="fragment"><div class="line"><span class="keywordtype">byte</span> key[16] = { 0 };</div>
<div class="line"><span class="keywordtype">byte</span> iv[16] = { 0 };</div>
<div class="line"><span class="keywordtype">byte</span> plaintext[] = { 0x01, 0x02, 0x03, 0x04, 0x05 };</div>
<div class="line"><span class="keywordtype">byte</span> ciphertext[<span class="keyword">sizeof</span>(plaintext)];</div>
<div class="line"><span class="keywordtype">int</span> ret = <a class="code hl_function" href="#gaba13cae6b85c2ea43cfbd8b9100ab05e">wc_AesCtsEncrypt</a>(key, <span class="keyword">sizeof</span>(key), ciphertext, plaintext,</div>
<div class="line">                           <span class="keyword">sizeof</span>(plaintext), iv);</div>
<div class="line"><span class="keywordflow">if</span> (ret != 0) {</div>
<div class="line">    <span class="comment">// handle encryption error</span></div>
<div class="line">}</div>
</div><!-- fragment --> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga4a2a1f1c4e587134fdcf03ba1faf2e4b" title="This function performs AES decryption using Ciphertext Stealing (CTS) mode. It is a one-shot API that...">wc_AesCtsDecrypt</a> </dd></dl>

</div>
</div>
<a id="gac64d26302b62805366927f15fc36daef" name="gac64d26302b62805366927f15fc36daef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac64d26302b62805366927f15fc36daef">&#9670;&#160;</a></span>wc_AesCtsEncryptFinal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesCtsEncryptFinal </td>
          <td>(</td>
          <td class="paramtype">Aes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32 *</td>          <td class="paramname"><span class="paramname"><em>outSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function finalizes the AES CTS encryption operation. It processes any remaining plaintext and completes the encryption. </p>
<dl class="section return"><dt>Returns</dt><dd>0 on successful encryption completion. </dd>
<dd>
BAD_FUNC_ARG if input arguments are invalid. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">aes</td><td>pointer to the Aes structure holding the context of the operation. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>buffer to hold the final encrypted ciphertext. Must be large enough to store any remaining ciphertext from this final step. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">outSz</td><td>size in bytes of the output data written to the <code>out</code> buffer. On input, it should contain the maximum number of bytes that can be written to the <code>out</code> buffer. <em>Example</em> <div class="fragment"><div class="line">Aes aes;</div>
<div class="line"><a class="code hl_function" href="#ga430f0c344e8e8132bceec748483212c1">wc_AesInit</a>(&amp;aes, NULL, INVALID_DEVID);</div>
<div class="line"><span class="keywordtype">byte</span> key[16] = { 0 };</div>
<div class="line"><span class="keywordtype">byte</span> iv[16] = { 0 };</div>
<div class="line"><span class="keywordtype">byte</span> plaintext[] = { ... };</div>
<div class="line"><span class="keywordtype">byte</span> ciphertext[<span class="keyword">sizeof</span>(plaintext)];</div>
<div class="line">word32 outSz = <span class="keyword">sizeof</span>(ciphertext);</div>
<div class="line"><a class="code hl_function" href="#gad52b440a630fb94e4250a37b7682ab3b">wc_AesSetKey</a>(&amp;aes, key, <span class="keyword">sizeof</span>(key), iv, AES_ENCRYPTION);</div>
<div class="line"><span class="comment">// Perform any required update steps using wc_AesCtsEncryptUpdate</span></div>
<div class="line"><span class="keywordtype">int</span> ret = <a class="code hl_function" href="#gac64d26302b62805366927f15fc36daef">wc_AesCtsEncryptFinal</a>(&amp;aes, ciphertext, &amp;outSz);</div>
<div class="line"><span class="keywordflow">if</span> (ret != 0) {</div>
<div class="line">    <span class="comment">// handle error</span></div>
<div class="line">}</div>
<div class="line"><a class="code hl_function" href="#ga976e1b14c12dca0a43aebe9f70339739">wc_AesFree</a>(&amp;aes);</div>
<div class="ttc" id="agroup__AES_html_gac64d26302b62805366927f15fc36daef"><div class="ttname"><a href="#gac64d26302b62805366927f15fc36daef">wc_AesCtsEncryptFinal</a></div><div class="ttdeci">int wc_AesCtsEncryptFinal(Aes *aes, byte *out, word32 *outSz)</div><div class="ttdoc">This function finalizes the AES CTS encryption operation. It processes any remaining plaintext and co...</div></div>
</div><!-- fragment --> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaa1f9afc8880044a57b9e404653581871" title="This function finalizes the AES CTS decryption operation. It processes any remaining ciphertext and c...">wc_AesCtsDecryptFinal</a> </dd></dl>

</div>
</div>
<a id="gaed7ca64828d8429b7c140941561c57a5" name="gaed7ca64828d8429b7c140941561c57a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaed7ca64828d8429b7c140941561c57a5">&#9670;&#160;</a></span>wc_AesCtsEncryptUpdate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesCtsEncryptUpdate </td>
          <td>(</td>
          <td class="paramtype">Aes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32 *</td>          <td class="paramname"><span class="paramname"><em>outSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>inSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function performs an update step of the AES CTS encryption. It processes a chunk of plaintext and stores intermediate data. </p>
<dl class="section return"><dt>Returns</dt><dd>0 on successful processing. </dd>
<dd>
BAD_FUNC_ARG if input arguments are invalid. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">aes</td><td>pointer to the Aes structure holding the context of the operation. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>buffer to hold the encrypted ciphertext. Must be large enough to store the output from this update step. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">outSz</td><td>size in bytes of the output data written to the <code>out</code> buffer. On input, it should contain the maximum number of bytes that can be written to the <code>out</code> buffer. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">in</td><td>pointer to the plaintext input data to encrypt. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inSz</td><td>size of the plaintext input data in bytes. <em>Example</em> <div class="fragment"><div class="line">Aes aes;</div>
<div class="line"><a class="code hl_function" href="#ga430f0c344e8e8132bceec748483212c1">wc_AesInit</a>(&amp;aes, NULL, INVALID_DEVID);</div>
<div class="line"><span class="keywordtype">byte</span> key[16] = { 0 };</div>
<div class="line"><span class="keywordtype">byte</span> iv[16] = { 0 };</div>
<div class="line"><span class="keywordtype">byte</span> plaintext[] = { ... };</div>
<div class="line"><span class="keywordtype">byte</span> ciphertext[<span class="keyword">sizeof</span>(plaintext)];</div>
<div class="line">word32 outSz = <span class="keyword">sizeof</span>(ciphertext);</div>
<div class="line"><a class="code hl_function" href="#gad52b440a630fb94e4250a37b7682ab3b">wc_AesSetKey</a>(&amp;aes, key, <span class="keyword">sizeof</span>(key), iv, AES_ENCRYPTION);</div>
<div class="line"><span class="keywordtype">int</span> ret = <a class="code hl_function" href="#gaed7ca64828d8429b7c140941561c57a5">wc_AesCtsEncryptUpdate</a>(&amp;aes, ciphertext, &amp;outSz, plaintext, <span class="keyword">sizeof</span>(plaintext));</div>
<div class="line"><span class="keywordflow">if</span> (ret != 0) {</div>
<div class="line">    <span class="comment">// handle error</span></div>
<div class="line">}</div>
<div class="line"><a class="code hl_function" href="#ga976e1b14c12dca0a43aebe9f70339739">wc_AesFree</a>(&amp;aes);</div>
<div class="ttc" id="agroup__AES_html_gaed7ca64828d8429b7c140941561c57a5"><div class="ttname"><a href="#gaed7ca64828d8429b7c140941561c57a5">wc_AesCtsEncryptUpdate</a></div><div class="ttdeci">int wc_AesCtsEncryptUpdate(Aes *aes, byte *out, word32 *outSz, const byte *in, word32 inSz)</div><div class="ttdoc">This function performs an update step of the AES CTS encryption. It processes a chunk of plaintext an...</div></div>
</div><!-- fragment --> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaf192cb665cccec364e60be89e5cd4b5b" title="This function performs an update step of the AES CTS decryption. It processes a chunk of ciphertext a...">wc_AesCtsDecryptUpdate</a> </dd></dl>

</div>
</div>
<a id="gac03c7c2d8fc31cb4bc4d26d8dcb10fd2" name="gac03c7c2d8fc31cb4bc4d26d8dcb10fd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac03c7c2d8fc31cb4bc4d26d8dcb10fd2">&#9670;&#160;</a></span>wc_AesDecryptDirect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesDecryptDirect </td>
          <td>(</td>
          <td class="paramtype">Aes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is a one-block decrypt of the input block, in, into the output block, out. It uses the key of the provided AES structure, which should be initialized with wc_AesSetKey before calling this function. wc_AesSetKey should have been called with the iv set to NULL. This is only enabled if the configure option WOLFSSL_AES_DIRECT is enabled. <b>Warning:</b> In nearly all use cases ECB mode is considered to be less secure. Please avoid using ECB API’s directly whenever possible. </p>
<dl class="section return"><dt>Returns</dt><dd>int integer values corresponding to wolfSSL error or success status</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>pointer to the AES object used to encrypt data </td></tr>
    <tr><td class="paramname">out</td><td>pointer to the output buffer in which to store the plain text of the decrypted cipher text </td></tr>
    <tr><td class="paramname">in</td><td>pointer to the input buffer containing cipher text to be decrypted</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Aes dec;</div>
<div class="line"><span class="comment">// initialize enc with wc_AesInit and wc_AesSetKey, using direction</span></div>
<div class="line"><span class="comment">// AES_DECRYPTION</span></div>
<div class="line"><span class="keywordtype">byte</span> cipher [AES_BLOCK_SIZE]; <span class="comment">// 16 bytes</span></div>
<div class="line"><span class="comment">// initialize cipher with cipher text to decrypt</span></div>
<div class="line"><span class="keywordtype">byte</span> msg[AES_BLOCK_SIZE];</div>
<div class="line"><a class="code hl_function" href="#gac03c7c2d8fc31cb4bc4d26d8dcb10fd2">wc_AesDecryptDirect</a>(&amp;dec, msg, cipher);</div>
<div class="ttc" id="agroup__AES_html_gac03c7c2d8fc31cb4bc4d26d8dcb10fd2"><div class="ttname"><a href="#gac03c7c2d8fc31cb4bc4d26d8dcb10fd2">wc_AesDecryptDirect</a></div><div class="ttdeci">int wc_AesDecryptDirect(Aes *aes, byte *out, const byte *in)</div><div class="ttdoc">This function is a one-block decrypt of the input block, in, into the output block,...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gadf98e960a0f388486fed8b4b576c7514" title="This function is a one-block encrypt of the input block, in, into the output block,...">wc_AesEncryptDirect</a> </dd>
<dd>
<a class="el" href="#gafc1e71615652e4870a7c3de627be5e9b" title="This function is used to set the AES keys for CTR mode with AES. It initializes an AES object with th...">wc_AesSetKeyDirect</a> </dd></dl>

</div>
</div>
<a id="ga8420179c682c323a07913b5172965478" name="ga8420179c682c323a07913b5172965478"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8420179c682c323a07913b5172965478">&#9670;&#160;</a></span>wc_AesEaxAuthDataUpdate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_AesEaxAuthDataUpdate </td>
          <td>(</td>
          <td class="paramtype">AesEax *</td>          <td class="paramname"><span class="paramname"><em>eax</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>authIn</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>authInSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function adds input data to the authentication stream. <code>eax</code> must have been previously initialized with a call to <a class="el" href="#ga828f06a8a61fcaae275559f64f9bcf34">wc_AesEaxInit</a>. </p>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd>
<dd>
error code on failure</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">eax</td><td>AES EAX structure holding the context of the AEAD operation </td></tr>
    <tr><td class="paramname">authIn</td><td>input data to add to the authentication stream </td></tr>
    <tr><td class="paramname">authInSz</td><td>size in bytes of the input authentication data</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">AesEax eax;</div>
<div class="line">key[]   = { some 16, 24, or 32 <span class="keywordtype">byte</span> length key };</div>
<div class="line">nonce[] = { some arbitrary length nonce };</div>
<div class="line">authIn[] = { some data to add to the authentication stream };</div>
<div class="line">cipherText[] = {some encrypted data};</div>
<div class="line"> </div>
<div class="line">plainText[<span class="keyword">sizeof</span>(cipherText)]; <span class="comment">// buffer to hold decrypted data</span></div>
<div class="line"><span class="comment">// auth tag is generated elsewhere by the encrypt AEAD operation</span></div>
<div class="line">authTag[length, up to AES_BLOCK_SIZE] = { the auth tag };</div>
<div class="line"> </div>
<div class="line">AesEax eax;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// No auth data to add here</span></div>
<div class="line"><span class="keywordflow">if</span> ((ret = <a class="code hl_function" href="#ga828f06a8a61fcaae275559f64f9bcf34">wc_AesEaxInit</a>(eax,</div>
<div class="line">                         key, keySz,</div>
<div class="line">                         nonce, nonceSz,</div>
<div class="line">                         NULL, 0)) != 0) {</div>
<div class="line">    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// No auth data to add here, added later with wc_AesEaxAuthDataUpdate</span></div>
<div class="line"><span class="keywordflow">if</span> ((ret = <a class="code hl_function" href="#ga43fa6d7e6e0f22bd0c10fc15abfb054b">wc_AesEaxDecryptUpdate</a>(eax,</div>
<div class="line">                                  plainText, cipherText, <span class="keyword">sizeof</span>(cipherText),</div>
<div class="line">                                  NULL, 0)) != 0) {</div>
<div class="line">    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> ((ret = <a class="code hl_function" href="#ga8420179c682c323a07913b5172965478">wc_AesEaxAuthDataUpdate</a>(eax, authIn, <span class="keyword">sizeof</span>(authIn))) != 0) {</div>
<div class="line">    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> ((ret = <a class="code hl_function" href="#gaad5366b06f2e8b07674d06451bf08082">wc_AesEaxDecryptFinal</a>(eax, authTag, <span class="keyword">sizeof</span>(authTag))) != 0) {</div>
<div class="line">    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">cleanup:</div>
<div class="line">    <a class="code hl_function" href="#gad4d997173c1afc8abba8140c635b0ca0">wc_AesEaxFree</a>(eax);</div>
<div class="ttc" id="agroup__AES_html_ga43fa6d7e6e0f22bd0c10fc15abfb054b"><div class="ttname"><a href="#ga43fa6d7e6e0f22bd0c10fc15abfb054b">wc_AesEaxDecryptUpdate</a></div><div class="ttdeci">WOLFSSL_API int wc_AesEaxDecryptUpdate(AesEax *eax, byte *out, const byte *in, word32 inSz, const byte *authIn, word32 authInSz)</div><div class="ttdoc">This function uses AES EAX to decrypt input data, and optionally, add more input data to the authenti...</div></div>
<div class="ttc" id="agroup__AES_html_ga828f06a8a61fcaae275559f64f9bcf34"><div class="ttname"><a href="#ga828f06a8a61fcaae275559f64f9bcf34">wc_AesEaxInit</a></div><div class="ttdeci">WOLFSSL_API int wc_AesEaxInit(AesEax *eax, const byte *key, word32 keySz, const byte *nonce, word32 nonceSz, const byte *authIn, word32 authInSz)</div><div class="ttdoc">This function initializes an AesEax object for use in authenticated encryption or decryption....</div></div>
<div class="ttc" id="agroup__AES_html_ga8420179c682c323a07913b5172965478"><div class="ttname"><a href="#ga8420179c682c323a07913b5172965478">wc_AesEaxAuthDataUpdate</a></div><div class="ttdeci">WOLFSSL_API int wc_AesEaxAuthDataUpdate(AesEax *eax, const byte *authIn, word32 authInSz)</div><div class="ttdoc">This function adds input data to the authentication stream. eax must have been previously initialized...</div></div>
<div class="ttc" id="agroup__AES_html_gaad5366b06f2e8b07674d06451bf08082"><div class="ttname"><a href="#gaad5366b06f2e8b07674d06451bf08082">wc_AesEaxDecryptFinal</a></div><div class="ttdeci">WOLFSSL_API int wc_AesEaxDecryptFinal(AesEax *eax, const byte *authIn, word32 authInSz)</div><div class="ttdoc">This function finalizes the decrypt AEAD operation, finalizing the auth tag computation and checking ...</div></div>
<div class="ttc" id="agroup__AES_html_gad4d997173c1afc8abba8140c635b0ca0"><div class="ttname"><a href="#gad4d997173c1afc8abba8140c635b0ca0">wc_AesEaxFree</a></div><div class="ttdeci">WOLFSSL_API int wc_AesEaxFree(AesEax *eax)</div><div class="ttdoc">This frees up any resources, specifically keys, used by the Aes instance inside the AesEax wrapper st...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga828f06a8a61fcaae275559f64f9bcf34" title="This function initializes an AesEax object for use in authenticated encryption or decryption....">wc_AesEaxInit</a> </dd>
<dd>
<a class="el" href="#ga22db03a2c23b9a24eef4191391c85147" title="This function uses AES EAX to encrypt input data, and optionally, add more input data to the authenti...">wc_AesEaxEncryptUpdate</a> </dd>
<dd>
<a class="el" href="#ga43fa6d7e6e0f22bd0c10fc15abfb054b" title="This function uses AES EAX to decrypt input data, and optionally, add more input data to the authenti...">wc_AesEaxDecryptUpdate</a> </dd>
<dd>
<a class="el" href="#ga7142a20798bd52058da5a89ab2c41a91" title="This function finalizes the encrypt AEAD operation, producing an auth tag over the current authentica...">wc_AesEaxEncryptFinal</a> </dd>
<dd>
<a class="el" href="#gaad5366b06f2e8b07674d06451bf08082" title="This function finalizes the decrypt AEAD operation, finalizing the auth tag computation and checking ...">wc_AesEaxDecryptFinal</a> </dd>
<dd>
<a class="el" href="#gad4d997173c1afc8abba8140c635b0ca0" title="This frees up any resources, specifically keys, used by the Aes instance inside the AesEax wrapper st...">wc_AesEaxFree</a> </dd></dl>

</div>
</div>
<a id="ga06d085c91a969020b4d6977dc6d08ef2" name="ga06d085c91a969020b4d6977dc6d08ef2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga06d085c91a969020b4d6977dc6d08ef2">&#9670;&#160;</a></span>wc_AesEaxDecryptAuth()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_AesEaxDecryptAuth </td>
          <td>(</td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>keySz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>inSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>nonce</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>nonceSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>authTag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>authTagSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>authIn</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>authInSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function performs AES EAX decryption and authentication as described in "EAX: A Conventional Authenticated-Encryption Mode" (<a href="https://eprint.iacr.org/2003/069">https://eprint.iacr.org/2003/069</a>). It is a "one-shot" API that performs all decryption and authentication operations in one function call. If a nonzero error code is returned, the output data is undefined. However, callers must unconditionally zeroize the output buffer to guard against leakage of cleartext data. </p>
<dl class="section return"><dt>Returns</dt><dd>0 on successful decryption </dd>
<dd>
BAD_FUNC_ARG if input or output buffers are NULL. Also returned if the key size isn't a valid AES key size (16, 24, or 32 bytes) </dd>
<dd>
AES_EAX_AUTH_E If the authentication tag does not match the supplied authentication code vector <code>authTag</code> </dd>
<dd>
other negative error values returned if AES or CMAC operations fail.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">key</td><td>byte buffer containing the key to use </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">keySz</td><td>length of the key buffer in bytes </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>buffer to hold the plaintext. Should be the same length as the input ciphertext buffer </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">in</td><td>ciphertext buffer to decrypt </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inSz</td><td>length of ciphertext buffer </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nonce</td><td>the cryptographic nonce to use for EAX operations </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nonceSz</td><td>length of nonce buffer in bytes </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">authTag</td><td>buffer that holds the authentication tag to check the authenticity of the data against </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">authTagSz</td><td>Length of the input authentication tag </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">authIn</td><td>pointer to the buffer containing input data to authenticate </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">authInSz</td><td>length of the input authentication data</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="keywordtype">byte</span> key[] = { some 32, 48, or 64 <span class="keywordtype">byte</span> key };</div>
<div class="line"><span class="keywordtype">byte</span> nonce[] = {0x04, 0x5, 0x6};</div>
<div class="line"><span class="keywordtype">byte</span> cipherText[] = {0xDE, 0xAD, 0xBE, 0xEF};</div>
<div class="line"><span class="keywordtype">byte</span> authIn[] = {0x01, 0x2, 0x3};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">byte</span> plainText[<span class="keyword">sizeof</span>(cipherText)]; <span class="comment">// output plaintext</span></div>
<div class="line"><span class="keywordtype">byte</span> authTag[length, up to AES_BLOCK_SIZE]; <span class="comment">// output authTag</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (wc_AesEaxDecrypt(key, <span class="keyword">sizeof</span>(key),</div>
<div class="line">                     cipherText, plainText, <span class="keyword">sizeof</span>(plainText),</div>
<div class="line">                     nonce, <span class="keyword">sizeof</span>(nonce),</div>
<div class="line">                     authTag, <span class="keyword">sizeof</span>(authTag),</div>
<div class="line">                     authIn, <span class="keyword">sizeof</span>(authIn)) != 0) {</div>
<div class="line">    <span class="comment">// failed to encrypt</span></div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga0f183ab13031accc6325eba552c113e1" title="This function performs AES EAX encryption and authentication as described in &quot;EAX: A Conventional Aut...">wc_AesEaxEncryptAuth</a> </dd></dl>

</div>
</div>
<a id="gaad5366b06f2e8b07674d06451bf08082" name="gaad5366b06f2e8b07674d06451bf08082"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaad5366b06f2e8b07674d06451bf08082">&#9670;&#160;</a></span>wc_AesEaxDecryptFinal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_AesEaxDecryptFinal </td>
          <td>(</td>
          <td class="paramtype">AesEax *</td>          <td class="paramname"><span class="paramname"><em>eax</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>authIn</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>authInSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function finalizes the decrypt AEAD operation, finalizing the auth tag computation and checking it for validity against the user supplied tag. <code>eax</code> must have been previously initialized with a call to <a class="el" href="#ga828f06a8a61fcaae275559f64f9bcf34">wc_AesEaxInit</a>. When done using the <code>AesEax</code> context structure, make sure to free it using <a class="el" href="#gad4d997173c1afc8abba8140c635b0ca0">wc_AesEaxFree</a>. </p>
<dl class="section return"><dt>Returns</dt><dd>0 if data is authenticated successfully </dd>
<dd>
AES_EAX_AUTH_E if the authentication tag does not match the supplied authentication code vector <code>authIn</code> </dd>
<dd>
other error code on failure</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">eax</td><td>AES EAX structure holding the context of the AEAD operation </td></tr>
    <tr><td class="paramname">authIn</td><td>input auth tag to check computed auth tag against </td></tr>
    <tr><td class="paramname">authInSz</td><td>size in bytes of <code>authIn</code> </td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">AesEax eax;</div>
<div class="line">key[]   = { some 16, 24, or 32 <span class="keywordtype">byte</span> length key };</div>
<div class="line">nonce[] = { some arbitrary length nonce };</div>
<div class="line">authIn[] = { some data to add to the authentication stream };</div>
<div class="line">cipherText[] = {some encrypted data};</div>
<div class="line"> </div>
<div class="line">plainText[<span class="keyword">sizeof</span>(cipherText)]; <span class="comment">// buffer to hold decrypted data</span></div>
<div class="line"><span class="comment">// auth tag is generated elsewhere by the encrypt AEAD operation</span></div>
<div class="line">authTag[length, up to AES_BLOCK_SIZE] = { the auth tag };</div>
<div class="line"> </div>
<div class="line">AesEax eax;</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> ((ret = <a class="code hl_function" href="#ga828f06a8a61fcaae275559f64f9bcf34">wc_AesEaxInit</a>(eax,</div>
<div class="line">                         key, keySz,</div>
<div class="line">                         nonce, nonceSz,</div>
<div class="line">                         authIn, authInSz)) != 0) {</div>
<div class="line">    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// if we wanted to add more auth data, we could provide it at this point,</span></div>
<div class="line"><span class="comment">// otherwise we use NULL for the authIn parameter, with authInSz of 0</span></div>
<div class="line"><span class="keywordflow">if</span> ((ret = <a class="code hl_function" href="#ga43fa6d7e6e0f22bd0c10fc15abfb054b">wc_AesEaxDecryptUpdate</a>(eax,</div>
<div class="line">                                  plainText, cipherText, <span class="keyword">sizeof</span>(cipherText),</div>
<div class="line">                                  NULL, 0)) != 0) {</div>
<div class="line">    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> ((ret = <a class="code hl_function" href="#gaad5366b06f2e8b07674d06451bf08082">wc_AesEaxDecryptFinal</a>(eax, authTag, <span class="keyword">sizeof</span>(authTag))) != 0) {</div>
<div class="line">    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">cleanup:</div>
<div class="line">    <a class="code hl_function" href="#gad4d997173c1afc8abba8140c635b0ca0">wc_AesEaxFree</a>(eax);</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga828f06a8a61fcaae275559f64f9bcf34" title="This function initializes an AesEax object for use in authenticated encryption or decryption....">wc_AesEaxInit</a> </dd>
<dd>
<a class="el" href="#ga22db03a2c23b9a24eef4191391c85147" title="This function uses AES EAX to encrypt input data, and optionally, add more input data to the authenti...">wc_AesEaxEncryptUpdate</a> </dd>
<dd>
<a class="el" href="#ga43fa6d7e6e0f22bd0c10fc15abfb054b" title="This function uses AES EAX to decrypt input data, and optionally, add more input data to the authenti...">wc_AesEaxDecryptUpdate</a> </dd>
<dd>
<a class="el" href="#ga8420179c682c323a07913b5172965478" title="This function adds input data to the authentication stream. eax must have been previously initialized...">wc_AesEaxAuthDataUpdate</a> </dd>
<dd>
<a class="el" href="#ga7142a20798bd52058da5a89ab2c41a91" title="This function finalizes the encrypt AEAD operation, producing an auth tag over the current authentica...">wc_AesEaxEncryptFinal</a> </dd>
<dd>
<a class="el" href="#gad4d997173c1afc8abba8140c635b0ca0" title="This frees up any resources, specifically keys, used by the Aes instance inside the AesEax wrapper st...">wc_AesEaxFree</a> </dd></dl>

</div>
</div>
<a id="ga43fa6d7e6e0f22bd0c10fc15abfb054b" name="ga43fa6d7e6e0f22bd0c10fc15abfb054b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga43fa6d7e6e0f22bd0c10fc15abfb054b">&#9670;&#160;</a></span>wc_AesEaxDecryptUpdate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_AesEaxDecryptUpdate </td>
          <td>(</td>
          <td class="paramtype">AesEax *</td>          <td class="paramname"><span class="paramname"><em>eax</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>inSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>authIn</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>authInSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function uses AES EAX to decrypt input data, and optionally, add more input data to the authentication stream. <code>eax</code> must have been previously initialized with a call to <a class="el" href="#ga828f06a8a61fcaae275559f64f9bcf34">wc_AesEaxInit</a>. </p>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd>
<dd>
error code on failure</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">eax</td><td>AES EAX structure holding the context of the AEAD operation </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>output buffer holding the decrypted plaintext </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">in</td><td>input buffer holding the ciphertext </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inSz</td><td>size in bytes of the input data buffer </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">authIn</td><td>(optional) input data to add to the authentication stream This argument should be NULL if not used </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">authInSz</td><td>size in bytes of the input authentication data</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">AesEax eax;</div>
<div class="line">key[]   = { some 16, 24, or 32 <span class="keywordtype">byte</span> length key };</div>
<div class="line">nonce[] = { some arbitrary length nonce };</div>
<div class="line">authIn[] = { some data to add to the authentication stream };</div>
<div class="line">cipherText[] = {some encrypted data};</div>
<div class="line"> </div>
<div class="line">plainText[<span class="keyword">sizeof</span>(cipherText)]; <span class="comment">// buffer to hold decrypted data</span></div>
<div class="line"><span class="comment">// auth tag is generated elsewhere by the encrypt AEAD operation</span></div>
<div class="line">authTag[length, up to AES_BLOCK_SIZE] = { the auth tag };</div>
<div class="line"> </div>
<div class="line">AesEax eax;</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> ((ret = <a class="code hl_function" href="#ga828f06a8a61fcaae275559f64f9bcf34">wc_AesEaxInit</a>(eax,</div>
<div class="line">                         key, keySz,</div>
<div class="line">                         nonce, nonceSz,</div>
<div class="line">                         authIn, authInSz)) != 0) {</div>
<div class="line">    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// if we wanted to add more auth data, we could provide it at this point,</span></div>
<div class="line"><span class="comment">// otherwise we use NULL for the authIn parameter, with authInSz of 0</span></div>
<div class="line"><span class="keywordflow">if</span> ((ret = <a class="code hl_function" href="#ga43fa6d7e6e0f22bd0c10fc15abfb054b">wc_AesEaxDecryptUpdate</a>(eax,</div>
<div class="line">                                  plainText, cipherText, <span class="keyword">sizeof</span>(cipherText),</div>
<div class="line">                                  NULL, 0)) != 0) {</div>
<div class="line">    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> ((ret = <a class="code hl_function" href="#gaad5366b06f2e8b07674d06451bf08082">wc_AesEaxDecryptFinal</a>(eax, authTag, <span class="keyword">sizeof</span>(authTag))) != 0) {</div>
<div class="line">    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">cleanup:</div>
<div class="line">    <a class="code hl_function" href="#gad4d997173c1afc8abba8140c635b0ca0">wc_AesEaxFree</a>(eax);</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga828f06a8a61fcaae275559f64f9bcf34" title="This function initializes an AesEax object for use in authenticated encryption or decryption....">wc_AesEaxInit</a> </dd>
<dd>
<a class="el" href="#ga22db03a2c23b9a24eef4191391c85147" title="This function uses AES EAX to encrypt input data, and optionally, add more input data to the authenti...">wc_AesEaxEncryptUpdate</a> </dd>
<dd>
<a class="el" href="#ga8420179c682c323a07913b5172965478" title="This function adds input data to the authentication stream. eax must have been previously initialized...">wc_AesEaxAuthDataUpdate</a> </dd>
<dd>
<a class="el" href="#ga7142a20798bd52058da5a89ab2c41a91" title="This function finalizes the encrypt AEAD operation, producing an auth tag over the current authentica...">wc_AesEaxEncryptFinal</a> </dd>
<dd>
<a class="el" href="#gaad5366b06f2e8b07674d06451bf08082" title="This function finalizes the decrypt AEAD operation, finalizing the auth tag computation and checking ...">wc_AesEaxDecryptFinal</a> </dd>
<dd>
<a class="el" href="#gad4d997173c1afc8abba8140c635b0ca0" title="This frees up any resources, specifically keys, used by the Aes instance inside the AesEax wrapper st...">wc_AesEaxFree</a> </dd></dl>

</div>
</div>
<a id="ga0f183ab13031accc6325eba552c113e1" name="ga0f183ab13031accc6325eba552c113e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0f183ab13031accc6325eba552c113e1">&#9670;&#160;</a></span>wc_AesEaxEncryptAuth()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_AesEaxEncryptAuth </td>
          <td>(</td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>keySz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>inSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>nonce</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>nonceSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>authTag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>authTagSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>authIn</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>authInSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function performs AES EAX encryption and authentication as described in "EAX: A Conventional Authenticated-Encryption Mode" (<a href="https://eprint.iacr.org/2003/069">https://eprint.iacr.org/2003/069</a>). It is a "one-shot" API that performs all encryption and authentication operations in one function call. </p>
<dl class="section return"><dt>Returns</dt><dd>0 on successful encryption. </dd>
<dd>
BAD_FUNC_ARG if input or output buffers are NULL. Also returned if the key size isn't a valid AES key size (16, 24, or 32 bytes) </dd>
<dd>
other negative error values returned if AES or CMAC operations fail.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">key</td><td>buffer containing the key to use </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">keySz</td><td>length of the key buffer in bytes </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>buffer to hold the ciphertext. Should be the same length as the plaintext buffer </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">in</td><td>plaintext buffer to encrypt </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inSz</td><td>length of plaintext buffer </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nonce</td><td>the cryptographic nonce to use for EAX operations </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nonceSz</td><td>length of nonce buffer in bytes </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">authTag</td><td>pointer to the buffer in which to store the authentication tag </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">authTagSz</td><td>length of the desired authentication tag </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">authIn</td><td>pointer to the buffer containing input data to authenticate </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">authInSz</td><td>length of the input authentication data</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="keywordtype">byte</span> key[] = { some 32, 48, or 64 <span class="keywordtype">byte</span> key };</div>
<div class="line"><span class="keywordtype">byte</span> nonce[] = {0x04, 0x5, 0x6};</div>
<div class="line"><span class="keywordtype">byte</span> plainText[] = {0xDE, 0xAD, 0xBE, 0xEF};</div>
<div class="line"><span class="keywordtype">byte</span> authIn[] = {0x01, 0x2, 0x3};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">byte</span> cipherText[<span class="keyword">sizeof</span>(plainText)]; <span class="comment">// output ciphertext</span></div>
<div class="line"><span class="keywordtype">byte</span> authTag[length, up to AES_BLOCK_SIZE]; <span class="comment">// output authTag</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (wc_AesEaxEncrypt(key, <span class="keyword">sizeof</span>(key),</div>
<div class="line">                     cipherText, plainText, <span class="keyword">sizeof</span>(plainText),</div>
<div class="line">                     nonce, <span class="keyword">sizeof</span>(nonce),</div>
<div class="line">                     authTag, <span class="keyword">sizeof</span>(authTag),</div>
<div class="line">                     authIn, <span class="keyword">sizeof</span>(authIn)) != 0) {</div>
<div class="line">    <span class="comment">// failed to encrypt</span></div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga06d085c91a969020b4d6977dc6d08ef2" title="This function performs AES EAX decryption and authentication as described in &quot;EAX: A Conventional Aut...">wc_AesEaxDecryptAuth</a> </dd></dl>

</div>
</div>
<a id="ga7142a20798bd52058da5a89ab2c41a91" name="ga7142a20798bd52058da5a89ab2c41a91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7142a20798bd52058da5a89ab2c41a91">&#9670;&#160;</a></span>wc_AesEaxEncryptFinal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_AesEaxEncryptFinal </td>
          <td>(</td>
          <td class="paramtype">AesEax *</td>          <td class="paramname"><span class="paramname"><em>eax</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>authTag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>authTagSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function finalizes the encrypt AEAD operation, producing an auth tag over the current authentication stream. <code>eax</code> must have been previously initialized with a call to <a class="el" href="#ga828f06a8a61fcaae275559f64f9bcf34">wc_AesEaxInit</a>. When done using the <code>AesEax</code> context structure, make sure to free it using <a class="el" href="#gad4d997173c1afc8abba8140c635b0ca0">wc_AesEaxFree</a>. </p>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd>
<dd>
error code on failure</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">eax</td><td>AES EAX structure holding the context of the AEAD operation </td></tr>
    <tr><td class="paramname">authTag[out]</td><td>buffer that will hold the computed auth tag </td></tr>
    <tr><td class="paramname">authTagSz</td><td>size in bytes of <code>authTag</code> </td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">AesEax eax;</div>
<div class="line">key[]   = { some 16, 24, or 32 <span class="keywordtype">byte</span> length key };</div>
<div class="line">nonce[] = { some arbitrary length nonce };</div>
<div class="line">authIn[] = { some data to add to the authentication stream };</div>
<div class="line">plainText[] = {some plaintext data to encrypt};</div>
<div class="line"> </div>
<div class="line">cipherText[<span class="keyword">sizeof</span>(plainText)]; <span class="comment">// buffer to hold cipherText</span></div>
<div class="line">authTag[length, up to AES_BLOCK_SIZE]; <span class="comment">// buffer to hold computed auth data</span></div>
<div class="line"> </div>
<div class="line">AesEax eax;</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> ((ret = <a class="code hl_function" href="#ga828f06a8a61fcaae275559f64f9bcf34">wc_AesEaxInit</a>(eax,</div>
<div class="line">                         key, keySz,</div>
<div class="line">                         nonce, nonceSz,</div>
<div class="line">                         authIn, authInSz)) != 0) {</div>
<div class="line">    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// if we wanted to add more auth data, we could provide it at this point,</span></div>
<div class="line"><span class="comment">// otherwise we use NULL for the authIn parameter, with authInSz of 0</span></div>
<div class="line"><span class="keywordflow">if</span> ((ret = <a class="code hl_function" href="#ga22db03a2c23b9a24eef4191391c85147">wc_AesEaxEncryptUpdate</a>(eax,</div>
<div class="line">                                  cipherText, plainText, <span class="keyword">sizeof</span>(plainText),</div>
<div class="line">                                  NULL, 0)) != 0) {</div>
<div class="line">    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> ((ret = <a class="code hl_function" href="#ga7142a20798bd52058da5a89ab2c41a91">wc_AesEaxEncryptFinal</a>(eax, authTag, <span class="keyword">sizeof</span>(authTag))) != 0) {</div>
<div class="line">    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">cleanup:</div>
<div class="line">    <a class="code hl_function" href="#gad4d997173c1afc8abba8140c635b0ca0">wc_AesEaxFree</a>(eax);</div>
<div class="ttc" id="agroup__AES_html_ga22db03a2c23b9a24eef4191391c85147"><div class="ttname"><a href="#ga22db03a2c23b9a24eef4191391c85147">wc_AesEaxEncryptUpdate</a></div><div class="ttdeci">WOLFSSL_API int wc_AesEaxEncryptUpdate(AesEax *eax, byte *out, const byte *in, word32 inSz, const byte *authIn, word32 authInSz)</div><div class="ttdoc">This function uses AES EAX to encrypt input data, and optionally, add more input data to the authenti...</div></div>
<div class="ttc" id="agroup__AES_html_ga7142a20798bd52058da5a89ab2c41a91"><div class="ttname"><a href="#ga7142a20798bd52058da5a89ab2c41a91">wc_AesEaxEncryptFinal</a></div><div class="ttdeci">WOLFSSL_API int wc_AesEaxEncryptFinal(AesEax *eax, byte *authTag, word32 authTagSz)</div><div class="ttdoc">This function finalizes the encrypt AEAD operation, producing an auth tag over the current authentica...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga828f06a8a61fcaae275559f64f9bcf34" title="This function initializes an AesEax object for use in authenticated encryption or decryption....">wc_AesEaxInit</a> </dd>
<dd>
<a class="el" href="#ga22db03a2c23b9a24eef4191391c85147" title="This function uses AES EAX to encrypt input data, and optionally, add more input data to the authenti...">wc_AesEaxEncryptUpdate</a> </dd>
<dd>
<a class="el" href="#ga43fa6d7e6e0f22bd0c10fc15abfb054b" title="This function uses AES EAX to decrypt input data, and optionally, add more input data to the authenti...">wc_AesEaxDecryptUpdate</a> </dd>
<dd>
<a class="el" href="#ga8420179c682c323a07913b5172965478" title="This function adds input data to the authentication stream. eax must have been previously initialized...">wc_AesEaxAuthDataUpdate</a> </dd>
<dd>
<a class="el" href="#gaad5366b06f2e8b07674d06451bf08082" title="This function finalizes the decrypt AEAD operation, finalizing the auth tag computation and checking ...">wc_AesEaxDecryptFinal</a> </dd>
<dd>
<a class="el" href="#gad4d997173c1afc8abba8140c635b0ca0" title="This frees up any resources, specifically keys, used by the Aes instance inside the AesEax wrapper st...">wc_AesEaxFree</a> </dd></dl>

</div>
</div>
<a id="ga22db03a2c23b9a24eef4191391c85147" name="ga22db03a2c23b9a24eef4191391c85147"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga22db03a2c23b9a24eef4191391c85147">&#9670;&#160;</a></span>wc_AesEaxEncryptUpdate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_AesEaxEncryptUpdate </td>
          <td>(</td>
          <td class="paramtype">AesEax *</td>          <td class="paramname"><span class="paramname"><em>eax</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>inSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>authIn</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>authInSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function uses AES EAX to encrypt input data, and optionally, add more input data to the authentication stream. <code>eax</code> must have been previously initialized with a call to <a class="el" href="#ga828f06a8a61fcaae275559f64f9bcf34">wc_AesEaxInit</a>. </p>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd>
<dd>
error code on failure</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">eax</td><td>AES EAX structure holding the context of the AEAD operation </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>output buffer holding the ciphertext </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">in</td><td>input buffer holding the plaintext to encrypt </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">inSz</td><td>size in bytes of the input data buffer </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">authIn</td><td>(optional) input data to add to the authentication stream This argument should be NULL if not used </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">authInSz</td><td>size in bytes of the input authentication data</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">AesEax eax;</div>
<div class="line">key[]   = { some 16, 24, or 32 <span class="keywordtype">byte</span> length key };</div>
<div class="line">nonce[] = { some arbitrary length nonce };</div>
<div class="line">authIn[] = { some data to add to the authentication stream };</div>
<div class="line">plainText[] = {some plaintext data to encrypt};</div>
<div class="line"> </div>
<div class="line">cipherText[<span class="keyword">sizeof</span>(plainText)]; <span class="comment">// buffer to hold cipherText</span></div>
<div class="line">authTag[length, up to AES_BLOCK_SIZE]; <span class="comment">// buffer to hold computed auth data</span></div>
<div class="line"> </div>
<div class="line">AesEax eax;</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> ((ret = <a class="code hl_function" href="#ga828f06a8a61fcaae275559f64f9bcf34">wc_AesEaxInit</a>(eax,</div>
<div class="line">                         key, keySz,</div>
<div class="line">                         nonce, nonceSz,</div>
<div class="line">                         authIn, authInSz)) != 0) {</div>
<div class="line">    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// if we wanted to add more auth data, we could provide it at this point,</span></div>
<div class="line"><span class="comment">// otherwise we use NULL for the authIn parameter, with authInSz of 0</span></div>
<div class="line"><span class="keywordflow">if</span> ((ret = <a class="code hl_function" href="#ga22db03a2c23b9a24eef4191391c85147">wc_AesEaxEncryptUpdate</a>(eax,</div>
<div class="line">                                  cipherText, plainText, <span class="keyword">sizeof</span>(plainText),</div>
<div class="line">                                  NULL, 0)) != 0) {</div>
<div class="line">    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> ((ret = <a class="code hl_function" href="#ga7142a20798bd52058da5a89ab2c41a91">wc_AesEaxEncryptFinal</a>(eax, authTag, <span class="keyword">sizeof</span>(authTag))) != 0) {</div>
<div class="line">    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">cleanup:</div>
<div class="line">    <a class="code hl_function" href="#gad4d997173c1afc8abba8140c635b0ca0">wc_AesEaxFree</a>(eax);</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga828f06a8a61fcaae275559f64f9bcf34" title="This function initializes an AesEax object for use in authenticated encryption or decryption....">wc_AesEaxInit</a> </dd>
<dd>
<a class="el" href="#ga43fa6d7e6e0f22bd0c10fc15abfb054b" title="This function uses AES EAX to decrypt input data, and optionally, add more input data to the authenti...">wc_AesEaxDecryptUpdate</a> </dd>
<dd>
<a class="el" href="#ga8420179c682c323a07913b5172965478" title="This function adds input data to the authentication stream. eax must have been previously initialized...">wc_AesEaxAuthDataUpdate</a> </dd>
<dd>
<a class="el" href="#ga7142a20798bd52058da5a89ab2c41a91" title="This function finalizes the encrypt AEAD operation, producing an auth tag over the current authentica...">wc_AesEaxEncryptFinal</a> </dd>
<dd>
<a class="el" href="#gaad5366b06f2e8b07674d06451bf08082" title="This function finalizes the decrypt AEAD operation, finalizing the auth tag computation and checking ...">wc_AesEaxDecryptFinal</a> </dd>
<dd>
<a class="el" href="#gad4d997173c1afc8abba8140c635b0ca0" title="This frees up any resources, specifically keys, used by the Aes instance inside the AesEax wrapper st...">wc_AesEaxFree</a> </dd></dl>

</div>
</div>
<a id="gad4d997173c1afc8abba8140c635b0ca0" name="gad4d997173c1afc8abba8140c635b0ca0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad4d997173c1afc8abba8140c635b0ca0">&#9670;&#160;</a></span>wc_AesEaxFree()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_AesEaxFree </td>
          <td>(</td>
          <td class="paramtype">AesEax *</td>          <td class="paramname"><span class="paramname"><em>eax</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This frees up any resources, specifically keys, used by the Aes instance inside the AesEax wrapper struct. It should be called on the AesEax struct after it has been initialized with wc_AesEaxInit, and all desired EAX operations are complete. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Success</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">eaxAES</td><td>EAX instance to free</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">AesEax eax;</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>(<a class="code hl_function" href="#ga828f06a8a61fcaae275559f64f9bcf34">wc_AesEaxInit</a>(eax, key, keySz, nonce, nonceSz, authIn, authInSz) != 0) {</div>
<div class="line">    <span class="comment">// handle errors, then free</span></div>
<div class="line">    <a class="code hl_function" href="#gad4d997173c1afc8abba8140c635b0ca0">wc_AesEaxFree</a>(&amp;eax);</div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga828f06a8a61fcaae275559f64f9bcf34" title="This function initializes an AesEax object for use in authenticated encryption or decryption....">wc_AesEaxInit</a> </dd>
<dd>
<a class="el" href="#ga22db03a2c23b9a24eef4191391c85147" title="This function uses AES EAX to encrypt input data, and optionally, add more input data to the authenti...">wc_AesEaxEncryptUpdate</a> </dd>
<dd>
<a class="el" href="#ga43fa6d7e6e0f22bd0c10fc15abfb054b" title="This function uses AES EAX to decrypt input data, and optionally, add more input data to the authenti...">wc_AesEaxDecryptUpdate</a> </dd>
<dd>
<a class="el" href="#ga8420179c682c323a07913b5172965478" title="This function adds input data to the authentication stream. eax must have been previously initialized...">wc_AesEaxAuthDataUpdate</a> </dd>
<dd>
<a class="el" href="#ga7142a20798bd52058da5a89ab2c41a91" title="This function finalizes the encrypt AEAD operation, producing an auth tag over the current authentica...">wc_AesEaxEncryptFinal</a> </dd>
<dd>
<a class="el" href="#gaad5366b06f2e8b07674d06451bf08082" title="This function finalizes the decrypt AEAD operation, finalizing the auth tag computation and checking ...">wc_AesEaxDecryptFinal</a> </dd></dl>

</div>
</div>
<a id="ga828f06a8a61fcaae275559f64f9bcf34" name="ga828f06a8a61fcaae275559f64f9bcf34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga828f06a8a61fcaae275559f64f9bcf34">&#9670;&#160;</a></span>wc_AesEaxInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_AesEaxInit </td>
          <td>(</td>
          <td class="paramtype">AesEax *</td>          <td class="paramname"><span class="paramname"><em>eax</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>keySz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>nonce</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>nonceSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>authIn</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>authInSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function initializes an AesEax object for use in authenticated encryption or decryption. This function must be called on an AesEax object before using it with any of the AES EAX incremental API functions. It does not need to be called if using the one-shot EAX API functions. All AesEax instances initialized with this function need to be freed with a call to <a class="el" href="#gad4d997173c1afc8abba8140c635b0ca0" title="This frees up any resources, specifically keys, used by the Aes instance inside the AesEax wrapper st...">wc_AesEaxFree()</a> when done using the instance. </p>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd>
<dd>
error code on failure</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">eax</td><td>AES EAX structure holding the context of the AEAD operation </td></tr>
    <tr><td class="paramname">key</td><td>16, 24, or 32 byte secret key for encryption and decryption </td></tr>
    <tr><td class="paramname">keySz</td><td>length of the supplied key in bytes </td></tr>
    <tr><td class="paramname">nonce</td><td>the cryptographic nonce to use for EAX operations </td></tr>
    <tr><td class="paramname">nonceSz</td><td>length of nonce buffer in bytes </td></tr>
    <tr><td class="paramname">authIn</td><td>(optional) input data to add to the authentication stream This argument should be NULL if not used </td></tr>
    <tr><td class="paramname">authInSz</td><td>size in bytes of the input authentication data</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">AesEax eax;</div>
<div class="line">key[]   = { some 16, 24, or 32 <span class="keywordtype">byte</span> length key };</div>
<div class="line">nonce[] = { some arbitrary length nonce };</div>
<div class="line">authIn[] = { some data to add to the authentication stream };</div>
<div class="line">plainText[] = {some plaintext data to encrypt};</div>
<div class="line"> </div>
<div class="line">cipherText[<span class="keyword">sizeof</span>(plainText)]; <span class="comment">// buffer to hold cipherText</span></div>
<div class="line">authTag[length, up to AES_BLOCK_SIZE]; <span class="comment">// buffer to hold computed auth data</span></div>
<div class="line"> </div>
<div class="line">AesEax eax;</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> ((ret = <a class="code hl_function" href="#ga828f06a8a61fcaae275559f64f9bcf34">wc_AesEaxInit</a>(eax,</div>
<div class="line">                         key, keySz,</div>
<div class="line">                         nonce, nonceSz,</div>
<div class="line">                         authIn, authInSz)) != 0) {</div>
<div class="line">    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// if we wanted to add more auth data, we could provide it at this point,</span></div>
<div class="line"><span class="comment">// otherwise we use NULL for the authIn parameter, with authIn size of 0</span></div>
<div class="line"><span class="keywordflow">if</span> ((ret = <a class="code hl_function" href="#ga22db03a2c23b9a24eef4191391c85147">wc_AesEaxEncryptUpdate</a>(eax,</div>
<div class="line">                                  cipherText, plainText, <span class="keyword">sizeof</span>(plainText),</div>
<div class="line">                                  NULL, 0)) != 0) {</div>
<div class="line">    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> ((ret = <a class="code hl_function" href="#ga7142a20798bd52058da5a89ab2c41a91">wc_AesEaxEncryptFinal</a>(eax, authTag, <span class="keyword">sizeof</span>(authTag))) != 0) {</div>
<div class="line">    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">cleanup:</div>
<div class="line">    <a class="code hl_function" href="#gad4d997173c1afc8abba8140c635b0ca0">wc_AesEaxFree</a>(eax);</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga22db03a2c23b9a24eef4191391c85147" title="This function uses AES EAX to encrypt input data, and optionally, add more input data to the authenti...">wc_AesEaxEncryptUpdate</a> </dd>
<dd>
<a class="el" href="#ga43fa6d7e6e0f22bd0c10fc15abfb054b" title="This function uses AES EAX to decrypt input data, and optionally, add more input data to the authenti...">wc_AesEaxDecryptUpdate</a> </dd>
<dd>
<a class="el" href="#ga8420179c682c323a07913b5172965478" title="This function adds input data to the authentication stream. eax must have been previously initialized...">wc_AesEaxAuthDataUpdate</a> </dd>
<dd>
<a class="el" href="#ga7142a20798bd52058da5a89ab2c41a91" title="This function finalizes the encrypt AEAD operation, producing an auth tag over the current authentica...">wc_AesEaxEncryptFinal</a> </dd>
<dd>
<a class="el" href="#gaad5366b06f2e8b07674d06451bf08082" title="This function finalizes the decrypt AEAD operation, finalizing the auth tag computation and checking ...">wc_AesEaxDecryptFinal</a> </dd>
<dd>
<a class="el" href="#gad4d997173c1afc8abba8140c635b0ca0" title="This frees up any resources, specifically keys, used by the Aes instance inside the AesEax wrapper st...">wc_AesEaxFree</a> </dd></dl>

</div>
</div>
<a id="gadf98e960a0f388486fed8b4b576c7514" name="gadf98e960a0f388486fed8b4b576c7514"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadf98e960a0f388486fed8b4b576c7514">&#9670;&#160;</a></span>wc_AesEncryptDirect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesEncryptDirect </td>
          <td>(</td>
          <td class="paramtype">Aes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is a one-block encrypt of the input block, in, into the output block, out. It uses the key of the provided AES structure, which should be initialized with wc_AesSetKey before calling this function. wc_AesSetKey should have been called with the iv set to NULL. This is only enabled if the configure option WOLFSSL_AES_DIRECT is enabled. <b>Warning:</b> In nearly all use cases ECB mode is considered to be less secure. Please avoid using ECB API’s directly whenever possible. </p>
<dl class="section return"><dt>Returns</dt><dd>int integer values corresponding to wolfSSL error or success status</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>pointer to the AES object used to encrypt data </td></tr>
    <tr><td class="paramname">out</td><td>pointer to the output buffer in which to store the cipher text of the encrypted message </td></tr>
    <tr><td class="paramname">in</td><td>pointer to the input buffer containing plain text to be encrypted</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Aes enc;</div>
<div class="line"><span class="comment">// initialize enc with wc_AesInit and wc_AesSetKey, using direction</span></div>
<div class="line"><span class="comment">// AES_ENCRYPTION</span></div>
<div class="line"><span class="keywordtype">byte</span> msg [AES_BLOCK_SIZE]; <span class="comment">// 16 bytes</span></div>
<div class="line"><span class="comment">// initialize msg with plain text to encrypt</span></div>
<div class="line"><span class="keywordtype">byte</span> cipher[AES_BLOCK_SIZE];</div>
<div class="line"><a class="code hl_function" href="#gadf98e960a0f388486fed8b4b576c7514">wc_AesEncryptDirect</a>(&amp;enc, cipher, msg);</div>
<div class="ttc" id="agroup__AES_html_gadf98e960a0f388486fed8b4b576c7514"><div class="ttname"><a href="#gadf98e960a0f388486fed8b4b576c7514">wc_AesEncryptDirect</a></div><div class="ttdeci">int wc_AesEncryptDirect(Aes *aes, byte *out, const byte *in)</div><div class="ttdoc">This function is a one-block encrypt of the input block, in, into the output block,...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gac03c7c2d8fc31cb4bc4d26d8dcb10fd2" title="This function is a one-block decrypt of the input block, in, into the output block,...">wc_AesDecryptDirect</a> </dd>
<dd>
<a class="el" href="#gafc1e71615652e4870a7c3de627be5e9b" title="This function is used to set the AES keys for CTR mode with AES. It initializes an AES object with th...">wc_AesSetKeyDirect</a> </dd></dl>

</div>
</div>
<a id="ga976e1b14c12dca0a43aebe9f70339739" name="ga976e1b14c12dca0a43aebe9f70339739"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga976e1b14c12dca0a43aebe9f70339739">&#9670;&#160;</a></span>wc_AesFree()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesFree </td>
          <td>(</td>
          <td class="paramtype">Aes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>free resources associated with the Aes structure when applicable. Internally may sometimes be a no-op but still recommended to call in all cases as a general best-practice (IE if application code is ported for use on new environments where the call is applicable). </p>
<dl class="section return"><dt>Returns</dt><dd>no return (void function)</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>aes structure in to free</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Aes enc;</div>
<div class="line"><span class="keywordtype">void</span>* hint = NULL;</div>
<div class="line"><span class="keywordtype">int</span> devId = INVALID_DEVID; <span class="comment">//if not using async INVALID_DEVID is default</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//heap hint could be set here if used</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ga430f0c344e8e8132bceec748483212c1">wc_AesInit</a>(&amp;enc, hint, devId);</div>
<div class="line"><span class="comment">// ... do some interesting things ...</span></div>
<div class="line"><a class="code hl_function" href="#ga976e1b14c12dca0a43aebe9f70339739">wc_AesFree</a>(&amp;enc);</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga430f0c344e8e8132bceec748483212c1" title="Initialize Aes structure. Sets heap hint to be used and ID for use with async hardware....">wc_AesInit</a> </dd></dl>

</div>
</div>
<a id="ga3abce2439b7cf22adbf5c800a9b79d7d" name="ga3abce2439b7cf22adbf5c800a9b79d7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3abce2439b7cf22adbf5c800a9b79d7d">&#9670;&#160;</a></span>wc_AesGcmDecrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesGcmDecrypt </td>
          <td>(</td>
          <td class="paramtype">Aes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>sz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>iv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>ivSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>authTag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>authTagSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>authIn</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>authInSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function decrypts the input cipher text, held in the buffer in, and stores the resulting message text in the output buffer out. It also checks the input authentication vector, authIn, against the supplied authentication tag, authTag. If a nonzero error code is returned, the output data is undefined. However, callers must unconditionally zeroize the output buffer to guard against leakage of cleartext data. </p>
<dl class="section return"><dt>Returns</dt><dd>0 On successfully decrypting and authenticating the input message </dd>
<dd>
AES_GCM_AUTH_E If the authentication tag does not match the supplied authentication code vector, authTag.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>pointer to the AES object used to encrypt data </td></tr>
    <tr><td class="paramname">out</td><td>pointer to the output buffer in which to store the message text size must match in's size (sz) </td></tr>
    <tr><td class="paramname">in</td><td>pointer to the input buffer holding the cipher text to decrypt size must be a multiple of AES_BLOCK_LENGTH, padded if necessary </td></tr>
    <tr><td class="paramname">sz</td><td>length of the cipher text to decrypt </td></tr>
    <tr><td class="paramname">iv</td><td>pointer to the buffer containing the initialization vector </td></tr>
    <tr><td class="paramname">ivSz</td><td>length of the initialization vector </td></tr>
    <tr><td class="paramname">authTag</td><td>pointer to the buffer containing the authentication tag </td></tr>
    <tr><td class="paramname">authTagSz</td><td>length of the desired authentication tag </td></tr>
    <tr><td class="paramname">authIn</td><td>pointer to the buffer containing the input authentication vector </td></tr>
    <tr><td class="paramname">authInSz</td><td>length of the input authentication vector</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Aes enc; <span class="comment">//can use the same struct as was passed to wc_AesGcmEncrypt</span></div>
<div class="line"><span class="comment">// initialize aes structure by calling wc_AesInit and wc_AesGcmSetKey</span></div>
<div class="line"><span class="comment">// if not already done</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">byte</span> cipher[AES_BLOCK_LENGTH * n]; <span class="comment">//n being a positive integer</span></div>
<div class="line">making cipher some multiple of 16 bytes</div>
<div class="line"><span class="comment">// initialize cipher with cipher text to decrypt</span></div>
<div class="line"><span class="keywordtype">byte</span> output[<span class="keyword">sizeof</span>(cipher)];</div>
<div class="line"><span class="keywordtype">byte</span> iv[] = <span class="comment">// some 16 byte iv</span></div>
<div class="line"><span class="keywordtype">byte</span> authTag[AUTH_TAG_LENGTH];</div>
<div class="line"><span class="keywordtype">byte</span> authIn[] = <span class="comment">// Authentication Vector</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ga3abce2439b7cf22adbf5c800a9b79d7d">wc_AesGcmDecrypt</a>(&amp;enc, output, cipher, <span class="keyword">sizeof</span>(cipher), iv, <span class="keyword">sizeof</span>(iv),</div>
<div class="line">        authTag, <span class="keyword">sizeof</span>(authTag), authIn, <span class="keyword">sizeof</span>(authIn));</div>
<div class="ttc" id="agroup__AES_html_ga3abce2439b7cf22adbf5c800a9b79d7d"><div class="ttname"><a href="#ga3abce2439b7cf22adbf5c800a9b79d7d">wc_AesGcmDecrypt</a></div><div class="ttdeci">int wc_AesGcmDecrypt(Aes *aes, byte *out, const byte *in, word32 sz, const byte *iv, word32 ivSz, const byte *authTag, word32 authTagSz, const byte *authIn, word32 authInSz)</div><div class="ttdoc">This function decrypts the input cipher text, held in the buffer in, and stores the resulting message...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga4d88b09e44908284d49ecbbfe389816b" title="This function is used to set the key for AES GCM (Galois/Counter Mode). It initializes an AES object ...">wc_AesGcmSetKey</a> </dd>
<dd>
<a class="el" href="#ga8ca2509cefd6a9d4b446c1ee38140fe1" title="This function encrypts the input message, held in the buffer in, and stores the resulting cipher text...">wc_AesGcmEncrypt</a> </dd></dl>

</div>
</div>
<a id="ga8ca2509cefd6a9d4b446c1ee38140fe1" name="ga8ca2509cefd6a9d4b446c1ee38140fe1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8ca2509cefd6a9d4b446c1ee38140fe1">&#9670;&#160;</a></span>wc_AesGcmEncrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesGcmEncrypt </td>
          <td>(</td>
          <td class="paramtype">Aes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>sz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>iv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>ivSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>authTag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>authTagSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>authIn</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>authInSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function encrypts the input message, held in the buffer in, and stores the resulting cipher text in the output buffer out. It requires a new iv (initialization vector) for each call to encrypt. It also encodes the input authentication vector, authIn, into the authentication tag, authTag. </p>
<dl class="section return"><dt>Returns</dt><dd>0 On successfully encrypting the input message</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>- pointer to the AES object used to encrypt data </td></tr>
    <tr><td class="paramname">out</td><td>pointer to the output buffer in which to store the cipher text size must match in's size (sz) </td></tr>
    <tr><td class="paramname">in</td><td>pointer to the input buffer holding the message to encrypt size must be a multiple of AES_BLOCK_LENGTH, padded if necessary </td></tr>
    <tr><td class="paramname">sz</td><td>length of the input message to encrypt </td></tr>
    <tr><td class="paramname">iv</td><td>pointer to the buffer containing the initialization vector </td></tr>
    <tr><td class="paramname">ivSz</td><td>length of the initialization vector </td></tr>
    <tr><td class="paramname">authTag</td><td>pointer to the buffer in which to store the authentication tag </td></tr>
    <tr><td class="paramname">authTagSz</td><td>length of the desired authentication tag </td></tr>
    <tr><td class="paramname">authIn</td><td>pointer to the buffer containing the input authentication vector </td></tr>
    <tr><td class="paramname">authInSz</td><td>length of the input authentication vector</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Aes enc;</div>
<div class="line"><span class="comment">// initialize Aes structure by calling wc_AesInit() and wc_AesGcmSetKey</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">byte</span> plain[AES_BLOCK_LENGTH * n]; <span class="comment">//n being a positive integer</span></div>
<div class="line">making plain some multiple of 16 bytes</div>
<div class="line"><span class="comment">// initialize plain with msg to encrypt</span></div>
<div class="line"><span class="keywordtype">byte</span> cipher[<span class="keyword">sizeof</span>(plain)];</div>
<div class="line"><span class="keywordtype">byte</span> iv[] = <span class="comment">// some 16 byte iv</span></div>
<div class="line"><span class="keywordtype">byte</span> authTag[AUTH_TAG_LENGTH];</div>
<div class="line"><span class="keywordtype">byte</span> authIn[] = <span class="comment">// Authentication Vector</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ga8ca2509cefd6a9d4b446c1ee38140fe1">wc_AesGcmEncrypt</a>(&amp;enc, cipher, plain, <span class="keyword">sizeof</span>(cipher), iv, <span class="keyword">sizeof</span>(iv),</div>
<div class="line">        authTag, <span class="keyword">sizeof</span>(authTag), authIn, <span class="keyword">sizeof</span>(authIn));</div>
<div class="ttc" id="agroup__AES_html_ga8ca2509cefd6a9d4b446c1ee38140fe1"><div class="ttname"><a href="#ga8ca2509cefd6a9d4b446c1ee38140fe1">wc_AesGcmEncrypt</a></div><div class="ttdeci">int wc_AesGcmEncrypt(Aes *aes, byte *out, const byte *in, word32 sz, const byte *iv, word32 ivSz, byte *authTag, word32 authTagSz, const byte *authIn, word32 authInSz)</div><div class="ttdoc">This function encrypts the input message, held in the buffer in, and stores the resulting cipher text...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga4d88b09e44908284d49ecbbfe389816b" title="This function is used to set the key for AES GCM (Galois/Counter Mode). It initializes an AES object ...">wc_AesGcmSetKey</a> </dd>
<dd>
<a class="el" href="#ga3abce2439b7cf22adbf5c800a9b79d7d" title="This function decrypts the input cipher text, held in the buffer in, and stores the resulting message...">wc_AesGcmDecrypt</a> </dd></dl>

</div>
</div>
<a id="ga4d88b09e44908284d49ecbbfe389816b" name="ga4d88b09e44908284d49ecbbfe389816b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4d88b09e44908284d49ecbbfe389816b">&#9670;&#160;</a></span>wc_AesGcmSetKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesGcmSetKey </td>
          <td>(</td>
          <td class="paramtype">Aes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is used to set the key for AES GCM (Galois/Counter Mode). It initializes an AES object with the given key. It is only enabled if the configure option HAVE_AESGCM is enabled at compile time. </p>
<dl class="section return"><dt>Returns</dt><dd>0 On successfully setting the key. </dd>
<dd>
BAD_FUNC_ARG Returned if the given key is an invalid length.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>pointer to the AES object used to encrypt data </td></tr>
    <tr><td class="paramname">key</td><td>16, 24, or 32 byte secret key for encryption and decryption </td></tr>
    <tr><td class="paramname">len</td><td>length of the key passed in</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Aes enc;</div>
<div class="line"><span class="keywordtype">int</span> ret = 0;</div>
<div class="line"><span class="keywordtype">byte</span> key[] = { some 16, 24,32 <span class="keywordtype">byte</span> key };</div>
<div class="line"><span class="keywordflow">if</span> (ret = <a class="code hl_function" href="#ga430f0c344e8e8132bceec748483212c1">wc_AesInit</a>(&amp;enc, HEAP_HINT, INVALID_DEVID) != 0) {</div>
<div class="line">    <span class="comment">// failed to initialize aes key</span></div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">if</span> (ret = <a class="code hl_function" href="#ga4d88b09e44908284d49ecbbfe389816b">wc_AesGcmSetKey</a>(&amp;enc, key, <span class="keyword">sizeof</span>(key)) != 0) {</div>
<div class="line"><span class="comment">// failed to set aes key</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__AES_html_ga4d88b09e44908284d49ecbbfe389816b"><div class="ttname"><a href="#ga4d88b09e44908284d49ecbbfe389816b">wc_AesGcmSetKey</a></div><div class="ttdeci">int wc_AesGcmSetKey(Aes *aes, const byte *key, word32 len)</div><div class="ttdoc">This function is used to set the key for AES GCM (Galois/Counter Mode). It initializes an AES object ...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga8ca2509cefd6a9d4b446c1ee38140fe1" title="This function encrypts the input message, held in the buffer in, and stores the resulting cipher text...">wc_AesGcmEncrypt</a> </dd>
<dd>
<a class="el" href="#ga3abce2439b7cf22adbf5c800a9b79d7d" title="This function decrypts the input cipher text, held in the buffer in, and stores the resulting message...">wc_AesGcmDecrypt</a> </dd></dl>

</div>
</div>
<a id="ga430f0c344e8e8132bceec748483212c1" name="ga430f0c344e8e8132bceec748483212c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga430f0c344e8e8132bceec748483212c1">&#9670;&#160;</a></span>wc_AesInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesInit </td>
          <td>(</td>
          <td class="paramtype">Aes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>heap</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>devId</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize Aes structure. Sets heap hint to be used and ID for use with async hardware. It is up to the user to call wc_AesFree on the Aes structure when done. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Success</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>aes structure in to initialize </td></tr>
    <tr><td class="paramname">heap</td><td>heap hint to use for malloc / free if needed </td></tr>
    <tr><td class="paramname">devId</td><td>ID to use with crypto callbacks or async hardware. Set to INVALID_DEVID (-2) if not used</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Aes enc;</div>
<div class="line"><span class="keywordtype">void</span>* hint = NULL;</div>
<div class="line"><span class="keywordtype">int</span> devId = INVALID_DEVID; <span class="comment">//if not using async INVALID_DEVID is default</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//heap hint could be set here if used</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ga430f0c344e8e8132bceec748483212c1">wc_AesInit</a>(&amp;enc, hint, devId);</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gad52b440a630fb94e4250a37b7682ab3b" title="This function initializes an AES structure by setting the key and then setting the initialization vec...">wc_AesSetKey</a> </dd>
<dd>
<a class="el" href="#ga58d80e002c87e2d5d1c8b01f0a7156fc" title="This function sets the initialization vector for a particular AES object. The AES object should be in...">wc_AesSetIV</a> </dd>
<dd>
<a class="el" href="#ga976e1b14c12dca0a43aebe9f70339739" title="free resources associated with the Aes structure when applicable. Internally may sometimes be a no-op...">wc_AesFree</a> </dd></dl>

</div>
</div>
<a id="ga58d80e002c87e2d5d1c8b01f0a7156fc" name="ga58d80e002c87e2d5d1c8b01f0a7156fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga58d80e002c87e2d5d1c8b01f0a7156fc">&#9670;&#160;</a></span>wc_AesSetIV()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesSetIV </td>
          <td>(</td>
          <td class="paramtype">Aes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>iv</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function sets the initialization vector for a particular AES object. The AES object should be initialized before calling this function. </p>
<dl class="section return"><dt>Returns</dt><dd>0 On successfully setting initialization vector. </dd>
<dd>
BAD_FUNC_ARG Returned if AES pointer is NULL.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>pointer to the AES structure on which to set the initialization vector </td></tr>
    <tr><td class="paramname">iv</td><td>initialization vector used to initialize the AES structure. If the value is NULL, the default action initializes the iv to 0.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Aes enc;</div>
<div class="line"><span class="comment">// set enc key</span></div>
<div class="line"><span class="keywordtype">byte</span> iv[]  = { some 16 <span class="keywordtype">byte</span> iv };</div>
<div class="line"><span class="keywordflow">if</span> (ret = <a class="code hl_function" href="#ga58d80e002c87e2d5d1c8b01f0a7156fc">wc_AesSetIV</a>(&amp;enc, iv) != 0) {</div>
<div class="line"><span class="comment">// failed to set aes iv</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__AES_html_ga58d80e002c87e2d5d1c8b01f0a7156fc"><div class="ttname"><a href="#ga58d80e002c87e2d5d1c8b01f0a7156fc">wc_AesSetIV</a></div><div class="ttdeci">int wc_AesSetIV(Aes *aes, const byte *iv)</div><div class="ttdoc">This function sets the initialization vector for a particular AES object. The AES object should be in...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gafc1e71615652e4870a7c3de627be5e9b" title="This function is used to set the AES keys for CTR mode with AES. It initializes an AES object with th...">wc_AesSetKeyDirect</a> </dd>
<dd>
<a class="el" href="#gad52b440a630fb94e4250a37b7682ab3b" title="This function initializes an AES structure by setting the key and then setting the initialization vec...">wc_AesSetKey</a> </dd></dl>

</div>
</div>
<a id="gad52b440a630fb94e4250a37b7682ab3b" name="gad52b440a630fb94e4250a37b7682ab3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad52b440a630fb94e4250a37b7682ab3b">&#9670;&#160;</a></span>wc_AesSetKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesSetKey </td>
          <td>(</td>
          <td class="paramtype">Aes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>iv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>dir</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function initializes an AES structure by setting the key and then setting the initialization vector. </p>
<dl class="section return"><dt>Returns</dt><dd>0 On successfully setting key and initialization vector. </dd>
<dd>
BAD_FUNC_ARG Returned if key length is invalid.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>pointer to the AES structure to modify </td></tr>
    <tr><td class="paramname">key</td><td>16, 24, or 32 byte secret key for encryption and decryption </td></tr>
    <tr><td class="paramname">len</td><td>length of the key passed in </td></tr>
    <tr><td class="paramname">iv</td><td>pointer to the initialization vector used to initialize the key </td></tr>
    <tr><td class="paramname">dir</td><td>Cipher direction. Set AES_ENCRYPTION to encrypt, or AES_DECRYPTION to decrypt. Direction for some modes (CFB and CTR) is always AES_ENCRYPTION.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Aes enc;</div>
<div class="line"><span class="keywordtype">int</span> ret = 0;</div>
<div class="line"><span class="keywordtype">byte</span> key[] = { some 16, 24 or 32 <span class="keywordtype">byte</span> key };</div>
<div class="line"><span class="keywordtype">byte</span> iv[]  = { some 16 <span class="keywordtype">byte</span> iv };</div>
<div class="line"><span class="keywordflow">if</span> (ret = <a class="code hl_function" href="#ga430f0c344e8e8132bceec748483212c1">wc_AesInit</a>(&amp;enc, HEAP_HINT, INVALID_DEVID) != 0) {</div>
<div class="line">    <span class="comment">// failed to initialize aes key</span></div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">if</span> (ret = <a class="code hl_function" href="#gad52b440a630fb94e4250a37b7682ab3b">wc_AesSetKey</a>(&amp;enc, key, AES_BLOCK_SIZE, iv,</div>
<div class="line">AES_ENCRYPTION) != 0) {</div>
<div class="line"><span class="comment">// failed to set aes key</span></div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gafc1e71615652e4870a7c3de627be5e9b" title="This function is used to set the AES keys for CTR mode with AES. It initializes an AES object with th...">wc_AesSetKeyDirect</a> </dd>
<dd>
<a class="el" href="#ga58d80e002c87e2d5d1c8b01f0a7156fc" title="This function sets the initialization vector for a particular AES object. The AES object should be in...">wc_AesSetIV</a> </dd></dl>

</div>
</div>
<a id="gafc1e71615652e4870a7c3de627be5e9b" name="gafc1e71615652e4870a7c3de627be5e9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafc1e71615652e4870a7c3de627be5e9b">&#9670;&#160;</a></span>wc_AesSetKeyDirect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesSetKeyDirect </td>
          <td>(</td>
          <td class="paramtype">Aes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>iv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>dir</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is used to set the AES keys for CTR mode with AES. It initializes an AES object with the given key, iv (initialization vector), and encryption dir (direction). It is only enabled if the configure option WOLFSSL_AES_DIRECT is enabled. Currently wc_AesSetKeyDirect uses wc_AesSetKey internally. <b>Warning:</b> In nearly all use cases ECB mode is considered to be less secure. Please avoid using ECB API’s directly whenever possible. </p>
<dl class="section return"><dt>Returns</dt><dd>0 On successfully setting the key. </dd>
<dd>
BAD_FUNC_ARG Returned if the given key is an invalid length.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>pointer to the AES object used to encrypt data </td></tr>
    <tr><td class="paramname">key</td><td>16, 24, or 32 byte secret key for encryption and decryption </td></tr>
    <tr><td class="paramname">len</td><td>length of the key passed in </td></tr>
    <tr><td class="paramname">iv</td><td>initialization vector used to initialize the key </td></tr>
    <tr><td class="paramname">dir</td><td>Cipher direction. Set AES_ENCRYPTION to encrypt, or AES_DECRYPTION to decrypt. (See enum in wolfssl/wolfcrypt/aes.h) (NOTE: If using wc_AesSetKeyDirect with Aes Counter mode (Stream cipher) only use AES_ENCRYPTION for both encrypting and decrypting)</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Aes enc;</div>
<div class="line"><span class="keywordtype">int</span> ret = 0;</div>
<div class="line"><span class="keywordtype">byte</span> key[] = { some 16, 24, or 32 <span class="keywordtype">byte</span> key };</div>
<div class="line"><span class="keywordtype">byte</span> iv[]  = { some 16 <span class="keywordtype">byte</span> iv };</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (ret = <a class="code hl_function" href="#ga430f0c344e8e8132bceec748483212c1">wc_AesInit</a>(&amp;enc, HEAP_HINT, INVALID_DEVID) != 0) {</div>
<div class="line">    <span class="comment">// failed to initialize aes key</span></div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">if</span> (ret = <a class="code hl_function" href="#gafc1e71615652e4870a7c3de627be5e9b">wc_AesSetKeyDirect</a>(&amp;enc, key, <span class="keyword">sizeof</span>(key), iv,</div>
<div class="line">AES_ENCRYPTION) != 0) {</div>
<div class="line"><span class="comment">// failed to set aes key</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__AES_html_gafc1e71615652e4870a7c3de627be5e9b"><div class="ttname"><a href="#gafc1e71615652e4870a7c3de627be5e9b">wc_AesSetKeyDirect</a></div><div class="ttdeci">int wc_AesSetKeyDirect(Aes *aes, const byte *key, word32 len, const byte *iv, int dir)</div><div class="ttdoc">This function is used to set the AES keys for CTR mode with AES. It initializes an AES object with th...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gadf98e960a0f388486fed8b4b576c7514" title="This function is a one-block encrypt of the input block, in, into the output block,...">wc_AesEncryptDirect</a> </dd>
<dd>
<a class="el" href="#gac03c7c2d8fc31cb4bc4d26d8dcb10fd2" title="This function is a one-block decrypt of the input block, in, into the output block,...">wc_AesDecryptDirect</a> </dd>
<dd>
<a class="el" href="#gad52b440a630fb94e4250a37b7682ab3b" title="This function initializes an AES structure by setting the key and then setting the initialization vec...">wc_AesSetKey</a> </dd></dl>

</div>
</div>
<a id="ga91be158d881bb0c56fa3a03660917da6" name="ga91be158d881bb0c56fa3a03660917da6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga91be158d881bb0c56fa3a03660917da6">&#9670;&#160;</a></span>wc_AesSivDecrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesSivDecrypt </td>
          <td>(</td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>keySz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>assoc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>assocSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>nonce</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>nonceSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>inSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>siv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function performs SIV (synthetic initialization vector) decryption as described in RFC 5297. If a nonzero error code is returned, the output data is undefined. However, callers must unconditionally zeroize the output buffer to guard against leakage of cleartext data. </p>
<dl class="section return"><dt>Returns</dt><dd>0 On successful decryption. </dd>
<dd>
BAD_FUNC_ARG If key, SIV, or output buffer are NULL. Also returned if the key size isn't 32, 48, or 64 bytes. </dd>
<dd>
AES_SIV_AUTH_E If the SIV derived by S2V doesn't match the input SIV (see RFC 5297 2.7). </dd>
<dd>
Other Other negative error values returned if AES or CMAC operations fail.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Byte buffer containing the key to use. </td></tr>
    <tr><td class="paramname">keySz</td><td>Length of the key buffer in bytes. </td></tr>
    <tr><td class="paramname">assoc</td><td>Additional, authenticated associated data (AD). </td></tr>
    <tr><td class="paramname">assocSz</td><td>Length of AD buffer in bytes. </td></tr>
    <tr><td class="paramname">nonce</td><td>A number used once. Used by the underlying algorithm in the same manner as the AD. </td></tr>
    <tr><td class="paramname">nonceSz</td><td>Length of nonce buffer in bytes. </td></tr>
    <tr><td class="paramname">in</td><td>Ciphertext buffer to decrypt. </td></tr>
    <tr><td class="paramname">inSz</td><td>Length of ciphertext buffer. </td></tr>
    <tr><td class="paramname">siv</td><td>The SIV that accompanies the ciphertext (see RFC 5297 2.4). </td></tr>
    <tr><td class="paramname">out</td><td>Buffer to hold the decrypted plaintext. Should be the same length as the ciphertext buffer.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="keywordtype">byte</span> key[] = { some 32, 48, or 64 <span class="keywordtype">byte</span> key };</div>
<div class="line"><span class="keywordtype">byte</span> assoc[] = {0x01, 0x2, 0x3};</div>
<div class="line"><span class="keywordtype">byte</span> nonce[] = {0x04, 0x5, 0x6};</div>
<div class="line"><span class="keywordtype">byte</span> cipherText[] = {0xDE, 0xAD, 0xBE, 0xEF};</div>
<div class="line"><span class="keywordtype">byte</span> siv[AES_BLOCK_SIZE] = { the SIV that came with the ciphertext };</div>
<div class="line"><span class="keywordtype">byte</span> plainText[<span class="keyword">sizeof</span>(cipherText)];</div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="#ga91be158d881bb0c56fa3a03660917da6">wc_AesSivDecrypt</a>(key, <span class="keyword">sizeof</span>(key), assoc, <span class="keyword">sizeof</span>(assoc), nonce,</div>
<div class="line">    <span class="keyword">sizeof</span>(nonce), cipherText, <span class="keyword">sizeof</span>(cipherText), siv, plainText) != 0) {</div>
<div class="line">    <span class="comment">// failed to decrypt</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__AES_html_ga91be158d881bb0c56fa3a03660917da6"><div class="ttname"><a href="#ga91be158d881bb0c56fa3a03660917da6">wc_AesSivDecrypt</a></div><div class="ttdeci">int wc_AesSivDecrypt(const byte *key, word32 keySz, const byte *assoc, word32 assocSz, const byte *nonce, word32 nonceSz, const byte *in, word32 inSz, byte *siv, byte *out)</div><div class="ttdoc">This function performs SIV (synthetic initialization vector) decryption as described in RFC 5297....</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga49ecb8fde33e33ad2287e4d28b74a5c7" title="This function performs SIV (synthetic initialization vector) encryption as described in RFC 5297.">wc_AesSivEncrypt</a> </dd></dl>

</div>
</div>
<a id="ga49ecb8fde33e33ad2287e4d28b74a5c7" name="ga49ecb8fde33e33ad2287e4d28b74a5c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga49ecb8fde33e33ad2287e4d28b74a5c7">&#9670;&#160;</a></span>wc_AesSivEncrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesSivEncrypt </td>
          <td>(</td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>keySz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>assoc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>assocSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>nonce</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>nonceSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>inSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>siv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function performs SIV (synthetic initialization vector) encryption as described in RFC 5297. </p>
<dl class="section return"><dt>Returns</dt><dd>0 On successful encryption. </dd>
<dd>
BAD_FUNC_ARG If key, SIV, or output buffer are NULL. Also returned if the key size isn't 32, 48, or 64 bytes. </dd>
<dd>
Other Other negative error values returned if AES or CMAC operations fail.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Byte buffer containing the key to use. </td></tr>
    <tr><td class="paramname">keySz</td><td>Length of the key buffer in bytes. </td></tr>
    <tr><td class="paramname">assoc</td><td>Additional, authenticated associated data (AD). </td></tr>
    <tr><td class="paramname">assocSz</td><td>Length of AD buffer in bytes. </td></tr>
    <tr><td class="paramname">nonce</td><td>A number used once. Used by the algorithm in the same manner as the AD. </td></tr>
    <tr><td class="paramname">nonceSz</td><td>Length of nonce buffer in bytes. </td></tr>
    <tr><td class="paramname">in</td><td>Plaintext buffer to encrypt. </td></tr>
    <tr><td class="paramname">inSz</td><td>Length of plaintext buffer. </td></tr>
    <tr><td class="paramname">siv</td><td>The SIV output by S2V (see RFC 5297 2.4). </td></tr>
    <tr><td class="paramname">out</td><td>Buffer to hold the ciphertext. Should be the same length as the plaintext buffer.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="keywordtype">byte</span> key[] = { some 32, 48, or 64 <span class="keywordtype">byte</span> key };</div>
<div class="line"><span class="keywordtype">byte</span> assoc[] = {0x01, 0x2, 0x3};</div>
<div class="line"><span class="keywordtype">byte</span> nonce[] = {0x04, 0x5, 0x6};</div>
<div class="line"><span class="keywordtype">byte</span> plainText[] = {0xDE, 0xAD, 0xBE, 0xEF};</div>
<div class="line"><span class="keywordtype">byte</span> siv[AES_BLOCK_SIZE];</div>
<div class="line"><span class="keywordtype">byte</span> cipherText[<span class="keyword">sizeof</span>(plainText)];</div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="#ga49ecb8fde33e33ad2287e4d28b74a5c7">wc_AesSivEncrypt</a>(key, <span class="keyword">sizeof</span>(key), assoc, <span class="keyword">sizeof</span>(assoc), nonce,</div>
<div class="line">    <span class="keyword">sizeof</span>(nonce), plainText, <span class="keyword">sizeof</span>(plainText), siv, cipherText) != 0) {</div>
<div class="line">    <span class="comment">// failed to encrypt</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__AES_html_ga49ecb8fde33e33ad2287e4d28b74a5c7"><div class="ttname"><a href="#ga49ecb8fde33e33ad2287e4d28b74a5c7">wc_AesSivEncrypt</a></div><div class="ttdeci">int wc_AesSivEncrypt(const byte *key, word32 keySz, const byte *assoc, word32 assocSz, const byte *nonce, word32 nonceSz, const byte *in, word32 inSz, byte *siv, byte *out)</div><div class="ttdoc">This function performs SIV (synthetic initialization vector) encryption as described in RFC 5297.</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga91be158d881bb0c56fa3a03660917da6" title="This function performs SIV (synthetic initialization vector) decryption as described in RFC 5297....">wc_AesSivDecrypt</a> </dd></dl>

</div>
</div>
<a id="gad3aea81076e797ce28aa77e9cd610779" name="gad3aea81076e797ce28aa77e9cd610779"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad3aea81076e797ce28aa77e9cd610779">&#9670;&#160;</a></span>wc_AesXtsDecrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesXtsDecrypt </td>
          <td>(</td>
          <td class="paramtype">XtsAes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>sz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>i</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>iSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Same process as encryption but Aes key is AES_DECRYPTION type. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Success</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>AES keys to use for block encrypt/decrypt </td></tr>
    <tr><td class="paramname">out</td><td>output buffer to hold plain text </td></tr>
    <tr><td class="paramname">in</td><td>input cipher text buffer to decrypt </td></tr>
    <tr><td class="paramname">sz</td><td>size of both out and in buffers </td></tr>
    <tr><td class="paramname">i</td><td>value to use for tweak </td></tr>
    <tr><td class="paramname">iSz</td><td>size of i buffer, should always be AES_BLOCK_SIZE but having this input adds a sanity check on how the user calls the function.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">XtsAes aes;</div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> plain[SIZE];</div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> cipher[SIZE];</div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> i[AES_BLOCK_SIZE];</div>
<div class="line"> </div>
<div class="line"><span class="comment">//set up key with AES_DECRYPTION as dir and tweak with AES_ENCRYPTION</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>(<a class="code hl_function" href="#gad3aea81076e797ce28aa77e9cd610779">wc_AesXtsDecrypt</a>(&amp;aes, plain, cipher, SIZE, i, <span class="keyword">sizeof</span>(i)) != 0)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Handle error</span></div>
<div class="line">}</div>
<div class="line"><a class="code hl_function" href="#ga8d63d909dd415e2954daec23cb4851ab">wc_AesXtsFree</a>(&amp;aes);</div>
<div class="ttc" id="agroup__AES_html_ga8d63d909dd415e2954daec23cb4851ab"><div class="ttname"><a href="#ga8d63d909dd415e2954daec23cb4851ab">wc_AesXtsFree</a></div><div class="ttdeci">int wc_AesXtsFree(XtsAes *aes)</div><div class="ttdoc">This is to free up any resources used by the XtsAes structure.</div></div>
<div class="ttc" id="agroup__AES_html_gad3aea81076e797ce28aa77e9cd610779"><div class="ttname"><a href="#gad3aea81076e797ce28aa77e9cd610779">wc_AesXtsDecrypt</a></div><div class="ttdeci">int wc_AesXtsDecrypt(XtsAes *aes, byte *out, const byte *in, word32 sz, const byte *i, word32 iSz)</div><div class="ttdoc">Same process as encryption but Aes key is AES_DECRYPTION type.</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga0372af5fdae94d196c977e28c3e35a81" title="AES with XTS mode. (XTS) XEX encryption with Tweak and cipher text Stealing.">wc_AesXtsEncrypt</a> </dd>
<dd>
<a class="el" href="#ga01b5393003225bd3ed93c5e3bb73a184" title="This is to initialize an AES-XTS context. It is up to user to call wc_AesXtsFree on aes key when done...">wc_AesXtsInit</a> </dd>
<dd>
<a class="el" href="#ga8b89849095c6d10b248dd2ccf6dff5e7" title="This is to help with setting keys to correct encrypt or decrypt type, after first calling wc_AesXtsIn...">wc_AesXtsSetKeyNoInit</a> </dd>
<dd>
<a class="el" href="#gaa1a5c32613382ca969ef11b875752f51" title="This is to help with setting keys to correct encrypt or decrypt type. It is up to user to call wc_Aes...">wc_AesXtsSetKey</a> </dd>
<dd>
<a class="el" href="#ga8d63d909dd415e2954daec23cb4851ab" title="This is to free up any resources used by the XtsAes structure.">wc_AesXtsFree</a> </dd></dl>

</div>
</div>
<a id="ga656aa1de00e3d73649726a9303ac863d" name="ga656aa1de00e3d73649726a9303ac863d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga656aa1de00e3d73649726a9303ac863d">&#9670;&#160;</a></span>wc_AesXtsDecryptSector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesXtsDecryptSector </td>
          <td>(</td>
          <td class="paramtype">XtsAes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>sz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word64</td>          <td class="paramname"><span class="paramname"><em>sector</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Same process as wc_AesXtsDecrypt but uses a word64 type as the tweak value instead of a byte array. This just converts the word64 to a byte array. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Success</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>AES keys to use for block encrypt/decrypt </td></tr>
    <tr><td class="paramname">out</td><td>output buffer to hold plain text </td></tr>
    <tr><td class="paramname">in</td><td>input cipher text buffer to decrypt </td></tr>
    <tr><td class="paramname">sz</td><td>size of both out and in buffers </td></tr>
    <tr><td class="paramname">sector</td><td>value to use for tweak</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">XtsAes aes;</div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> plain[SIZE];</div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> cipher[SIZE];</div>
<div class="line">word64 s = VALUE;</div>
<div class="line"> </div>
<div class="line"><span class="comment">//set up aes key with AES_DECRYPTION as dir and tweak with AES_ENCRYPTION</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>(<a class="code hl_function" href="#ga656aa1de00e3d73649726a9303ac863d">wc_AesXtsDecryptSector</a>(&amp;aes, plain, cipher, SIZE, s) != 0)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Handle error</span></div>
<div class="line">}</div>
<div class="line"><a class="code hl_function" href="#ga8d63d909dd415e2954daec23cb4851ab">wc_AesXtsFree</a>(&amp;aes);</div>
<div class="ttc" id="agroup__AES_html_ga656aa1de00e3d73649726a9303ac863d"><div class="ttname"><a href="#ga656aa1de00e3d73649726a9303ac863d">wc_AesXtsDecryptSector</a></div><div class="ttdeci">int wc_AesXtsDecryptSector(XtsAes *aes, byte *out, const byte *in, word32 sz, word64 sector)</div><div class="ttdoc">Same process as wc_AesXtsDecrypt but uses a word64 type as the tweak value instead of a byte array....</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga0372af5fdae94d196c977e28c3e35a81" title="AES with XTS mode. (XTS) XEX encryption with Tweak and cipher text Stealing.">wc_AesXtsEncrypt</a> </dd>
<dd>
<a class="el" href="#gad3aea81076e797ce28aa77e9cd610779" title="Same process as encryption but Aes key is AES_DECRYPTION type.">wc_AesXtsDecrypt</a> </dd>
<dd>
<a class="el" href="#ga01b5393003225bd3ed93c5e3bb73a184" title="This is to initialize an AES-XTS context. It is up to user to call wc_AesXtsFree on aes key when done...">wc_AesXtsInit</a> </dd>
<dd>
<a class="el" href="#ga8b89849095c6d10b248dd2ccf6dff5e7" title="This is to help with setting keys to correct encrypt or decrypt type, after first calling wc_AesXtsIn...">wc_AesXtsSetKeyNoInit</a> </dd>
<dd>
<a class="el" href="#gaa1a5c32613382ca969ef11b875752f51" title="This is to help with setting keys to correct encrypt or decrypt type. It is up to user to call wc_Aes...">wc_AesXtsSetKey</a> </dd>
<dd>
<a class="el" href="#ga8d63d909dd415e2954daec23cb4851ab" title="This is to free up any resources used by the XtsAes structure.">wc_AesXtsFree</a> </dd></dl>

</div>
</div>
<a id="ga0372af5fdae94d196c977e28c3e35a81" name="ga0372af5fdae94d196c977e28c3e35a81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0372af5fdae94d196c977e28c3e35a81">&#9670;&#160;</a></span>wc_AesXtsEncrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesXtsEncrypt </td>
          <td>(</td>
          <td class="paramtype">XtsAes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>sz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>i</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>iSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>AES with XTS mode. (XTS) XEX encryption with Tweak and cipher text Stealing. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Success</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>AES keys to use for block encrypt/decrypt </td></tr>
    <tr><td class="paramname">out</td><td>output buffer to hold cipher text </td></tr>
    <tr><td class="paramname">in</td><td>input plain text buffer to encrypt </td></tr>
    <tr><td class="paramname">sz</td><td>size of both out and in buffers </td></tr>
    <tr><td class="paramname">i</td><td>value to use for tweak </td></tr>
    <tr><td class="paramname">iSz</td><td>size of i buffer, should always be AES_BLOCK_SIZE but having this input adds a sanity check on how the user calls the function.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">XtsAes aes;</div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> plain[SIZE];</div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> cipher[SIZE];</div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> i[AES_BLOCK_SIZE];</div>
<div class="line"> </div>
<div class="line"><span class="comment">//set up key with AES_ENCRYPTION as dir</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>(<a class="code hl_function" href="#ga0372af5fdae94d196c977e28c3e35a81">wc_AesXtsEncrypt</a>(&amp;aes, cipher, plain, SIZE, i, <span class="keyword">sizeof</span>(i)) != 0)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Handle error</span></div>
<div class="line">}</div>
<div class="line"><a class="code hl_function" href="#ga8d63d909dd415e2954daec23cb4851ab">wc_AesXtsFree</a>(&amp;aes);</div>
<div class="ttc" id="agroup__AES_html_ga0372af5fdae94d196c977e28c3e35a81"><div class="ttname"><a href="#ga0372af5fdae94d196c977e28c3e35a81">wc_AesXtsEncrypt</a></div><div class="ttdeci">int wc_AesXtsEncrypt(XtsAes *aes, byte *out, const byte *in, word32 sz, const byte *i, word32 iSz)</div><div class="ttdoc">AES with XTS mode. (XTS) XEX encryption with Tweak and cipher text Stealing.</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gad3aea81076e797ce28aa77e9cd610779" title="Same process as encryption but Aes key is AES_DECRYPTION type.">wc_AesXtsDecrypt</a> </dd>
<dd>
<a class="el" href="#ga01b5393003225bd3ed93c5e3bb73a184" title="This is to initialize an AES-XTS context. It is up to user to call wc_AesXtsFree on aes key when done...">wc_AesXtsInit</a> </dd>
<dd>
<a class="el" href="#ga8b89849095c6d10b248dd2ccf6dff5e7" title="This is to help with setting keys to correct encrypt or decrypt type, after first calling wc_AesXtsIn...">wc_AesXtsSetKeyNoInit</a> </dd>
<dd>
<a class="el" href="#gaa1a5c32613382ca969ef11b875752f51" title="This is to help with setting keys to correct encrypt or decrypt type. It is up to user to call wc_Aes...">wc_AesXtsSetKey</a> </dd>
<dd>
<a class="el" href="#ga8d63d909dd415e2954daec23cb4851ab" title="This is to free up any resources used by the XtsAes structure.">wc_AesXtsFree</a> </dd></dl>

</div>
</div>
<a id="gaf06ea9dce97f3bda7d1ce373c6a917c3" name="gaf06ea9dce97f3bda7d1ce373c6a917c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf06ea9dce97f3bda7d1ce373c6a917c3">&#9670;&#160;</a></span>wc_AesXtsEncryptSector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesXtsEncryptSector </td>
          <td>(</td>
          <td class="paramtype">XtsAes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>sz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word64</td>          <td class="paramname"><span class="paramname"><em>sector</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Same process as wc_AesXtsEncrypt but uses a word64 type as the tweak value instead of a byte array. This just converts the word64 to a byte array and calls wc_AesXtsEncrypt. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Success</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>AES keys to use for block encrypt/decrypt </td></tr>
    <tr><td class="paramname">out</td><td>output buffer to hold cipher text </td></tr>
    <tr><td class="paramname">in</td><td>input plain text buffer to encrypt </td></tr>
    <tr><td class="paramname">sz</td><td>size of both out and in buffers </td></tr>
    <tr><td class="paramname">sector</td><td>value to use for tweak</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">XtsAes aes;</div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> plain[SIZE];</div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> cipher[SIZE];</div>
<div class="line">word64 s = VALUE;</div>
<div class="line"> </div>
<div class="line"><span class="comment">//set up keys with AES_ENCRYPTION as dir</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>(<a class="code hl_function" href="#gaf06ea9dce97f3bda7d1ce373c6a917c3">wc_AesXtsEncryptSector</a>(&amp;aes, cipher, plain, SIZE, s) != 0)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Handle error</span></div>
<div class="line">}</div>
<div class="line"><a class="code hl_function" href="#ga8d63d909dd415e2954daec23cb4851ab">wc_AesXtsFree</a>(&amp;aes);</div>
<div class="ttc" id="agroup__AES_html_gaf06ea9dce97f3bda7d1ce373c6a917c3"><div class="ttname"><a href="#gaf06ea9dce97f3bda7d1ce373c6a917c3">wc_AesXtsEncryptSector</a></div><div class="ttdeci">int wc_AesXtsEncryptSector(XtsAes *aes, byte *out, const byte *in, word32 sz, word64 sector)</div><div class="ttdoc">Same process as wc_AesXtsEncrypt but uses a word64 type as the tweak value instead of a byte array....</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga0372af5fdae94d196c977e28c3e35a81" title="AES with XTS mode. (XTS) XEX encryption with Tweak and cipher text Stealing.">wc_AesXtsEncrypt</a> </dd>
<dd>
<a class="el" href="#gad3aea81076e797ce28aa77e9cd610779" title="Same process as encryption but Aes key is AES_DECRYPTION type.">wc_AesXtsDecrypt</a> </dd>
<dd>
<a class="el" href="#ga01b5393003225bd3ed93c5e3bb73a184" title="This is to initialize an AES-XTS context. It is up to user to call wc_AesXtsFree on aes key when done...">wc_AesXtsInit</a> </dd>
<dd>
<a class="el" href="#ga8b89849095c6d10b248dd2ccf6dff5e7" title="This is to help with setting keys to correct encrypt or decrypt type, after first calling wc_AesXtsIn...">wc_AesXtsSetKeyNoInit</a> </dd>
<dd>
<a class="el" href="#gaa1a5c32613382ca969ef11b875752f51" title="This is to help with setting keys to correct encrypt or decrypt type. It is up to user to call wc_Aes...">wc_AesXtsSetKey</a> </dd>
<dd>
<a class="el" href="#ga8d63d909dd415e2954daec23cb4851ab" title="This is to free up any resources used by the XtsAes structure.">wc_AesXtsFree</a> </dd></dl>

</div>
</div>
<a id="ga8d63d909dd415e2954daec23cb4851ab" name="ga8d63d909dd415e2954daec23cb4851ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8d63d909dd415e2954daec23cb4851ab">&#9670;&#160;</a></span>wc_AesXtsFree()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesXtsFree </td>
          <td>(</td>
          <td class="paramtype">XtsAes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is to free up any resources used by the XtsAes structure. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Success</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>AES keys to free</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">XtsAes aes;</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>(<a class="code hl_function" href="#gaa1a5c32613382ca969ef11b875752f51">wc_AesXtsSetKey</a>(&amp;aes, key, <span class="keyword">sizeof</span>(key), AES_ENCRYPTION, NULL, 0) != 0)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Handle error</span></div>
<div class="line">}</div>
<div class="line"><a class="code hl_function" href="#ga8d63d909dd415e2954daec23cb4851ab">wc_AesXtsFree</a>(&amp;aes);</div>
<div class="ttc" id="agroup__AES_html_gaa1a5c32613382ca969ef11b875752f51"><div class="ttname"><a href="#gaa1a5c32613382ca969ef11b875752f51">wc_AesXtsSetKey</a></div><div class="ttdeci">int wc_AesXtsSetKey(XtsAes *aes, const byte *key, word32 len, int dir, void *heap, int devId)</div><div class="ttdoc">This is to help with setting keys to correct encrypt or decrypt type. It is up to user to call wc_Aes...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga0372af5fdae94d196c977e28c3e35a81" title="AES with XTS mode. (XTS) XEX encryption with Tweak and cipher text Stealing.">wc_AesXtsEncrypt</a> </dd>
<dd>
<a class="el" href="#gad3aea81076e797ce28aa77e9cd610779" title="Same process as encryption but Aes key is AES_DECRYPTION type.">wc_AesXtsDecrypt</a> </dd>
<dd>
<a class="el" href="#ga01b5393003225bd3ed93c5e3bb73a184" title="This is to initialize an AES-XTS context. It is up to user to call wc_AesXtsFree on aes key when done...">wc_AesXtsInit</a> </dd>
<dd>
<a class="el" href="#ga8b89849095c6d10b248dd2ccf6dff5e7" title="This is to help with setting keys to correct encrypt or decrypt type, after first calling wc_AesXtsIn...">wc_AesXtsSetKeyNoInit</a> </dd>
<dd>
<a class="el" href="#gaa1a5c32613382ca969ef11b875752f51" title="This is to help with setting keys to correct encrypt or decrypt type. It is up to user to call wc_Aes...">wc_AesXtsSetKey</a> </dd></dl>

</div>
</div>
<a id="ga01b5393003225bd3ed93c5e3bb73a184" name="ga01b5393003225bd3ed93c5e3bb73a184"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga01b5393003225bd3ed93c5e3bb73a184">&#9670;&#160;</a></span>wc_AesXtsInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesXtsInit </td>
          <td>(</td>
          <td class="paramtype">XtsAes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>heap</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>devId</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is to initialize an AES-XTS context. It is up to user to call wc_AesXtsFree on aes key when done. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Success</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>AES keys for encrypt/decrypt process </td></tr>
    <tr><td class="paramname">heap</td><td>heap hint to use for memory. Can be NULL </td></tr>
    <tr><td class="paramname">devId</td><td>ID to use with crypto callbacks or async hardware. Set to INVALID_DEVID (-2) if not used</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">XtsAes aes;</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>(<a class="code hl_function" href="#ga01b5393003225bd3ed93c5e3bb73a184">wc_AesXtsInit</a>(&amp;aes, NULL, INVALID_DEVID) != 0)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Handle error</span></div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">if</span>(<a class="code hl_function" href="#ga8b89849095c6d10b248dd2ccf6dff5e7">wc_AesXtsSetKeyNoInit</a>(&amp;aes, key, <span class="keyword">sizeof</span>(key), AES_ENCRYPTION) != 0)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Handle error</span></div>
<div class="line">}</div>
<div class="line"><a class="code hl_function" href="#ga8d63d909dd415e2954daec23cb4851ab">wc_AesXtsFree</a>(&amp;aes);</div>
<div class="ttc" id="agroup__AES_html_ga01b5393003225bd3ed93c5e3bb73a184"><div class="ttname"><a href="#ga01b5393003225bd3ed93c5e3bb73a184">wc_AesXtsInit</a></div><div class="ttdeci">int wc_AesXtsInit(XtsAes *aes, void *heap, int devId)</div><div class="ttdoc">This is to initialize an AES-XTS context. It is up to user to call wc_AesXtsFree on aes key when done...</div></div>
<div class="ttc" id="agroup__AES_html_ga8b89849095c6d10b248dd2ccf6dff5e7"><div class="ttname"><a href="#ga8b89849095c6d10b248dd2ccf6dff5e7">wc_AesXtsSetKeyNoInit</a></div><div class="ttdeci">int wc_AesXtsSetKeyNoInit(XtsAes *aes, const byte *key, word32 len, int dir)</div><div class="ttdoc">This is to help with setting keys to correct encrypt or decrypt type, after first calling wc_AesXtsIn...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaa1a5c32613382ca969ef11b875752f51" title="This is to help with setting keys to correct encrypt or decrypt type. It is up to user to call wc_Aes...">wc_AesXtsSetKey</a> </dd>
<dd>
<a class="el" href="#ga8b89849095c6d10b248dd2ccf6dff5e7" title="This is to help with setting keys to correct encrypt or decrypt type, after first calling wc_AesXtsIn...">wc_AesXtsSetKeyNoInit</a> </dd>
<dd>
<a class="el" href="#ga0372af5fdae94d196c977e28c3e35a81" title="AES with XTS mode. (XTS) XEX encryption with Tweak and cipher text Stealing.">wc_AesXtsEncrypt</a> </dd>
<dd>
<a class="el" href="#gad3aea81076e797ce28aa77e9cd610779" title="Same process as encryption but Aes key is AES_DECRYPTION type.">wc_AesXtsDecrypt</a> </dd>
<dd>
<a class="el" href="#ga8d63d909dd415e2954daec23cb4851ab" title="This is to free up any resources used by the XtsAes structure.">wc_AesXtsFree</a> </dd></dl>

</div>
</div>
<a id="gaa1a5c32613382ca969ef11b875752f51" name="gaa1a5c32613382ca969ef11b875752f51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa1a5c32613382ca969ef11b875752f51">&#9670;&#160;</a></span>wc_AesXtsSetKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesXtsSetKey </td>
          <td>(</td>
          <td class="paramtype">XtsAes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>dir</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>heap</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>devId</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is to help with setting keys to correct encrypt or decrypt type. It is up to user to call wc_AesXtsFree on aes key when done. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Success</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>AES keys for encrypt/decrypt process </td></tr>
    <tr><td class="paramname">key</td><td>buffer holding aes key | tweak key </td></tr>
    <tr><td class="paramname">len</td><td>length of key buffer in bytes. Should be twice that of key size. i.e. 32 for a 16 byte key. </td></tr>
    <tr><td class="paramname">dir</td><td>direction, either AES_ENCRYPTION or AES_DECRYPTION </td></tr>
    <tr><td class="paramname">heap</td><td>heap hint to use for memory. Can be NULL </td></tr>
    <tr><td class="paramname">devId</td><td>ID to use with crypto callbacks or async hardware. Set to INVALID_DEVID (-2) if not used</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">XtsAes aes;</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>(<a class="code hl_function" href="#gaa1a5c32613382ca969ef11b875752f51">wc_AesXtsSetKey</a>(&amp;aes, key, <span class="keyword">sizeof</span>(key), AES_ENCRYPTION, NULL, INVALID_DEVID) != 0)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Handle error</span></div>
<div class="line">}</div>
<div class="line"><a class="code hl_function" href="#ga8d63d909dd415e2954daec23cb4851ab">wc_AesXtsFree</a>(&amp;aes);</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga01b5393003225bd3ed93c5e3bb73a184" title="This is to initialize an AES-XTS context. It is up to user to call wc_AesXtsFree on aes key when done...">wc_AesXtsInit</a> </dd>
<dd>
<a class="el" href="#ga8b89849095c6d10b248dd2ccf6dff5e7" title="This is to help with setting keys to correct encrypt or decrypt type, after first calling wc_AesXtsIn...">wc_AesXtsSetKeyNoInit</a> </dd>
<dd>
<a class="el" href="#ga0372af5fdae94d196c977e28c3e35a81" title="AES with XTS mode. (XTS) XEX encryption with Tweak and cipher text Stealing.">wc_AesXtsEncrypt</a> </dd>
<dd>
<a class="el" href="#gad3aea81076e797ce28aa77e9cd610779" title="Same process as encryption but Aes key is AES_DECRYPTION type.">wc_AesXtsDecrypt</a> </dd>
<dd>
<a class="el" href="#ga8d63d909dd415e2954daec23cb4851ab" title="This is to free up any resources used by the XtsAes structure.">wc_AesXtsFree</a> </dd></dl>

</div>
</div>
<a id="ga8b89849095c6d10b248dd2ccf6dff5e7" name="ga8b89849095c6d10b248dd2ccf6dff5e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8b89849095c6d10b248dd2ccf6dff5e7">&#9670;&#160;</a></span>wc_AesXtsSetKeyNoInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_AesXtsSetKeyNoInit </td>
          <td>(</td>
          <td class="paramtype">XtsAes *</td>          <td class="paramname"><span class="paramname"><em>aes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>dir</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is to help with setting keys to correct encrypt or decrypt type, after first calling <a class="el" href="#ga01b5393003225bd3ed93c5e3bb73a184" title="This is to initialize an AES-XTS context. It is up to user to call wc_AesXtsFree on aes key when done...">wc_AesXtsInit()</a>. It is up to user to call wc_AesXtsFree on aes key when done. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Success</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>AES keys for encrypt/decrypt process </td></tr>
    <tr><td class="paramname">key</td><td>buffer holding aes key | tweak key </td></tr>
    <tr><td class="paramname">len</td><td>length of key buffer in bytes. Should be twice that of key size. i.e. 32 for a 16 byte key. </td></tr>
    <tr><td class="paramname">dir</td><td>direction, either AES_ENCRYPTION or AES_DECRYPTION</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">XtsAes aes;</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>(<a class="code hl_function" href="#ga01b5393003225bd3ed93c5e3bb73a184">wc_AesXtsInit</a>(&amp;aes, NULL, 0) != 0)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Handle error</span></div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">if</span>(<a class="code hl_function" href="#ga8b89849095c6d10b248dd2ccf6dff5e7">wc_AesXtsSetKeyNoInit</a>(&amp;aes, key, <span class="keyword">sizeof</span>(key), AES_ENCRYPTION, NULL, 0)</div>
<div class="line">   != 0)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Handle error</span></div>
<div class="line">}</div>
<div class="line"><a class="code hl_function" href="#ga8d63d909dd415e2954daec23cb4851ab">wc_AesXtsFree</a>(&amp;aes);</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga0372af5fdae94d196c977e28c3e35a81" title="AES with XTS mode. (XTS) XEX encryption with Tweak and cipher text Stealing.">wc_AesXtsEncrypt</a> </dd>
<dd>
<a class="el" href="#gad3aea81076e797ce28aa77e9cd610779" title="Same process as encryption but Aes key is AES_DECRYPTION type.">wc_AesXtsDecrypt</a> </dd>
<dd>
<a class="el" href="#ga8d63d909dd415e2954daec23cb4851ab" title="This is to free up any resources used by the XtsAes structure.">wc_AesXtsFree</a> </dd></dl>

</div>
</div>
<a id="gae42e0250f7ec82cf1dce498d59b5f725" name="gae42e0250f7ec82cf1dce498d59b5f725"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae42e0250f7ec82cf1dce498d59b5f725">&#9670;&#160;</a></span>wc_GmacSetKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_GmacSetKey </td>
          <td>(</td>
          <td class="paramtype">Gmac *</td>          <td class="paramname"><span class="paramname"><em>gmac</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function initializes and sets the key for a GMAC object to be used for Galois Message Authentication. </p>
<dl class="section return"><dt>Returns</dt><dd>0 On successfully setting the key </dd>
<dd>
BAD_FUNC_ARG Returned if key length is invalid.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gmac</td><td>pointer to the gmac object used for authentication </td></tr>
    <tr><td class="paramname">key</td><td>16, 24, or 32 byte secret key for authentication </td></tr>
    <tr><td class="paramname">len</td><td>length of the key</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Gmac gmac;</div>
<div class="line">key[] = { some 16, 24, or 32 <span class="keywordtype">byte</span> length key };</div>
<div class="line"><a class="code hl_function" href="#ga430f0c344e8e8132bceec748483212c1">wc_AesInit</a>(gmac.aes, HEAP_HINT, INVALID_DEVID); <span class="comment">// Make sure devId updated</span></div>
<div class="line"><a class="code hl_function" href="#gae42e0250f7ec82cf1dce498d59b5f725">wc_GmacSetKey</a>(&amp;gmac, key, <span class="keyword">sizeof</span>(key));</div>
<div class="ttc" id="agroup__AES_html_gae42e0250f7ec82cf1dce498d59b5f725"><div class="ttname"><a href="#gae42e0250f7ec82cf1dce498d59b5f725">wc_GmacSetKey</a></div><div class="ttdeci">int wc_GmacSetKey(Gmac *gmac, const byte *key, word32 len)</div><div class="ttdoc">This function initializes and sets the key for a GMAC object to be used for Galois Message Authentica...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaeb328cdd7c9ff7433198a0c4b19416af" title="This function generates the Gmac hash of the authIn input and stores the result in the authTag buffer...">wc_GmacUpdate</a> </dd>
<dd>
<a class="el" href="#ga430f0c344e8e8132bceec748483212c1" title="Initialize Aes structure. Sets heap hint to be used and ID for use with async hardware....">wc_AesInit</a> </dd></dl>

</div>
</div>
<a id="gaeb328cdd7c9ff7433198a0c4b19416af" name="gaeb328cdd7c9ff7433198a0c4b19416af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaeb328cdd7c9ff7433198a0c4b19416af">&#9670;&#160;</a></span>wc_GmacUpdate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wc_GmacUpdate </td>
          <td>(</td>
          <td class="paramtype">Gmac *</td>          <td class="paramname"><span class="paramname"><em>gmac</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>iv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>ivSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *</td>          <td class="paramname"><span class="paramname"><em>authIn</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>authInSz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *</td>          <td class="paramname"><span class="paramname"><em>authTag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32</td>          <td class="paramname"><span class="paramname"><em>authTagSz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function generates the Gmac hash of the authIn input and stores the result in the authTag buffer. After running wc_GmacUpdate, one should compare the generated authTag to a known authentication tag to verify the authenticity of a message. </p>
<dl class="section return"><dt>Returns</dt><dd>0 On successfully computing the Gmac hash.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gmac</td><td>pointer to the gmac object used for authentication </td></tr>
    <tr><td class="paramname">iv</td><td>initialization vector used for the hash </td></tr>
    <tr><td class="paramname">ivSz</td><td>size of the initialization vector used </td></tr>
    <tr><td class="paramname">authIn</td><td>pointer to the buffer containing the authentication vector to verify </td></tr>
    <tr><td class="paramname">authInSz</td><td>size of the authentication vector </td></tr>
    <tr><td class="paramname">authTag</td><td>pointer to the output buffer in which to store the Gmac hash </td></tr>
    <tr><td class="paramname">authTagSz</td><td>the size of the output buffer used to store the Gmac hash</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">Gmac gmac;</div>
<div class="line">key[] = { some 16, 24, or 32 <span class="keywordtype">byte</span> length key };</div>
<div class="line">iv[] = { some 16 <span class="keywordtype">byte</span> length iv };</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ga430f0c344e8e8132bceec748483212c1">wc_AesInit</a>(gmac.aes, HEAP_HINT, INVALID_DEVID); <span class="comment">// Make sure devId updated</span></div>
<div class="line"><a class="code hl_function" href="#gae42e0250f7ec82cf1dce498d59b5f725">wc_GmacSetKey</a>(&amp;gmac, key, <span class="keyword">sizeof</span>(key));</div>
<div class="line">authIn[] = { some 16 <span class="keywordtype">byte</span> authentication input };</div>
<div class="line">tag[AES_BLOCK_SIZE]; <span class="comment">// will store authentication code</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#gaeb328cdd7c9ff7433198a0c4b19416af">wc_GmacUpdate</a>(&amp;gmac, iv, <span class="keyword">sizeof</span>(iv), authIn, <span class="keyword">sizeof</span>(authIn), tag,</div>
<div class="line"><span class="keyword">sizeof</span>(tag));</div>
<div class="ttc" id="agroup__AES_html_gaeb328cdd7c9ff7433198a0c4b19416af"><div class="ttname"><a href="#gaeb328cdd7c9ff7433198a0c4b19416af">wc_GmacUpdate</a></div><div class="ttdeci">int wc_GmacUpdate(Gmac *gmac, const byte *iv, word32 ivSz, const byte *authIn, word32 authInSz, byte *authTag, word32 authTagSz)</div><div class="ttdoc">This function generates the Gmac hash of the authIn input and stores the result in the authTag buffer...</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#gae42e0250f7ec82cf1dce498d59b5f725" title="This function initializes and sets the key for a GMAC object to be used for Galois Message Authentica...">wc_GmacSetKey</a> </dd>
<dd>
<a class="el" href="#ga430f0c344e8e8132bceec748483212c1" title="Initialize Aes structure. Sets heap hint to be used and ID for use with async hardware....">wc_AesInit</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
